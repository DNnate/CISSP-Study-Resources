[Domain 5](#domain5-top) **Identity and Access Management (IAM)**

The identity and Access Management (IAM) domain focuses on issues related to granting and revoking privileges to access data or perform actions on systems
- Assets include information, systems, devices, facilities, and applications
- Organizations use both physical and logical access controls to protect them
- Identification is the process of a subject claiming, or professing, an identity. Subjects claim an identity, and identification can be as simple as a username for a user. Subjects prove their identity by providing authentication credentials such as the matching password for a username.
- Authentication verifies the subject‚Äôs identity by comparing one or more authentication factors against a database holding authentication info for users
- The three primary authentication factors are something you know, something you have, and something you are
- Single sign-on (SSO) technologies allow users to authenticate once and access any resources in a network or the cloud, without authenticating again. Kerberos, Active Directory Federation Services (ADFS), and Central Authentication
Services (CAS) are all SSO implementations. RADIUS is not a single sign-on implementation
- Federated Identity Management (FIM) systems link user identities in one system with other systems to implement SSO
- **Access Control System**: ensuring access to assets is authorized and restricted based on business and security requirements
- **Access Control Token**: based on the parameters like time, date, day etc a token defines access validity to a system
- **Ethical Wall**: the use of administrative, phyiscal/logical controls to establih/enforce separation of information, assets or job functions for need-to-know boundaries or prevent conflict of interest situations; AKA compartmentalization
- **Granularity of controls**: level of abstraction or detail which in a security function can be configured or tuned for performance and sensitivity
- **IDaaS**: cloud-based service that broker IAM functions to target systems on customers' premise and/or in the cloud
- **Identity proofing**: process of collecting/verifying info about someone who has requested access/credential/special privilege to establish a relationship with that person
- **Self-service identity management**: elemnts of the identity management lifecycle which the end-user (identity in question) can initiate or perform on their own (e.g. password reset, changes to challenge questions etc)
- **Whaling attack**: phishing attacks targeting highly-placed officials/private individuals with sizeable assets authorizing large fund wire transfers

[5.1](#5.1) Control physical and logical access to assets (OSG-9 Chpt 13)
- Controlling access to assets (tangible: things you can touch, or nontangible: info and data) is a central theme of security
- In addition to personnel, assets can be information, systems, devices, facilities, or applications:
    - 5.1.1 Information: an org‚Äôs information includes all of its data, stored in simple files (on servers, computers, and small devices), or in databases
    - 5.1.2 Systems: an org‚Äôs systems include anything that provide one or more services; a web server with a database is a system; permissions assigned to user and system accounts control system access
    - 5.1.3 Devices: refers to any computing system (e.g. routers & switches, smartphones, laptops, and printers); BYOD has been increasingly adopted, and the data stored on the devices is still an asset to the org
    - 5.1.4 Facilities: any physical location, building, rooms, complexes etc; physical security controls are important to help protect facilities
    - 5.1.5 Applications: apps provide access to data; permissions are an easy way to restrict logical access to apps
- Understand what assets you have, and how to protect them
    - **physical security controls**: such as perimeter security and environmental controls
        - control access and the environment
    - **logical access controls**: automated systems that auth or deny access based on verification that identify presented matches that which was previously approved; technical controls used to protect access to information, systems, devices, and applications
        - includes authentication, authorization, and permissions
        - permissions help ensure only authorized entities can access data
        - logical controls restrict access to config settings on systems/networks to only authed individuals
        - applies to on-prem and cloud
 - 5.1.6 Services: Controlling physical and logical access, whether on-premise or in the cloud, in the office or work-from-home scenarios. Basically controlling access control mechanisms to assets. These includes
   - Apps
   - Data/Information
   - Infrastructure and Systems
   - Devices
   - Cloud services
   - Sites and Facilities
     
   
[5.2](#5.2) Manage identification and authentication of people, devices, and services (OSG-9 Chpt 13)
- **Identification**: the process of a subject claiming, or professing an identity
- **Authentication**: verifies the subject‚Äôs identity by comparing one or more factors against a database of valid identities, such as user accounts
    - a core principle with authentication is that all subjects must have unique identities
    - identification and authentication occur together as a single two-step process
    - users identify themselves with usernames and authenticate (or prove their identity) with passwords. ‚úèÔ∏èNIST SP 800-¬≠63B recommends users only be required to change their password if their current password is compromised. They do not recommend that users be required to change their password regularly at any interval.
    - Note: The practice of üî•salting passwords (Salted hashes are stored and compared to passwords after they are salted and hashed) was specifically introduced to thwart rainbow table attacks, but it also thwarts the effectiveness of offline dictionary and brute-¬≠force attacks. 
- 5.2.1 Identiy management (IdM) implementation
    - Identity and access management is a collection of processes and techologies that are used to control access to critical assets; it's purpose is the management of access to information, systems, devices, and facilities
    - Identity Management (IdM) implementation techniques generally fall into two categories:
        - **centralized access control**: implies a single entity within a system performs all authorization verification
            - potentially creates a single point of failure
            - small team can manage initially, and can scale to more users
        - **decentralized access control**: (AKA distributed access control) implies several entities located throughout a system perform auth verification
            - requires more individuals or teams to manage, and admin may be spred across numerous locations
            - difficult to maintain consistency
            - changes made to any individual access control point needs to be repeated at others
    - With ubiquitious mobile computing and anywhere, anytime access (to apps & data), identity is the "new perimeter"
    - **Roles & Groups**:
    - provides centralized managment of access control policies, sreamlining administration across different scenarios. It also enforces least privilege by tailoring permission to roles.
    - On-Premise: roles and groups are tied to physical servers and domain controllers e.g AD
    - Cloud: cloud providers like Azure or AWS offer thier own identity and Access Management systems. It allows for cloud native groups and roles, templates and security integration with clud platforms. E.g Entra ID (Formerly Azure AD)
    - Hybrid: Organizations typically sunchronize  groups and roles  between on-premise and cloud environments. It allows for SSO for on-premise and cloud resources for better user experience.
      - Groups: Collection of users or devices that share common access requirements for a resources. Can streamline managment permissions and scale.
      - Roles: defines specfic rights and permissions granted to groups. Typically defines specific rights and permissions granted to groups. and reflects job functions or respionsibilities within an organization. In the cloud, it can relate to roles that map to specific roles for completing common tasks.
      - 
- 5.2.2 Single/Multi-Factor Authentication (MFA)
- **Authentication Methods**:
  - Passwords Only: the least secure üò†
  - Password and (SMS or Voice) ‚òπÔ∏è
  - Password and (Authenticator App, Software OATH/Tokens OTP, Hardware OATH/Tokens OTP). OTH tokens are one-time codes that changes every few minutes/seconds. üôÇ
  - Passwordless: It is convinient and also reduces phishing exposure. Strong passwords can be diffuclt to remember. Reduces password re-use. Passwords are also subject to replay attacks. The are cost concerns, and biometric privacy concerns. üòÑ Examples include:
     - Windows Hello for Business: Uses biometrics and supports relying party that supports Fast ID Online FIDO v2.0 authentication
     - FIDO2 Security Key: Hardware that uses public-key assymetric cryptograpgy for user authentication
     - Authenticator App: Authenticator Apps can also be used as the primary form of authentication to sign into popular cloud identities. It can also be used as additional verification option for self-service password reset or MFA. 
- **OATH token**: is a hardware or software-based authentication device that generates a one-time password (OTP) for secure access to systems, applications, or data. It is based on the OATH (Initiative for Open Authentication) standards, particularly the Time-based One-Time Password (TOTP) and HMAC-based One-Time Password (HOTP) algorithms.
  - **TOTP**: Generates OTPs based on the current time and a shared secret. The OTP is typically valid for a short period (e.g., 30 seconds).
  - **HOTP**: Generates OTPs based on a counter that increments each time an OTP is requested, along with a shared secret.
  - **Hardware Tokens**: Physical devices that display OTPs, such as key fobs or cards. Displays a key that refreshes every 30 seconds.
  - **Software Tokens**: Applications that run on smartphones or computers, generating OTPs. Examples include Google Authenticator or Authy. Microsoft Authenticator App is a software based OATH.
    - **Single-factor authentication**: any authentication using only one proof of identity
    - **Two-factor authentication (2FA)**: requires two different proofs of identity
    - **Multifactor authentication (MFA)**: any authentication using two or more factors
        - multifactor auth must use multiple types or factors, such as something you know and something you have
        - note: requiring users to enter a password and a PIN is NOT multifactor (both are something you know)
        - Type 1 + Type 2 + Type 3: A user needs to enter a password (Type 1 something you know ‚úèÔ∏è), use a smart card (Type 2 something you have ‚úèÔ∏è), and undergo a retina scan (Type 3 something you are ‚úèÔ∏è).
        - Yubikeys, Titan Security Keys, and similar devices are examples of tokens i.e Type 2
        - **üîîSynchronous** soft tokens, such as Google Authenticator, use a time-based algorithm that generates a constantly changing series of codes. A synchronous token generates and displays onetime passwords e.g every 60 seconds, that are synchronized with an authentication server.
        - **üîîAsynchronous** tokens typically require a challenge to be entered on the token to allow it to calculate a response, which the server compares to the response it expects. An asynchronous token uses a challenge-¬≠response process to generate the onetime password.
    - Two-factor methods:
        - **HMAC-based One-Time Password (HOTP)** Hash Message Authentication Code (HMAC) includes a hash function used by the HMAC-based One-Time Password (HOTP) standard to create onetime passwords. It typically creates HOTP values of six to eight numbers. This is similar to the asynchronous dynamic passwords created by tokens. The HOTP value remains valid until used.
        - **Time-based One-Time Password (TOTP)**: similar to HOTP, but uses a timestamp and remains valid for a certain time frame (e.g. 30 or 60 seconds). It is similar to the synchronous dynamic passwords used by tokens. The TOTP password expires if the user doesn‚Äôt use it within the time frame. 
            - e.g. phone-based authenticator app, where your phone is mimicking a hardware TOTP token (combined with userid/password is considered two-factor or two-step authentication)
        - **Email challenge**: popular method, used by websites, sending the user an email with a PIN
        - Short Message Service (SMS) to send users a text with a PIN is another 2-factor method; note that ‚úèÔ∏èNIST SP 800-63B points out vulnerabilities, and deprecates use of SMS as a two-factor method for federal agencies
- **Biometric**: Biometric methods identify users based on physical characteristics such as fingerprints. During enrollment, a subject‚Äôs biometric factor is sampled and stored in the device‚Äôs database. This stored sample of a biometric factor is the üîîreference profile (also known as a üîîreference template). The üîîthroughput rate (ideally 6 seconds) is the amount of time the system requires to scan a subject and approve or deny access. The more complex or detailed a biometric characteristic, the longer processing takes. Physiological biometric methods include fingerprints, face scans, retina scans, iris scans, palm scans (also known as palm topography or palm geography), and voice patterns:
    - Fingerprints: Fingerprints have loops, whorls, ridges, and bifurcations (also called minutiae) and fingerprint readers match the minutiae to data within a database.
    - Face Scans: Face scans use the geometric patterns of faces for detection and recognition.
    - Retina Scans: Retina scans focus on the pattern of blood vessels at the back of the eye. They are the most accurate form of biometric authentication and can differentiate between identical twins. However, some privacy proponents object to their use because they can reveal medical conditions, such as high blood pressure and pregnancy.
    - Iris Scans: Focusing on the colored area around the pupil, iris scans are the second most accurate form of biometric authentication. Iris scans are considered more acceptable by general users than retina scans because scans can occur from far away and are less intrusive. Scans can often be done from 6 to 12 meters away (about 20 to 40 feet). However, some scanners can be fooled with a high-quality image in place of a person‚Äôs eye. Additionally, accuracy can be affected by changes in lighting and the usage of some glasses and contact lenses.
    - Palm Scans: Palm scanners scan the palm of the hand for identification. They use near-infrared light to measure vein patterns in the palm, which are as unique as fingerprints.
    - Biometric devices are rated for performance by examining the different types of errors they produce:
      - **Crossover Error Rate CER**: point at which false acceptance (Type 2) error rate equals the false rejection (Type 1) error rate for a given sensor, in a given system and context; it is the optimal point of operation if the potential impacts of both types of errors are equivalent. Devices with lower CERs are more accurate than devices with higher CERs
      - **FRR**: False Rejection Rate (Type 1 Error) incorrectly denying authentication to a legit identity and therefore denying access
      - **FAR**: False Acceptance Rate (Type 2 Error) incorrectly authenticating a claimed identity as legit, recognizing and granting access on that basis

- 5.2.3 Accountability
    - Two important security elements in an access control system are authorization and accountability
        - **Authorization**: subjects are granted access to objects based on proven identities
        - **Accountability**: users and other subjects can be held accountable for their actions when auditing is implemented
            - Accurate identification and authentication are required to support accountability.
            - Authentication is necessary to ensure a network supports accountability. Note that authentication indicates that a user claimed an identity such as with a username and proved the identity such as with a password. In other words, valid authentication includes identification. However, identification doesn't include authentication. If users could just claim an identity without proving it's their identity, the system doesn't support accountability.
    - **Auditing**: tracks subjects and records when they access objects, creating an audit trail in one or more audit logs
        - Auditing provides accountability
        - Auditing occurs after the logs have been created
        - Logs record events, including who took an action, but without accurate identification and authentication, the logs can‚Äôt be relied on.
- 5.2.4 Session management
    - Session management is important to use with any type of authentication system to prevent unauthorized access
    - Desktop/laptops: recommendation to use screensavers, although modern OSs have timeout/lock features
    - Secure online sessions should terminate after a timeout period. Common session management techniques include the use of cookies, hidden form fields, URL rewriting, and built-in frameworks like Java‚Äôs HTTPSession.
    - long session ID (often 128 bits or longer) and session ID entropy (randomness)  make session guessing difficult for hackers
    - The Open Web Application Security Project (OWASP) publishes ‚Äúcheat sheets‚Äù that provide app developer‚Äôs specific recommendations
- 5.2.5 Registration, proofing, and establishment of identity
    - Within an organization, new employees prove their identity with appropriate documentation during the hiring process
        - in-person identity proofing includes things like passport, DL, birth cert etc
    - Online orgs often use knowledge-based authentication (KBA) for identity-proofing of someone new (e.g. a new customer creating a new bank/savings account)
        - example questions include past vehicle purchases, amount of mortgage payment, previous addresses, DL numbers
        - they then query authoritative information (e.g. credit bureaus or gov agencies) for matches
    - Cognitive Passwords: security questions that are gathered during account creation, which are later used as questions for authentication (e.g. name of pet, color of first car etc)
        - one of the flaws associated with cognitive passwords is that the information is often available on social media sites or general internet searches
- 5.2.6 Federated Identity Management (FIM)
    - Federated Identity Management (FIM) systems (a form of SSO. üìùSSO is a benefit of identity management, not a type of identity management.) are often used by cloud-based apps
    - A federated identity links a user‚Äôs identity in one system with multiple identity management systems
    - FIM allows multiple orgs to join a federation or group, agreeing to share identity information
        - users in each org can log in once in their own org, and their credentials are matched with a federated identity
        - users can then use this federated identity to access resources in any other org within the group
        - where each organization decides what resources to share
    - Methods used to implement federated identity management systems include:
        - Security Assertion Markup Language (SAML)
        - OAuth (most widely used and integrates with 3rd Parties). The anti-forgery state token exchanged during OAuth  sessions is intended to prevent cross-site request forgery. Cross-¬≠site request forgery attacks, abbreviated as XSRF or CSRF attacks, are similar to cross-¬≠site scripting attacks but exploit a different trust relationship. XSS attacks exploit the trust
that a user has in a website to execute code on the user‚Äôs computer. **XSRF** attacks exploit the trust that remote sites have in a user‚Äôs system to execute commands on the user‚Äôs behalf.
        - OpenID Connect (OIDC) (used for authentication): would allow to use an account from another service to acces an  application
        - OpenID Connect is a RESTful, JSON-based authentication protocol that, when paired with OAuth, can provide identity verification and basic profile information.
        - OpenID Provider (OP): The service that authenticates users. Relying Party (RP): The website or app trusting the OP for user authentication. End User: The person logging in using OpenID credentials. User logs in to the RP using their OpenID.
RP redirects to the OP e.g Google for authentication. OP authenticates the user and sends a response back to the RP.
RP verifies the response. User gains access to the RP. **Note** Allowing the relying party to provide the redirect to the OpenID provider could allow a phishing attack by directing clients to a fake OpenID provider that can capture valid cre-
dentials.
    - Cloud-based federation typically uses a third-party service to share federated identities
    - Federated identity management systems can be hosted on-premises, in the cloud, or in a combination of the two as a hybrid system. Hybrid federation e.g occurs where authentication occurs on-premises and services are provided through a federated identity service in the cloud
- 5.2.7 Credential management systems
    - **Credential management systems**: provide storage space for usernames and password
        - e.g. web browsers that remember usernames and passwords for visited sites
    - The World Wide Web Consortium (W3C) published the Credential Management Level 1 API as a working draft in January 2019, which many browsers have adopted
    - Some federated identity management solutions use the Credential Management API, allowing web apps to implement SSO using a federated identity provider
        - e.g. using your Google or Facebook account to sign into Zoom
- 5.2.8 Singe Sign On (SSO)
    - **Single Sign-On (SSO)**: a centralized access control technique allowing a subject to be authenticated once on a system and access multiple resources without authenticating again
    - Advantages of using SSO include:
        - reduces the number of passwords that users need to remember, and they are less likely to write them down
        - eases administration by reducing the number of accounts
    - Disadvantages:
        - once an account is compromised, an attacker gains unrestricted access to all of the authorized resources
    - Within an organization, a central access control system, such as a directory service, is often used for SSO
        - **directory service**: a centralized database that includes information about subjects and objects, including authentication data
        - many directory services are based on the Lightweight Directory Access Protocol (LDAP)
- 5.2.9 Just-In_time (JIT)
    - Federated identity solutions that support just-in-time (JIT) provisioning automatically create the relationship between two entities so that new users can access resources
    - A JIT solution creates the connection without any administrative intervention
    - JIT systems commonly use SAML to exchange required data

[5.3](#5.3) Federated Identity with a third-party service (OSG-9 Chpt 13)
- 5.3.1 On-premise
    - Federated identity management can be hosted on-premise, and typically provides an organization with the most control
- 5.3.2 Cloud
    - Cloud-based apps used federated identify management (FIM) systems, which are a form of SSO. E.g Shibboleth is a federated identity solution designed to allow web-based SSO
    - Cloud-based federation typically uses a third-party service to hsare federated identities (e.g. training sites use federated SSO systems)
        - commonly matching the user's internal login ID with a federated identify
- 5.3.3 Hybrid
    - A hybrid federation is a combination of a cloud-based solution and an on-premise solution

[5.4](#5.4) Implement and manage authorization mechanisms (OSG-9 Chpt 14)
- 5.4.1 **Role Based Access Control (RBAC)**
    - A key characteristic of the Role-Based Access Control (RBAC) model is the use of roles or groups
    - Instead of assigning permissions directly to users, user accounts are placed in roles and administrators assign privileges to the roles (typically defined by job function)
        - if the user account is in a role, the user has all privileges assigned to the role
    - MS Windows OS uses this model with groups
    - A role-¬≠based access control (RBAC) model can group users into roles based on the organization‚Äôs hierarchy
    - it is based on role or group membership, and users can be members of multiple groups. Users are not limited to only a single role.
    - RBAC models are based on the hierarchy of an organization, so they are hierarchy based.
    - It is nondiscretionary model managed by a central authorityüî• to determine which objects subjects can access
- 5.4.2 **Rule Based access control**
    - A key characteristic of the Rule-Based access control model is that it applies global rules to all subjects
        - e.g. firewalls uses rules that allow or block traffic to all users equally
    - Rules within the rule-based access control model are sometimes referred to as restrictions or filters
    - It uses a global rules applied to all users and other subjects equally.
    - It is a Nondiscretionary access controls that uses centralized management üî•, such as a rules deployed on a firewall.
- 5.4.3 Mandatory Access Control (MAC)
    - **Mandatory Access Control (MAC)**: access control that requires the _system_ itself to manage access controls in accordance with the org's security policies. Users cannot delegate rights.
    - A key characteristic of the MAC model is the use of labels applied to both subjects and objects
        - e.g. a label of top secret grants access to top-secret documents
    - When documented in a table, the MAC model sometimes resembles a lattice or matrix (i.e. climbing rosebush framework), so it is referred to as a lattice-based model. Biba integrity model uses this.
    - üìù MAC model doesn‚Äôt use a centralized environment.
    - MAC is a nondiscretionary access control model that uses labelsüî•
    - (MAC) model supports three environments: hierarchical, compartmentalized, and hybrid.
        - ‚òëÔ∏èIn a hierarchical environment, the various classification labels are assigned in an ordered structure from low security to high security.
        - ‚òëÔ∏ècompartmentalized environment ignores the levels, and instead only allows access for individual compartments on any level.
        - ‚òëÔ∏èhybrid environment is a combination of a hierarchical and compartmentalized environment.

- 5.4.4 Discretionary Access Control (DAC)
    - **Discretionary Access Control (DAC)**: access control model in which the system owner decides who gets access
    - A key characteristic of the DAC model is that every object has an owner, and the owner can grant or deny access to any other subjects
        - e.g. you create a file and are the owner, and can grant permissions to that file
    - New Technology File System (NTFS) used in Windows, uses the DAC model
    - MAC, RBAC, and rule-¬≠based access control) are nondiscretionary models.
- 5.4.5 Attribute Based Access Control (ABAC) or Policy-Based Access Control
    - **Attribute-Based Access Control (ABAC)**: an access control paradigm where access rights are granted to users with policies that combine attributes together. Attributes used for ABAC often fall into one of four categories: subject attributes like department or title; action attributes like the ability to view, edit, or delete; object attributes
that describe the object that can be impacted; and contextual attributes like location, time, or elements.
    - A key characteristic of the ABAC model is its use of rules that can include multiple attributes
        - this allows it to be much more flexible than a rule-based access control model that applies the rules to all subjects equally
        - many software-defined networks (SDNs) use the ABAC model
    - ABAC allows administrators to create rules within a policy using plain language statements such as "Allow Managers to access the WAN using a mobile device"
- 5.4.6 **Risk based access control**
    - Risk-based access control model grants access after evaluating risk; evaluating the environment and the situation and making risk-based decisions using policies embeded within software
        - Using machine learning, making predictive conclusions about current activity based on past activity
        - risk-¬≠based access control model can require users to authenticate with multifactor authentication
        - it evaluates the environment and the situation and then makes access decisions based on coded policies
- 5.4.7 **Task based access control**
    - TBAC is similar to RBAC, but instead of being assigned to one or more roles, each user is assigned an array of tasks.
- **Access Policy Enforcement**:
  - **Policy Enforcement Point (PEP)**: Responsible for enabling, monitoring and terminating connections between a subject (such as user or device) and an enterprise resource.
     - It acts as a gateway the enforces access control policies.
     - When an access request occurs, the PEP evaluates the request against predifined policies and then applies the neccessary controls.
     - E.g PEP might enforce MFA authentications for access request from unexpected locations. in this case, it is dynamic based on conditions/contexts
     - PEP enforces policies at the connection level
  - **Policy Decision Point (PDP)**: This is where the decisions are made based on various factors such as user identity, device health and risk assessment.
     - it evaluates the context of an access request and decides whether it should be allowed, denied, or subjected to additonal controls
     - it considers the 5 Ws (Who, What, When, Where, Why)
     - PDP makes access decision based on contextual information
  - With regards to the key elements of Zero trust architecture, as it relates to access policy enforcment, the following are described in NIST 800-207.
    - **Control Plane**: These drive the policy-based decision logic for the concept of Zero trust. Involves the following:
       - Adaptive Identity: Changes the way that the system asks a user to authenticate based on context of the request. e.g user location, device health, approved app, riks levels of user
       - Threat Scope reduction: An end goal of ZTNA to decrease risks to the organisation.
       - Policy-Driven Access Control: Control based on a users identity rather than simply thier systems location. example conditional access feature in MIcrosft's Entra ID.
       - Policy Administrator: Responsible for communicating the decisions made by the policy engine It is a funtion not a person.
       - Policy Engine: Decides whether to grant access to a resource for a given subject. E.g Microsoft Entra ID is a policy engine. The policy administrator and the policy engine together give us the PDP functionality.
    - **Data Plane**: These enforces the decision defined in the control plane. Involves the following:
       - Implicit Trust Zones: Part of the traditional security approach in which firewalls and other security devices formed a perimeter. systems belonging to an organisation are placed inside this boundary.
       - Subject/System: Subject is the user who wishes to access a resource. The system is a non-human entity often used by the user to access this resource.   
       - Policy Enforcement Point: When a user or system request access to a resource, it is the PEP that evaluates it against predefined policies and applies the neccessary controls.

[5.5](#5.5) Manage the identity and access provisioning lifecycle (OSG-9 Chpts 13,14)
- 5.5.1 Account accesss review
    - Administrators need to periodically review user, system and service accounts to ensure they meet security policies and that they don‚Äôt have excessive privileges
    - Be careful in using the local system account as an application service account; although it allows the app to run without creating a special service account, it usually grants the app more access than it needs
    - You can use scripts to run periodically and check for unused accounts, and check priveleged group membership, removing unauthorized accounts
    - Guard against two access control issues:
        - excessive privilege: occurs when users have more privileges than assigned work tasks dictate; these privileges should be revoked
        - creeping privileges (AKA privilege creep or aggregation): user accounts accumulating additional privileges over time as job roles and assigned tasks change
- 5.5.2 Provisioning and deprovisioning
    - Identity and access provisioning lifecycle refers to the creation, management, and deletion of accounts
        - this lifecycle is important because without properly defined and maintained user accounts, a system is unable to establish accurate identity, perform authentication, provide authorization, and track accountability
    - Provisioning/Onboarding
        - proper user account creation, or provisioning, ensures that personnel follow specific procedures when creating accounts
            - new-user account creation is AKA enrollment or registration
        - **automated provisioning**: information is provided to an app, that then creates the accounts via pre-defined rules (assigning to appropriate groups based on roles)
            - automated provisioning systems create accounts consistently
        - provisioning also includes issuing hardware, tokens, smartcards etc to employees
        - it‚Äôs important to keep accurate records when issuing hardware to employees
        - after provisioning, an org can follow up with onboarding processes, including:
            - the employee reads and signs the acceptable use policy (AUP)
            - explaining security best practices (like infected emails)
            - reviewing the mobile device policy
            - ensuring the employee‚Äôs computer is operational, and they can log in
            - configure a password manager
            - explaining how to access help desk
            - show to access, share and save resources
    - Deprovisioning/Offboarding
        - Deprovisioning/offboarding occurs when an employee leaves the organization or is transferred to a different department
        - **Account revocation**: deleting an account is the easiest way to deprovision
            - an employee's account is usually first disabled
            - supervisors can then review the user‚Äôs data and determine if anything is needed
            - note: if terminated employee retains access to a user account after the exit interview, the risk for sabatage is very high
        - Deprovisioning includes collecting any hardware issued to an employee such as laptops, mobile devices and auth tokens
- 5.5.3 Role definition
    - Employee responsibilities can change in the form of transfers to a different role, or into a newly created role
        - for new roles, it‚Äôs important to define the role and the privileges needed by the employees in that role
    - Roles and associated groups need to be defined in terms of privileges
- 5.5.4 Privilege escalation (e.g. managed service accounts, use of usdo, minimizing its use)
    - Privilege escalation refers to any situation that gives users more privileges than they should have
    - Attackers use privilege escalation techniques to gain elevated privileges
    - **Horizontal privilege escalation**: gives an attacker similar privileges as the first compromised user, but from other accounts
    - **Vertical privilege escalation**: provides an attacker with significantly greater privileges
        - e.g. after compromising a regular user‚Äôs account an attacker can use vertical privilege escalation techniques to gain administrator privileges on the user‚Äôs computer
        - the attacker can then use horizontal privilege escalation techniques to access other computers in the network
        - this horizontal privilege escalation throughout the network is AKA **lateral movement**
- **Service Accounts**: When a software is installed on a computer, it may require privileged access to run and access other resources (systems/data). Service accounts are a low level adminsitrative accounts without human intervention.
   - it is an account used to run an application
   - In the cloud, it is often called service principle.
   - In the cloud, similar concepts exists for clud resources such as VMs, that provides an identity for that resource to access other resources. In Azure (_Managed Identity_), in AWS (_Service Roles_), in Google cloud (_Service Account Identity_).
   - Least privilege and life cycle managment are all equally important for service accounts.
- 
[5.6](#5.6) Implement authentication systems (OSG-9 Chpt 14)
- 5.6.1 OpenID Connect (OIDC) / Open Authorization (Oauth)
    - **OAuth 2.0** authorization framework enables third-party apps to obtain limited access to an HTTP service, either on behalf of a resource owner (by orchestrating an approval interaction), or by allowing third-party applications to obtain access on its own behalf
    - OAuth is an open framework used for authentication and authorization protocols 
    - The most common protocol built on OAuth is OpenID Connect (OIDC) 
    - OAuth 2.0 is often used for delegated access to applications, e.g. a mobile game that automatically finds all of your new friends from a social media app is likely using OAuth 2.0
    - Conversely, if you sign into a new mobile game using a social media account (instead of creating a user account just for the game), that process might use OIDC
    - **OpenID Connect (OIDC)**: an authentication layer using the OAuth 2.0 authorization framework, maintained by the OpenID Foundation, providing both authentication and authorization
    - OIDC uses JSON (JavaScript Object Notation) Web Tokens (JWT) -- AKA ID token that provides both authentication and profile information for internet-¬≠based single sign-¬≠on
    - OAuth and OIDC are used with many web-based applications to share information without sharing credentials
        - OAuth provides authorization
        - OIDC uses the OAuth framework for authorization and builds on the OpenID technologies for authentication
    - üìùOpenID on its own provides authentication but doesn‚Äôt include profile information. However OpenID Connect provides both authentication and profile information
- 5.6.2 Security Assertion Markup Language (SAML)
    - **Security Assertion Markup Language (SAML)**: an open XML-based standard commonly used to exchange authentication and authorization (AA) information between federated orgs
    - it is used to make authorization and authentication data on first access
    - SAML provides SSO capabilities for browser access
    - SAML is a popular SSO standard on the internet - used to exchange authentication and authorization (AA) information
    - Organization for the Advancement of Structure Information Standards (OASIS) maintains it
    - SAML 2 spec utilizes three entities:
        - Principal or User Agent
        - Service Provider (SP): providing the service a user is interested in using
        - Identity Provider (IdP): a third-party that holds the user authentication and authorization info
    - IdP can send three types of XML messages known as assertions:
        - Authentication Assertion: provides proof that the user agent provided the proper credentials, identifies the identification method, and identifies the time the user agent logged on
        - Authorization Assertion: indicates whether the user agent is authorized to access the requested service; if denied, includes why
        - Attribute Assertion: attributes can be any information about the user agent
 - **Other Markup Languages**
    - Service Provisioning Markup Language (SPML) is an XML-based language designed to allow platforms to generate and respond to provisioning requests.
    - Extensible Access Control Markup Language (XACML) is used to describe access controls.
  
- 5.6.3 Kerberos
    - **Kerberos** is a network authentication protocol widely used in corporate and private networks and found in many LDAP and directory services solutions such as Microsoft Active Directory
    - It provides single sign-on and uses cryptography to strengthen the authentication process
    - The primary purpose of Kerberos is authentication, since it allows users to prove their identity.
    - Kerberos requires computer times to be within 5 minutes of each other
    - The purpose of Kerberos is authentication; Kerberos offers a single sign-on solution for users and protects logon credentials
    - Ticket authentication is a mechanism that employs a third-party entity to prove identification and provide authentication - Kerberos is a well-known ticket system
    - After users authenticate and prove their identity, Kerberos uses their proven identity to issue tickets, and user accounts present these tickets when accessing resources
    - Kerberos version 5 relies on symmetric-key cryptography (AKA secret-key cryptography) using the Advanced Encryption Standard (AES) symmetric encryption protocol
    - Kerberos provides confidentiality and integrity for authentication traffic using end-to-end security and helps protect against eavesdropping and replay attacks
    - Kerberos elements:
        - **Key Distribution Center (KDC)**: the trusted third party that provides authentication services
        - **Kerberos Authentication Server**: hosts the functions of the KDC:
            - **ticket-granting service (TGS)**: provides proof that a subject has authenticated through a KDC and is authorized to request tickets to access other objects
                - a TGT is encrypted and includes a symmetric key, an expiration time, and user‚Äôs IP address. üìù a scenario where TGT is compromised, Attackers can create golden tickets after successfully exploiting Kerberos and obtaining the Kerberos service account (KRBTGT).
                - subjects present the TGT when requesting tickets to access objects
            - **authentication service (AS)**: verifies or rejects the authenticity and timeliness of tickets. Often referred to as the KDC
        - **ticket (AKA service ticket (ST))**: an encrypted message that provides proof that a subject is authorized to access an object
        - **Kerberos Principal**: typically a user but can be any entity that can request a ticket
        - **Kerberos realm**: a logical area (such as a domain or network) ruled by Kerberos
    - Kerberos login process:
        - user types a username/password into the client to initiate client/TGS key generation
        - client encrypts the username with AES for transmission to the KDC
        - the KDC verifies the username against a db of known credentials
        - the KDC generates a symmetric key that will be used by the client and the Kerberos server
            - it encrypts this with a hash of the user‚Äôs password
            - the KDC also generates an encrypted timestamped TGT. Kerberos relies on properly synchronized time on each end of a connection to function.
        - the KDC then transmits the encrypted symmetric key and the encrypted timestamped TGT to the client
        - the client installs the TGT for use until it expires
            - the client also decrypts the symmetric key using a hash of the user‚Äôs password
            - NOTE: the client‚Äôs password is never transmitted over the network, but it is verified
                - the server encrypts a symmetric key using a hash of the user‚Äôs password, and it can only be decrypted with a hash of the user‚Äôs password
                - as long as the user enters the correct password, this step works
    - When a client wants to access an object (like a hosted resource), it must request a ticket through the Kerberos server, in the following steps:
        - the client sends its TGT back to the KDC with a request for access to the resource
        - the KDC verifies that the TGT is valid, and checks its access control matrix to verify user privileges for the requested resource
        - the KDC generates a service ticket and sends it to the client
        - the client sends the ticket to the server or service hosting the resource
        - the server or service hosting the resource verifies the validity of the ticket with the KDC
        - once identity and authorization are verified, Kerberos activity is complete
            - the server or service host then opens a session with the client and begins communication or data transmission
- 5.6.4 Remote Authentication Dial-in User Service (RADIUS) / Terminal Access Controller Access Control System Plus (TACACS+)
    - **Remote Authentication Dial-in User Service (RADIUS)**: centralizes authentication for remote access connections, such as VPNs or dial-up access
        - a user can connect to any network access server, which then passes on the user‚Äôs credentials to the RADIUS server to verify authentication and authorization and to track accounting
        - in this context, the network access server is the RADIUS client e.g router, switch, and a RADIUS server acts as an authentication server
        - the RADIUS server also provides AAA services for multiple remote access servers
        - RADIUS uses the User Datagram Protocol (UDP) by default and encrypts only the password‚Äôs exchange
        - RADIUS using Transport Layer Security (TLS) over TCP (port 2083) is defined by RFC 6614 
        - RADIUS uses UDP port 1812 for RADIUS messages and UDP port 1813 for RADIUS Accounting messages
        - RADIUS encrypts only the password‚Äôs exchange by default
        - it is possible to use RADIUS/TLS to encrypt the entire session
    - **TACACS**: Cisco developed Terminal Access Control Access Control System Plus (TACACS+) and released it as an open standard
        - provides improvements over the earlier version and over RADIUS, it separates authentication, authorization, and accounting into separate processes, which can be hosted on three different servers
        - TACACS+ allows authentication, authorization, and accounting to be handled independently, providing more granular control.
        - additionally, TACACS+ encrypts all of the authentication information, not just the password, as RADIUS does
        - TACACS+ uses TCP port 49, providing a higher level of reliability for the packet transmissions

- 5.6.5 Credential Managment System
    - **Password Vault**: stored locally on the device and stores password so the user doesnt have to remember them
       - uses trong encyrption e.g AES-256 for secure storage
       - only as secure as the secure owner password used to protect the vault itself
       - Often uses MFA
       - Some password vaults exists in the cloud for DevOps scenarios
    - **Key Managment Systems**: CSPs offer a cloud service for centralized secure stroage and access for application secrets called vaults. In Azure (Key Vault), in AWS (KMS), in Google Cloud (KMS Vault)
       - secrets can include API keys, passwords, certificates, tokens, cryptographic keys
       - The services will typicall offer programmatic access via API to support DevOps and CI/CD
       - Access control is handled at the vault-instance level and often at a secret level within
       - Secrets and keys can be protected either by software of by FIPS 14-2(3) Level 2 validated HSMs.
  
***Authorization Mecahanisms***

- Implicit Deny: ensures that access to an object is denied unless access has been explicitly granted to a subject. (deny by default)
- Access Control Matrix: a table that includes subjects, objects, and assigned privileges. 
- Capability Tables: Capability tables list the privileges assigned to subjects and identify the objects that subjects can access. They are different from ACLs in that a capability table is focused on subjects (such as users, groups, or roles). In contrast, ACLs are focused on objects. 
- Constrained Interface: Applications use constrained interfaces or restricted interfaces to restrict what users can do or see based on their privileges. 
- Content-¬≠Dependent Control: This restrict access to data based on the content within an object. A database view is a content-¬≠dependent control.
- Context-¬≠Dependent Control: These require specific activity before granting users access. e.g Time-based controls to logon on at certain hours
- Need to Know: ensures that subjects are granted access only to what they need to know for their work tasks and job functions.
- Least Privilege: This ensures that subjects are granted only the privileges they need to perform their work tasks and job functions. This is sometimes lumped together with need to know. The only difference is that least privilege will also include rights to take action on a system.
- Separation of Duties and Responsibilities: This ensures that sensitive functions are split into tasks performed by two or more employees. It helps prevent fraud and errors by creating a system of checks and balances.
