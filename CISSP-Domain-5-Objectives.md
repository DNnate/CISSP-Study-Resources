[Domain 5](#domain5-top) **Identity and Access Management (IAM)**

The identity and Access Management (IAM) domain focuses on issues related to granting and revoking privileges to access data or perform actions on systems
- Assets include information, systems, devices, facilities, and applications
- Organizations use both physical and logical access controls to protect them
- Identification is the process of a subject claiming, or professing, an identity. Subjects claim an identity, and identification can be as simple as a username for a user. Subjects prove their identity by providing authentication credentials such as the matching password for a username.
- Authentication verifies the subjectâ€™s identity by comparing one or more authentication factors against a database holding authentication info for users
- The three primary authentication factors are something you know, something you have, and something you are
- Single sign-on (SSO) technologies allow users to authenticate once and access any resources in a network or the cloud, without authenticating again. Kerberos, Active Directory Federation Services (ADFS), and Central Authentication
Services (CAS) are all SSO implementations. RADIUS is not a single sign-on implementation
- Federated Identity Management (FIM) systems link user identities in one system with other systems to implement SSO
- **Access Control System**: ensuring access to assets is authorized and restricted based on business and security requirements
- **Access Control Token**: based on the parameters like time, date, day etc a token defines access validity to a system
- **Ethical Wall**: the use of administrative, phyiscal/logical controls to establih/enforce separation of information, assets or job functions for need-to-know boundaries or prevent conflict of interest situations; AKA compartmentalization
- **Granularity of controls**: level of abstraction or detail which in a security function can be configured or tuned for performance and sensitivity
- **IDaaS**: cloud-based service that broker IAM functions to target systems on customers' premise and/or in the cloud. Identity as a service (IDaaS) provides an identity platform as a third-party service. This can provide benefits, including integration with cloud services and removing overhead for maintenance of traditional on-premises identity systems, but can also create risk due to third-party control of identity services and reliance on an off-site identity infrastructure.
- **Identity proofing**: process of collecting/verifying info about someone who has requested access/credential/special privilege to establish a relationship with that person. Identity proofing is the process of validating that the entity or individual claiming an identity is the actual person or organization that they claim to be. This commonly relies on additional information like documents or knowledge that others would not have. 
- **Self-service identity management**: elemnts of the identity management lifecycle which the end-user (identity in question) can initiate or perform on their own (e.g. password reset, changes to challenge questions etc)
- **Whaling attack**: phishing attacks targeting highly-placed officials/private individuals with sizeable assets authorizing large fund wire transfers

[5.1](#5.1) Control physical and logical access to assets (OSG-9 Chpt 13)
- Controlling access to assets (tangible: things you can touch, or nontangible: info and data) is a central theme of security
- In addition to personnel, assets can be information, systems, devices, facilities, or applications:
    - 5.1.1 Information: an orgâ€™s information includes all of its data, stored in simple files (on servers, computers, and small devices), or in databases
    - 5.1.2 Systems: an orgâ€™s systems include anything that provide one or more services; a web server with a database is a system; permissions assigned to user and system accounts control system access
    - 5.1.3 Devices: refers to any computing system (e.g. routers & switches, smartphones, laptops, and printers); BYOD has been increasingly adopted, and the data stored on the devices is still an asset to the org
    - 5.1.4 Facilities: any physical location, building, rooms, complexes etc; physical security controls are important to help protect facilities
    - 5.1.5 Applications: apps provide access to data; permissions are an easy way to restrict logical access to apps
- Understand what assets you have, and how to protect them
    - **physical security controls**: such as perimeter security and environmental controls
        - control access and the environment
    - **logical access controls**: automated systems that auth or deny access based on verification that identify presented matches that which was previously approved; technical controls used to protect access to information, systems, devices, and applications
        - includes authentication, authorization, and permissions
        - permissions help ensure only authorized entities can access data
        - logical controls restrict access to config settings on systems/networks to only authed individuals
        - applies to on-prem and cloud
 - 5.1.6 Services: Controlling physical and logical access, whether on-premise or in the cloud, in the office or work-from-home scenarios. Basically controlling access control mechanisms to assets. These includes
   - Apps
   - Data/Information
   - Infrastructure and Systems
   - Devices
   - Cloud services
   - Sites and Facilities
   
[5.2](#5.2) Manage identification and authentication of people, devices, and services (OSG-9 Chpt 13)
- **Identification**: the process of a subject claiming, or professing an identity. A user professes an identity with a login ID. The ğŸ“combination of the login ID and the password provides authentication. A user account must have an account identifier (also known as a username).
- **Authentication**: verifies the subjectâ€™s identity by comparing one or more factors against a database of valid identities, such as user accounts
    - a core principle with authentication is that all subjects must have unique identities
    - identification and authentication occur together as a single two-step process
    - Access control systems rely on identification and authentication to provide ğŸ“accountability. 
    - users identify themselves with usernames and authenticate (or prove their identity) with passwords.
    - When you input a username and password, you are authenticating yourself by providing a unique identifier and a verification that you are the person who should have that identifier (the password). 
    - âœï¸NIST SP 800-Â­63B recommends users only be required to change their password if their current password is compromised. They do not recommend that users be required to change their password regularly at any interval.
    - Password complexity is driven by length, and a longer password will be more effective against brute-force attacks than a shorter password. Each character of additional length increases the difficulty by the size of the potential character set (for example, a single lowercase character makes the passwords 26 times more difficult to crack.
    - ğŸ”¬Salting: The practice of ğŸ”¥salting passwords (Salted hashes are stored and compared to passwords after they are salted and hashed) was specifically introduced to thwart rainbow table attacks, but it also thwarts the effectiveness of offline dictionary and brute-Â­force attacks. ğŸ“Rainbow tables are databases of pre-hashed passwords paired with high-speed lookup functions. Since they can quickly compare known hashes against those in a file, using rainbow tables is the fastest way to quickly determine passwords from hashes.
    - ğŸ”¬Shadowed password refers to a system where user password hashes are stored in a separate file, typically called the "shadow file", instead of the standard "/etc/passwd" file on Unix or Linux systems. When a system is configured to use shadowed passwords, the /etc/passwd file contains only the character x in the place of a password. When a system uses shadowed passwords, the hashed password value is stored in /etc/shadow instead of /etc/passwd.
    - ğŸ”¬Mutual authentication ensures that a server provides authentication before the client provides authentication. This prevents employees from revealing their credentials to rogue servers.
    - ğŸ”¬Credential Management API is a web-based API that allows developers to store, retrieve, and manage user credentials in a secure and user-friendly manner. Itâ€™s part of modern web standards and plays a crucial role in simplifying user authentication while enhancing security. The Credential Management application programming interface (API) was published by the World Wide Web Consortium (W3C) as a working draft in January 2019 and allow customers to be automatically logged on when they visit a website.
- **Authorization**: Authorization verifies the identity of a subject by checking a factor like a password.  Authorization provides a user with capabilities or rights. It is the process of determining what a user is allowed to do.
- 5.2.1 Identiy management (IdM) implementation
    - Identity and access management is a collection of processes and techologies that are used to control access to critical assets; it's purpose is the management of access to information, systems, devices, and facilities
    - Identity Management (IdM) implementation techniques generally fall into two categories:
        - â™ˆ**centralized access control**: implies a single entity within a system performs all authorization verification
            - potentially creates a single point of failure
            - small team can manage initially, and can scale to more users
        - â™ˆ**decentralized access control**: (AKA distributed access control) implies several entities located throughout a system perform auth verification
            - requires more individuals or teams to manage, and admin may be spred across numerous locations
            - difficult to maintain consistency
            - changes made to any individual access control point needs to be repeated at others
            - When network connectivity to a central control point is a problem or if rules and regulations may vary significantly from location to location, centralized control can be less desirable than decentralized control despite its challenges with consistency. 
    - With ubiquitious mobile computing and anywhere, anytime access (to apps & data), identity is the "new perimeter"
    - **Roles & Groups**:
    - provides centralized managment of access control policies, sreamlining administration across different scenarios. It also enforces âœï¸least privilege by tailoring permission to roles.
    - On-Premise: roles and groups are tied to physical servers and domain controllers e.g AD
    - Cloud: cloud providers like Azure or AWS offer thier own identity and Access Management systems. It allows for cloud native groups and roles, templates and security integration with clud platforms. E.g Entra ID (Formerly Azure AD)
    - Hybrid: Organizations typically sunchronize  groups and roles  between on-premise and cloud environments. It allows for SSO for on-premise and cloud resources for better user experience.
      - Groups: Collection of users or devices that share common access requirements for a resources. Can streamline managment permissions and scale.
      - Roles: defines specfic rights and permissions granted to groups. Typically defines specific rights and permissions granted to groups. and reflects job functions or respionsibilities within an organization. In the cloud, it can relate to roles that map to specific roles for completing common tasks.
      - 
- 5.2.2 Single/Multi-Factor Authentication (MFA)
- **Authentication Methods**:
  - ğŸ“—Passwords Only: the least secure ğŸ˜ 
  - ğŸ“—Password and (SMS or Voice) â˜¹ï¸ SMS messages are not encrypted, meaning that they could be sniffed and captured. 
  - ğŸ“—Password and (Authenticator App, Software OATH/Tokens OTP, Hardware OATH/Tokens OTP). OTH tokens are one-time codes that changes every few minutes/seconds. ğŸ™‚
  - ğŸ“—Passwordless: It is convinient and also reduces phishing exposure. Strong passwords can be diffuclt to remember. Reduces password re-use. Passwords are also subject to replay attacks. The are cost concerns, and biometric privacy concerns. Passwordless authentication leverages applications and capabilities such as built-in biometric authentication mechanisms. ğŸ˜„ Examples include:
     - ğŸ””Windows Hello for Business: Uses biometrics and supports relying party that supports Fast ID Online FIDO v2.0 authentication
     - ğŸ””FIDO2 Security Key: Hardware that uses ğŸ“public-key assymetric cryptograpgy for user authentication
     - ğŸ””Authenticator App: Authenticator Apps can also be used as the primary form of authentication to sign into popular cloud identities. It can also be used as additional verification option for self-service password reset or MFA. 
- **OATH token**: is a hardware or software-based authentication device that generates a one-time password (OTP) for secure access to systems, applications, or data. It is based on the OATH (Initiative for Open Authentication) standards, particularly the Time-based One-Time Password (TOTP) and HMAC-based One-Time Password (HOTP) algorithms.
  - **TOTP**: Generates OTPs based on the current time and a shared secret. The OTP is typically valid for a short period (e.g., 30 seconds).
  - **HOTP**: Generates OTPs based on a counter that increments each time an OTP is requested, along with a shared secret.
  - **Tokens** are hardware devices (something you have) that generate a one-time password (OTP) based on time or an algorithm. They are typically combined with another factor like a password to authenticate users.
      - ğŸŒ¤ï¸**Hardware Tokens**: Physical devices that display OTPs, such as key fobs or cards. Displays a key that refreshes every 30 seconds.
      - ğŸŒ¤ï¸**Software Tokens**: Applications that run on smartphones or computers, generating OTPs. Examples include Google Authenticator or Authy. Microsoft Authenticator App is a software based OATH.
    - **Single-factor authentication**: any authentication using only one proof of identity
    - **Two-factor authentication (2FA)**: requires two different proofs of identity
    - **Multifactor authentication (MFA)**: any authentication using two or more factors
        - multifactor auth must use multiple types or factors, such as something you know and something you have
        - note: requiring users to enter a password and a PIN is NOT multifactor (both are something you know)
        - Type 1 + Type 2 + Type 3: A user needs to enter a password (ğŸ›ï¸Type 1 something you know âœï¸), use a smart card (ğŸ›ï¸Type 2 something you have âœï¸), and undergo a retina scan (ğŸ›ï¸Type 3 something you are âœï¸). ğŸ›ï¸Somehwere you are: A callback to a landline phone number is an example of a "somewhere you are" factor because of the fixed physical location of a wired phone. 
        - Yubikeys, Titan Security Keys, and similar devices are examples of tokens i.e Type 2
        - **ğŸ””Synchronous** soft tokens, such as Google Authenticator, use a time-based algorithm that generates a constantly changing series of codes. A synchronous token generates and displays onetime passwords e.g every 60 seconds, that are synchronized with an authentication server.
        - **ğŸ””Asynchronous** tokens typically require a ğŸ“challenge to be entered on the token to allow it to calculate a response, which the server compares to the response it expects. An asynchronous token uses a challenge-Â­response process to generate the onetime password.
    - Two-factor methods:
        - ğŸ–**HMAC-based One-Time Password (HOTP)** Hash Message Authentication Code (HMAC) includes a hash function used by the HMAC-based One-Time Password (HOTP) standard to create onetime passwords. It typically creates HOTP values of six to eight numbers. This is similar to the ğŸ“asynchronous dynamic passwords created by tokens. The HOTP value remains valid until used. HMAC-based one-time password (HOTP) tokens or asynchronous dynamic password tokens are devices or applications that generate passwords based on a nonrepeating one-way function, such as a hash or hash message authentication code (HMACâ€”a type of hash that uses a symmetric key in the hashing process) operation. 
        - ğŸ–**Time-based One-Time Password (TOTP)**: similar to HOTP, but uses a timestamp and remains valid for a certain time frame (e.g. 30 or 60 seconds). It is similar to the ğŸ“synchronous dynamic passwords used by tokens. The TOTP password expires if the user doesnâ€™t use it within the time frame. 
            - e.g. phone-based authenticator app, where your phone is mimicking a hardware TOTP token (combined with userid/password is considered two-factor or two-step authentication)
        - ğŸ–**Email challenge**: popular method, used by websites, sending the user an email with a PIN
        - ğŸ–**Short Message Service (SMS)** to send users a text with a PIN is another 2-factor method; note that âœï¸NIST SP 800-63B points out vulnerabilities, and deprecates use of SMS as a two-factor method for federal agencies
- **Biometric**: Biometric methods identify users based on physical characteristics such as fingerprints. During enrollment, a subjectâ€™s biometric factor is sampled and stored in the deviceâ€™s database. This stored sample of a biometric factor is the ğŸ””reference profile (also known as a ğŸ””reference template). The ğŸ””throughput rate (ideally 6 seconds) is the amount of time the system requires to scan a subject and approve or deny access.
    - ğŸ›ï¸Biometric systems using a one-to-many search provide identification by searching a database for a match.
    - ğŸ›ï¸Biometric systems using a one-to-one search provide authentication.
- The more complex or detailed a biometric characteristic, the longer processing takes. Physiological biometric methods include fingerprints, face scans, retina scans, iris scans, palm scans (also known as palm topography or palm geography), and voice patterns:
    - âœ´ï¸Fingerprints: Fingerprints have ğŸ“loops, ğŸ“whorls, ğŸ“ridges, and ğŸ“bifurcations (also called minutiae) and fingerprint readers match the minutiae to data within a database.
    - âœ´ï¸Face Scans: Face scans use the geometric patterns of faces for detection and recognition.
    - âœ´ï¸Retina Scans: Retina scans focus on the pattern of blood vessels at the back of the eye. They are the most accurate form of biometric authentication and can differentiate between identical twins. However, some privacy proponents object to their use because they can reveal medical conditions, such as high blood pressure and pregnancy.
    - âœ´ï¸Iris Scans: Focusing on the colored area around the pupil, iris scans are the second ğŸ“most accurate form of biometric authentication. Iris scans are considered more acceptable by general users than retina scans because scans can occur from far away and are less intrusive. Scans can often be done from 6 to 12 meters away (about 20 to 40 feet). However, some scanners can be fooled with a high-quality image in place of a personâ€™s eye. Additionally, accuracy can be affected by changes in lighting and the usage of some glasses and contact lenses. Iris scans have a longer useful life than many other types of biometric factors because they don't change throughout a person's life span (unless the eye itself is damaged).
    - âœ´ï¸Hand geometry Scans: assess the physical dimensions of an individual's hand but do not verify other unique factors about the individual, or even verify if they are alive. This means that hand geometry scanners should not be implemented as the sole authentication factor for secure environments. 
    - âœ´ï¸Palm Scans: Palm scanners scan the palm of the hand for identification. They use near-infrared light to measure vein patterns in the palm, which are as unique as fingerprints.
    - Biometric devices are rated for performance by examining the different types of errors they produce:
      - **ğŸ”¥Crossover Error Rate CER**: point at which false acceptance (Type 2) error rate equals the false rejection (Type 1) error rate for a given sensor, in a given system and context; it is the optimal point of operation if the potential impacts of both types of errors are equivalent. Devices with lower CERs are more accurate than devices with higher CERs. The CER is less subject to manipulation and is, therefore, the best metric to use for evaluating systems. It is used as a way to measure the accuracy of biometric systems. CER is a standard used to assess biometric devices. If the CER for a device does not fit the needs of the organization, you should assess other biometric systems to find one with a lower CER. 
      - **ğŸ”¥FRR**: False Rejection Rate (ğŸ‘˜Type 1 Error) incorrectly denying authentication to a legit identity and therefore denying access (Similar to False Positive of IPS). Organizations that have very strict security requirements that don't have a tolerance for false acceptance want to lower the false acceptance rate, or FAR, to be as near to zero as possible. That often means that the false rejection rate, or FRR, increases. 
      - **ğŸ”¥FAR**: False Acceptance Rate (ğŸ‘˜Type 2 Error) incorrectly authenticating a claimed identity as legit, recognizing and granting access on that basis (Similar to False negetive of IPS). Type 2 errors occur in biometric systems when an invalid subject is incorrectly authenticated as a valid user. Adding a second factor can ensure that users who might be incorrectly accepted are not given access due to a higher than desired false acceptance rate (FAR) from accessing a system. 

- 5.2.3 Accountability
    - Two important security elements in an access control system are authorization and accountability
        - **Authorization**: subjects are granted access to objects based on proven identities
        - **Accountability**: users and other subjects can be held accountable for their actions when auditing is implemented
            - Accurate identification and authentication are required to support accountability.
            - Authentication is necessary to ensure a network supports accountability. Note that authentication indicates that a user claimed an identity such as with a username and proved the identity such as with a password. In other words, valid authentication includes identification. However, identification doesn't include authentication. If users could just claim an identity without proving it's their identity, the system doesn't support accountability.
    - ğŸ’¥**Auditing**: tracks subjects and records when they access objects, creating an audit trail in one or more audit logs. Audit trails provide documentation on what happened, when it happened, and who did it. IT personnel create audit trails by examining logs.
        - Auditing provides ğŸ“accountability
        - Auditing occurs after the logs have been created
        - Logs record events, including who took an action, but without accurate identification and authentication, the logs canâ€™t be relied on.
        - identification when combined with authentication provides accountability.
        - ğŸ“Accurate identification and authentication are required to ensure logs accurately support accountability. Logs record events, including who took an action, but without accurate identification and authentication, the logs can't be relied on. 
        - Audit logging when combined with user accounts that can reliably be expected to only be accessible to a specific user due to the use of multifactor authentication is frequently used to provide strong accountability for actions taken via systems and applications. 
        - **File Integrity Checker** is designed specifically to monitor and detect changes to files and directories. It works by creating a baseline of file attributes (such as checksums or hashes) and then ğŸ§ regularly checking/actively monitoring for any deviations from this baseline. This allows it to identify unauthorized or unexpected changes to content.
        - **Audit Logs**: track and record activities on a system, including changes to files and content. While they provide valuable information about who made changes and when, they are more about recording events rather than actively monitoring for unauthorized changes.
            - Accountability is possible by reviewing logs and tracking user activity.
            - Accountability is maintained by monitoring the activities of subjects and objects as well as monitoring core system functions that maintain the operating environment and the security mechanisms. 
- 5.2.4 Session management
    - Session management is important to use with any type of authentication system to prevent unauthorized access
    - Desktop/laptops: recommendation to use screensavers, although modern OSs have timeout/lock features
    - Secure online sessions should terminate after a timeout period. Common session management techniques include the use of ğŸ“cookies, ğŸ“hidden form fields, ğŸ“URL rewriting, and built-in frameworks like Javaâ€™s ğŸ“HTTPSession.
    - long session ID (often 128 bits or longer) and session ID entropy (randomness)  make ğŸ“session guessing difficult for hackers. This makes brute-force or algorithmic guessing attacks unlikely unless there is a flaw in the implementation. 
    - The Open Web Application Security Project (OWASP) publishes â€œcheat sheetsâ€ that provide app developerâ€™s specific recommendations
    - It is also a best practice to make sure the session ID itself is meaningless to prevent information disclosure attacks
- 5.2.5 Registration, proofing, and establishment of identity
    - Within an organization, new employees prove their identity with appropriate documentation during the hiring process
        - in-person identity proofing includes things like passport, DL, birth cert etc
    - ğŸ†Knowledge-based authentication relies on preset questions such as "What is your pet's name?" and the answers. Online orgs often use knowledge-based authentication (KBA) for identity-proofing of someone new (e.g. a new customer creating a new bank/savings account). It can be susceptible to attacks because of the availability of the answers on social media or other sites. Knowledge-based authentication (KBA) processes ask a user a series of questions based on their history that is recorded in ğŸ“authoritative sources.
    - ğŸ†Dynamic knowledge-based authentication relies on facts or data that the user already knows that can be used to create questions they can answer on an as-needed basis (for example, a previous address or a school they attended).
        - example questions include past vehicle purchases, amount of mortgage payment, previous addresses, DL numbers
        - ğŸ¥›Identity proofing can be done by comparing user information that the organization already has, like account numbers or personal information.
             - they then query authoritative information (e.g. credit bureaus or gov agencies) for matches
        - ğŸ¥›Out-of-band identity proofing relies on an alternate channel like a phone call or text message. 
    - ğŸ† Cognitive Passwords: security questions that are gathered during account creation, which are later used as questions for authentication (e.g. name of pet, color of first car etc). A cognitive password asks a series of questions, but these are questions that the user previously answered, such as your favorite color. A cognitive password authenticates users based on a series of facts or answers to questions that they know. Preset questions for cognitive passwords typically rely on common information about a user like their mother's maiden name or the name of their pet, and that information can frequently be found on the internet. The best cognitive password systems let users make up their own questions.
        - one of the flaws associated with cognitive passwords is that the information is often available on social media sites or general internet searches
- 5.2.6 Federated Identity Management (FIM)
    - Federated Identity Management (FIM) systems (a form of SSO. ğŸ“SSO is a benefit of identity management, not a type of identity management.) are often used by cloud-based apps
    - A federated identity links a userâ€™s identity in one system with multiple identity management systems
        - ğŸ”¶Two-Way Transitive Trust: Both domains trust each other, and this trust extends to other domains that they trust. If Domain A trusts Domain B, and Domain B trusts Domain C, then Domain A also trusts Domain C automatically.
        - ğŸ”¶One-Way Transitive Trust: Only one domain trusts the other, and this trust can extend to other domains. If Domain A trusts Domain B, users from Domain B can access resources in Domain A, but not the other way around. If Domain B also trusts Domain C, then users from Domain C could access Domain A's resources as well.
        - ğŸ”¶One-Way Nontransitive Trust: Only one domain trusts the other, and this trust does not extend to any other domains.
        - ğŸ”¶Two-Way Nontransitive Trust: Both domains trust each other, but the trust does not extend to any other domains. Domain A and Domain B trust each other directly. However, if Domain B trusts Domain C, this trust doesn't extend to Domain A. Domain A and C would need a separate trust set up if they need to communicate.
    - Identity systems from different orgs have established trust among themselves and agree to trust each otherâ€™s identity assertions
    - FIM allows multiple orgs to join a federation or group, agreeing to share identity information
        - users in each org can log in once in their own org, and their credentials are matched with a federated identity
        - users can then use this federated identity to access resources in any other org within the group
        - where each organization decides what resources to share
    - Methods used to implement federated identity management systems include:
        - ğŸŠSecurity Assertion Markup Language (SAML): SAML is an ğŸ“XML-based framework used to exchange user information for single sign-on(SSO) between federated organizations within a federated identity management system. Federated organizations use the Security Assertion Markup Language (SAML) to support single sign-on (SSO) capabilities on the internet. SAML is an open, XML-based standard used to provide authorization, attribute information, and authentication data.
        - ğŸŠOAuth (most widely used and integrates with 3rd Parties). OAuth is the most widely used open standard for ğŸ§ authorization and ğŸ§ delegation of rights for cloud services. OAuth is an authorization framework that exchanges information using ğŸ“APIs. The anti-forgery state token exchanged during OAuth  sessions is intended to prevent cross-site request forgery. Cross-Â­site request forgery attacks, abbreviated as XSRF or CSRF attacks, are similar to cross-Â­site scripting attacks but exploit a different trust relationship. XSS attacks exploit the trust that a user has in a website to execute code on the userâ€™s computer. **XSRF** attacks exploit the trust that remote sites have in a userâ€™s system to execute commands on the userâ€™s behalf.
        - ğŸŠOpenID Connect (OIDC) (used for authentication): would allow to use an account from another service to acces an  application
        - OpenID is used for ğŸ§ authentication. OpenID would you to use an account from another service with your application. OpenID is used to sign in using credentials from an identity provider to other services, such as when you log in with Google to other sites
        - OpenID Connect is a RESTful, JSON-based authentication protocol that, when paired with OAuth, can provide identity verification and basic profile information.
             - OpenID Provider (OP): The service that authenticates users.
             - Relying Party (RP): The website or app trusting the OP for user authentication.
             - End User: The person logging in using OpenID credentials. User logs in to the RP using their OpenID.
             - RP redirects to the OP e.g Google for authentication. OP authenticates the user and sends a response back to the RP.
             - RP verifies the response. User gains access to the RP. **Note** Allowing the relying party to provide the redirect to the OpenID provider could allow a phishing attack by directing clients to a fake OpenID provider that can capture valid credentials.
    - **Proxied federation** is a method of identity management that allows identity providers (IdPs) and relying parties (RPs) to communicate through a third-party service, known as a proxy. This allows the IdP and RP to remain anonymous to each other, and it helps to protect the privacy of subscriber lists. Federation proxies can simplify technical integration between the RP and IdP by providing a common interface for integration. Additionally, to the extent a proxy effectively blinds the RP and IdP from each other, it can provide some business confidentiality for organizations that want to guard their subscriber lists from each other.
    - ğŸ‘£Cloud-based federation typically uses a third-party service to share federated identities
    - Federated identity management systems can be hosted on-premises, in the cloud, or in a combination of the two as a hybrid system. Hybrid federation e.g occurs where authentication occurs on-premises and services are provided through a federated identity service in the cloud
    - Upon implementing a cloud-based federation for identity sharing, individuals will typically use their existing ğŸ“normal account credentials to log in. This is facilitated by the federation service, which allows for the secure sharing of identities across different systems and providers. 
- 5.2.7 Credential management systems
    - **Credential management systems**: provide storage space for usernames and password
        - e.g. web browsers that remember usernames and passwords for visited sites
    - The World Wide Web Consortium (W3C) published the Credential Management Level 1 API as a working draft in January 2019, which many browsers have adopted
    - Credential management systems offer features like password management, multi-factor authentication to retrieve passwords, logging, audit, and password rotation capabilities. 
    - Some federated identity management solutions use the Credential Management API, allowing web apps to implement SSO using a federated identity provider
        - e.g. using your Google or Facebook account to sign into Zoom
- 5.2.8 Singe Sign On (SSO)
    - **Single Sign-On (SSO)**: a centralized access control technique allowing a subject to be authenticated once on a system and access multiple resources without authenticating again
    - ğŸš¡Advantages of using SSO include:
        - reduces the number of passwords that users need to remember, and they are less likely to write them down
        - eases administration by reducing the number of accounts
        - SSO solutions and centralized administration and make it easier for administrators to manage user accounts.
        - The primary purpose of Single Sign-On (SSO) is to address Accountability and Assurance.
            - ğŸ”¨Accountability: SSO helps in ensuring that user activities can be accurately traced back to the individual user, which is crucial for maintaining accountability. This is because SSO centralizes authentication, ensuring that users are properly authenticated and their actions can be logged and audited.
            - ğŸ”¨Assurance: SSO also provides assurance that the authentication process is robust and secure, reducing the risk of unauthorized access by enforcing strong authentication mechanisms consistently across multiple applications.
    - ğŸš¡Disadvantages:
        - once an account is compromised, an attacker gains unrestricted access to all of the authorized resources
    - Within an organization, a central access control system, such as a directory service, is often used for SSO
        - **Directory Service**: a centralized database that includes information about subjects and objects, including authentication data
        - many directory services are based on the Lightweight Directory Access Protocol (LDAP)
- 5.2.9 Just-In_time (JIT)
    - Federated identity solutions that support just-in-time (JIT) provisioning automatically create the relationship between two entities so that new users can access resources
    - A JIT solution creates the connection without any administrative intervention
    - JIT systems commonly use SAML to exchange required data

[5.3](#5.3) Federated Identity with a third-party service (OSG-9 Chpt 13)
- 5.3.1 ğŸ¥©On-premise
    - Federated identity management can be hosted on-premise, and typically provides an organization with the most control
- 5.3.2 ğŸ¥©Cloud
    - Cloud-based apps used federated identify management (FIM) systems, which are a form of SSO. E.g Shibboleth is a federated identity solution designed to allow web-based SSO
    - Cloud-based federation typically uses a third-party service to hsare federated identities (e.g. training sites use federated SSO systems)
        - commonly matching the user's internal login ID with a federated identify
- 5.3.3 ğŸ¥©Hybrid
    - A hybrid federation is a combination of a cloud-based solution and an on-premise solution
    -  Adopting a hybrid cloud and local authentication system can ensure that internet or server outages are handled, allowing authentication to work regardless of where the user is or if their home organization is online.

[5.4](#5.4) Implement and manage authorization mechanisms (OSG-9 Chpt 14)
- 5.4.1 â„ï¸**Role Based Access Control (RBAC)**
    - A key characteristic of the Role-Based Access Control (RBAC) model is the use of roles or groups
    - Instead of assigning permissions directly to users, user accounts are placed in roles and administrators assign privileges to the roles (typically defined by job function)
        - if the user account is in a role, the user has all privileges assigned to the role
    - MS Windows OS uses this model with groups
    - A role-Â­based access control (RBAC) model can group users into roles based on the organizationâ€™s hierarchy
    - RBAC uses a well-defined collection of named job roles for access control. Administrators grant each job role with the privileges they need to perform their jobs. 
    - it is based on role or group membership, and users can be members of multiple groups. Users are not limited to only a single role.
    - RBAC models are based on the hierarchy of an organization, so they are ğŸ“hierarchy based.
    - It is nondiscretionary model managed by a central authorityğŸ”¥ to determine which objects subjects can access
- 5.4.2 â„ï¸**Rule Based access control**
    - A key characteristic of the Rule-Based access control model is that it applies global rules to all subjects
    - A rule-based access control model uses ğŸ“global rules applied to all users and other subjects equally.
        - e.g. firewalls uses rules that allow or block traffic to all users equally
    - Rules within the rule-based access control model are sometimes referred to as restrictions or filters
    - It uses a global rules applied to all users and other subjects equally.
    - It is a Nondiscretionary access controls that uses centralized management ğŸ”¥, such as a rules deployed on a firewall.
- 5.4.3 Mandatory Access Control (MAC)
    - â„ï¸**Mandatory Access Control (MAC)**: access control that requires the _system_ itself to manage access controls in accordance with the org's security policies. Users cannot delegate rights.
    - A key characteristic of the MAC model is the use of labels applied to ğŸ“both subjects and objects
        - e.g. a label of top secret grants access to top-secret documents
    - When documented in a table, the MAC model sometimes resembles a ğŸ“lattice or matrix (i.e. climbing rosebush framework), so it is referred to as a lattice-based model. ğŸ“Biba integrity model uses this.
    - The MAC model uses labels to identify the upper and lower bounds of classification levels, and these define the level of access for subjects.
    - Mandatory Access Control (MAC) uses data classification levels, the user's clearance, and the corporate policy to make decisions. This is more commonly seen in government and military environments, not public companies due to its complexity.
    - MAC model assigns access based on a user's ğŸ“need to know and organization policies.
    - In a mandatory access control system, the ğŸ“operating system enforces access control,
    - Mandatory access control systems are based on a lattice-based model. Lattice-based models use a matrix of classification labels to compartmentalize data.
    - ğŸ“ MAC model doesnâ€™t use a centralized environment.
    - MAC is a nondiscretionary access control model that uses labelsğŸ”¥
    - (MAC) model supports three environments: hierarchical, compartmentalized, and hybrid.
        - â˜‘ï¸In a hierarchical environment, the various classification labels are assigned in an ordered structure from low security to high security. Mandatory access control systems can be hierarchical, where each domain is ordered and related to other domains above and below it. It grants users access using predefined labels for specific labels. The hierarchical environment uses levels to assign access.
        - â˜‘ï¸compartmentalized environment ignores the levels, and instead only allows access for individual compartments on any level.  MAC systems can be compartmentalized, where there is no relationship between each domain; 
        - â˜‘ï¸hybrid environment is a combination of a hierarchical and compartmentalized environment. Hybrid environments combine both hierarchical and compartmentalized environments so that security levels have sub-compartments.  

- 5.4.4 Discretionary Access Control (DAC)
    - â„ï¸**Discretionary Access Control (DAC)**: access control model in which the system owner decides who gets access
    - A key characteristic of the DAC model is that every object has an owner, and the owner can grant or deny access to any other subjects
        - e.g. you create a file and are the owner, and can grant permissions to that file
    - New Technology File System (NTFS) used in Windows, uses the DAC model
    - MAC, RBAC, and rule-Â­based access control) are nondiscretionary models.
    - A system that employs Discretionary Access Controls (DACs) allows the ğŸ“Data Owner to control and define each object's access. All objects have owners and access control is based on the discretion or decision of the owner.
- 5.4.5 Attribute Based Access Control (ABAC) or Policy-Based Access Control
    - â„ï¸**Attribute-Based Access Control (ABAC)**: an access control paradigm where access rights are granted to users with policies that combine attributes together. Attributes used for ABAC often fall into one of four categories: ğŸsubject attributes like department or title; ğŸaction attributes like the ability to view, edit, or delete; ğŸobject attributes that describe the object that can be impacted; and ğŸcontextual attributes like location, time, or elements.
    - A key characteristic of the ABAC model is its use of rules that can include multiple attributes
        - this allows it to be much more flexible than a rule-based access control model that applies the rules to all subjects equally
        - many software-defined networks (ğŸ“SDNs) use the ABAC model
    - ABAC allows administrators to create rules within a policy using plain language statements such as "Allow Managers to access the WAN using a mobile device"
    -  Attribute-based information controls like those described in NIST SP 800-162 can take many details about the user, actions, and objects into consideration before allowing access to occur.
        - Authentication that takes attributes such as location, device, and time of day into account is context-aware authentication. This allows organizations to make choices about whether the authentication is appropriate and allowed in addition to the use of credentials. The decision is based on contextual information, not user knowledge or identity factors, which are used only to authenticate. 
- 5.4.6 â„ï¸**Risk based access control**
    - Risk-based access control model grants access after evaluating risk; evaluating the environment and the situation and making risk-based decisions using policies embeded within software
        - Using machine learning, making predictive conclusions about current activity based on past activity
        - risk-Â­based access control model can require users to authenticate with multifactor authentication
        - it evaluates the ğŸ“environment and the ğŸ“situation and then makes access decisions based on coded policies
        - A risk-based access control model can be coded to block malicious traffic from infected IoT devices. It evaluates the environment and the situation and makes decisions to block traffic that is abnormal. 
- 5.4.7 â„ï¸**Task based access control**
    - TBAC is similar to RBAC, but instead of being assigned to one or more roles, each user is assigned an array of tasks.
- [5.5](#5.5.0) ğŸ”´**Zero-Trust Access Policy Enforcement**:
  - ğŸ“**Policy Enforcement Point (PEP)**: Responsible for enabling, monitoring and terminating connections between a subject (such as user or device) and an enterprise resource.
     - It acts as a ğŸ“gateway the enforces access control policies.
     - In a zero trust reference model-based design, subjects connect through a policy enforcement point.
     - A policy enforcement point in a zero trust environment receives authorization requests and then sends them to the policy decision point. They are used anywhere that authorization controls are needed.
     - When an access request occurs, the PEP evaluates the request against predifined policies and then applies the neccessary controls.
     - E.g PEP might enforce MFA authentications for access request from unexpected locations. in this case, it is dynamic based on conditions/contexts
     - PEP enforces policies at the connection level
  - ğŸ“**Policy Decision Point (PDP)**: This is where the decisions are made based on various factors such as user identity, device health and risk assessment.
     - it evaluates the context of an access request and decides whether it should be allowed, denied, or subjected to additonal controls
     - it considers the 5 Ws (Who, What, When, Where, Why)
     - PDP makes access decision based on contextual information
     - The NIST zero trust reference design includes both the ğŸ“Policy Engine and the ğŸ“Policy Administrator as part of the policy decision point.
          - ğŸ“**Policy Engine (PE)**: The policy engine makes policy decisions based on rles that are then acted on by the policy administrator, granting or denying access to enterprise resources. 
     - With regards to the key elements of Zero trust architecture, as it relates to access policy enforcment, the following are described in NIST 800-207.
    - ğŸ®**Control Plane**: These drive the policy-based decision logic for the concept of Zero trust. Involves the following:
       - Adaptive Identity: Changes the way that the system asks a user to authenticate based on context of the request. e.g user location, device health, approved app, riks levels of user
       - Threat Scope reduction: An end goal of ZTNA to decrease risks to the organisation.
       - Policy-Driven Access Control: Control based on a users identity rather than simply thier systems location. example conditional access feature in MIcrosft's Entra ID.
       - Policy Administrator: Responsible for communicating the decisions made by the policy engine It is a funtion not a person.
       - Policy Engine: Decides whether to grant access to a resource for a given subject. E.g Microsoft Entra ID is a policy engine. The policy administrator and the policy engine together give us the PDP functionality.
    - ğŸ®**Data Plane**: These enforces the decision defined in the control plane. Involves the following:
       - Implicit Trust Zones: Part of the traditional security approach in which firewalls and other security devices formed a perimeter. systems belonging to an organisation are placed inside this boundary.
       - Subject/System: Subject is the user who wishes to access a resource. The system is a non-human entity often used by the user to access this resource.   
       - Policy Enforcement Point: When a user or system request access to a resource, it is the PEP that evaluates it against predefined policies and applies the neccessary controls.

[5.5](#5.5) Manage the identity and access provisioning lifecycle (OSG-9 Chpts 13,14)
- 5.5.1 Account accesss review
    - Administrators need to periodically review user, system and service accounts to ensure they meet security policies and that they donâ€™t have excessive privileges
    - Be careful in using the local system account as an application service account; although it allows the app to run without creating a special service account, it usually grants the app more access than it needs
    - You can use scripts to run periodically and check for unused accounts, and check priveleged group membership, removing unauthorized accounts
    - Guard against two access control issues:
        - ğŸ””excessive privilege: occurs when users have more privileges than assigned work tasks dictate; these privileges should be revoked
        - ğŸ””creeping privileges (AKA privilege creep or ğŸ“aggregation): user accounts accumulating additional privileges over time as job roles and assigned tasks change
- 5.5.2 Provisioning and deprovisioning
    - Identity and access provisioning lifecycle refers to the creation, management, and deletion of accounts
        - this lifecycle is important because without properly defined and maintained user accounts, a system is unable to establish accurate identity, perform authentication, provide authorization, and track accountability
    - ğŸŒ²**Provisioning/Onboarding**
        - proper user account creation, or provisioning, ensures that personnel follow specific procedures when creating accounts
        - ğŸ“Provisioning includes the creation, maintenance, and removal of user objects from applications, systems, and directories. Registration occurs when users are enrolled in a biometric system for example;
            - ğŸ©¹Enrollment, or registration, is the initial creation of a user account in the provisioning process. Clearance verification and background checks are sometimes part of the process that ensures that the identity of the person being enrolled matches who they claim to be
            - new-user account creation is AKA enrollment or registration
            - ğŸ©¹Registration is the process of adding a user to an identity management system. This includes creating their unique identifier and adding any attribute information that is associated with their identity.
            -  review of provisioning processes typically involves checking logs, reviewing the audit trail, or performing a manual review of permissions granted during the provisioning process.
        - ğŸŒ‘User access Modification: involves updating or changing a user's access rights when their role within the organization changes.
        - ğŸŒ‘User access Recertification: Involves periodic reviews to confirm that users have the appropriate access rights,
        - **Workflow provisioning**: Provisioning that occurs through an established workflow, such as through an HR process, is workflow-based account provisioning
        - **automated provisioning**: information is provided to an app, that then creates the accounts via pre-defined rules (assigning to appropriate groups based on roles)
            - automated provisioning systems create accounts consistently
        - provisioning also includes issuing hardware, tokens, smartcards etc to employees
        - itâ€™s important to keep accurate records when issuing hardware to employees
        - after provisioning, an org can follow up with onboarding processes, including:
            - the employee reads and signs the acceptable use policy (AUP)
            - explaining security best practices (like infected emails)
            - reviewing the mobile device policy
            - ensuring the employeeâ€™s computer is operational, and they can log in
            - configure a password manager
            - explaining how to access help desk
            - show to access, share and save resources
    - ğŸŒ²**Deprovisioning/Offboarding**
        - Deprovisioning/offboarding occurs when an employee leaves the organization or is transferred to a different department
        - **Account revocation**: deleting an account is the easiest way to deprovision
            - an employee's account is usually first disabled
            - supervisors can then review the userâ€™s data and determine if anything is needed
            - note: if terminated employee retains access to a user account after the exit interview, the risk for sabatage is very high
        - Deprovisioning includes collecting any hardware issued to an employee such as laptops, mobile devices and auth tokens
- 5.5.3 Role definition
    - Employee responsibilities can change in the form of transfers to a different role, or into a newly created role
        - for new roles, itâ€™s important to define the role and the privileges needed by the employees in that role
    - Roles and associated groups need to be defined in terms of privileges
- 5.5.4 Privilege escalation (e.g. managed service accounts, use of usdo, minimizing its use)
    - Privilege escalation refers to any situation that gives users more privileges than they should have
    - Attackers use privilege escalation techniques to gain elevated privileges
    - ğŸ**Horizontal privilege escalation**: gives an attacker similar privileges as the first compromised user, but from other accounts. Multifactor authentication is most likely to limit horizontal privilege escalation by making it difficult to access user accounts and to authenticate to a compromised account. Limiting permissions for groups and accounts can also help
        - Horizontal privilege escalation occurs when a user gains access to the privileges of another user who has similar permissions. In this type of attack, the malicious user does not increase their privilege level but rather "horizontally" moves to impersonate or access another userâ€™s data or capabilities.
        - If Alice exploits a vulnerability to access Bobâ€™s account and perform actions as if she were Bob, this would be horizontal privilege escalation. 
    - ğŸ**Vertical privilege escalation**: provides an attacker with significantly greater privileges
        - e.g. after compromising a regular userâ€™s account an attacker can use vertical privilege escalation techniques to gain administrator privileges on the userâ€™s computer
        - Vertical privilege escalation occurs when a user gains access to higher-level privileges than they are supposed to have. This usually means moving from a lower privilege level, like a standard user, to a higher one, such as an administrator or root user.
        - the attacker can then use horizontal privilege escalation techniques to access other computers in the network
        - this horizontal privilege escalation throughout the network is AKA ğŸ“lateral movement
        - Disabling unused ports and services and sanitizing user inputs both address threats that are most frequently associated with vertical privilege escalation attacks.
- âœ´ï¸**Service Accounts**: When a software is installed on a computer, it may require privileged access to run and access other resources (systems/data). Service accounts are a low level adminsitrative accounts without human intervention.
   - it is an account used to run an application
   - In the cloud, it is often called service principle.
   - In the cloud, similar concepts exists for clud resources such as VMs, that provides an identity for that resource to access other resources. In Azure (_Managed Identity_), in AWS (_Service Roles_), in Google cloud (_Service Account Identity_).
   - Least privilege and life cycle managment are all equally important for service accounts.
   - The most important step in securing service accounts is to ensure that they have only the rights that are absolutely needed to accomplish the task they are designed for. Disabling interactive logins is important as well.
   - Service accounts are commonly set to not have expiring passwords to prevent service outages. Organizations may choose to rotate passwords on a regular basis using automation tools as part of their password management strategy to help avoid issues with exposed or compromised service passwords.
[5.6](#5.6) Implement authentication systems (OSG-9 Chpt 14)
- 5.6.1 OpenID Connect (OIDC) / Open Authorization (Oauth)
    - â„ï¸**OAuth 2.0** authorization framework enables third-party apps to obtain limited access to an HTTP service, either on behalf of a resource owner (by orchestrating an approval interaction), or by allowing third-party applications to obtain access on its own behalf
    - For example, you can log onto your social media account and then connect to the web-based application without authenticating again. 
    - OAuth is an open framework used for authentication and authorization protocols
    - OAuth provides authorization
    - OAuth is used to provide secure delegated access
    - OAuth provides the ability to access resources from another service 
    - OAuth is an open standard for authentication allowing the use of credentials from one site on third-party sites
    - OAuth Integration: ğŸ”ƒ User attempts to access e-commerce application and chooses to login with Google Federation â¡ï¸ Anti-Forgery token is created and sent to Google Server â¡ï¸ Toke COnfirmation and authorization code is sent to by Google server to Ecommerce application server â¡ï¸ Ecommerce application server sends an exchange code access and ID token to Google Server â¡ï¸ BGoogle server sends a response token â¡ï¸ Ecommerce application calls Google API using token.
    - The anti-forgery state token exchanged during OAuth sessions is intended to prevent cross-site request forgery ğŸ“XSRF/CSRF. This makes sure that the unique session token with the authentication response from Google's OAuth service is available to verify that the user, not an attacker, is making a request.
    - The most common protocol built on OAuth is OpenID Connect (OIDC) 
    - OAuth 2.0 is often used for delegated access to applications, e.g. a mobile game that automatically finds all of your new friends from a social media app is likely using OAuth 2.0
    - Conversely, if you sign into a new mobile game using a social media account (instead of creating a user account just for the game), that process might use OIDC
    - RFC ğŸ“6749 describes OAuth and is maintained by the Internet Engineering Task Force (IETF). 
    - â„ï¸**OpenID Connect (OIDC)**: an authentication layer using the OAuth 2.0 authorization framework, maintained by the OpenID Foundation, providing both authentication and authorization
    - OpenID Connect (OIDC) uses the OAuth framework (described in RFC 6749) and is maintained by the OpenID Foundation. The OpenID foundation also maintains OpenID.
    - OIDC uses ğŸ“JSON (JavaScript Object Notation) Web Tokens (JWT) -- AKA ID token that provides both authentication and profile information for internet-Â­based single sign-Â­on
    - OAuth and OIDC are used with many web-based applications to share information without sharing credentials
        - OpenID Connect is a RESTful, JSON-based authentication protocol that, when paired with OAuth, can provide identity verification and basic profile information. 
        - OIDC uses the OAuth framework for authorization and builds on the OpenID technologies for authentication
    - ğŸ“OpenID on its own provides authentication but doesnâ€™t include profile information. However OpenID Connect provides both authentication and profile information
- 5.6.2 Security Assertion Markup Language (SAML)
    - ğŸ”ï¸**Security Assertion Markup Language (SAML)**: an open XML-based standard commonly used to ğŸ“exchange authentication and authorization (AA) information between federated orgs, particularly for browser-based SSO.
    - it is used to make authorization and authentication data on first access
    - SAML provides SSO capabilities for browser access
    - SAML Integration: ğŸ”ƒ User attempts to access 3rd part application â¡ï¸ SAML integrated 3rd party solution sends a redirect to SSO URL â¡ï¸ Browser accesses SSO URL and sends to Home organisation (IDP) â¡ï¸ Home organisation authenticates user and sends SAML response to web browser â¡ï¸ Browser sends SAML response to integrated 3rd party solution â¡ï¸ SAML responsie is verified and user is logged on to the 3rd party organisation.
    - SAML is a popular SSO standard on the internet - used to exchange authentication and authorization (AA) information
    - SAML does not have a security mode and relies on ğŸ“TLS and ğŸ“digital signatures to ensure security if needed.
    - While many solutions are technical, if a trusted third party redirects to an unexpected authentication site, awareness is often the best defense.
    - Organization for the Advancement of Structure Information Standards (OASIS) maintains it
    - SAML 2 spec utilizes three entities:
        - ğŸŠPrincipal or User Agent
        - ğŸŠService Provider (SP): providing the service a user is interested in using
        - ğŸŠIdentity Provider (IdP): a third-party that holds the user authentication and authorization info. IdP can send three types of XML messages known as assertions:
             - ğŸ‰Authentication Assertion: provides proof that the user agent provided the proper credentials, identifies the identification method, and identifies the time the user agent logged on
             - ğŸ‰Authorization Assertion: indicates whether the user agent is authorized to access the requested service; if denied, includes why
             - ğŸ‰Attribute Assertion: attributes can be any information about the user agent
    - ğŸ”ï¸**Service Provisioning Markup Language (SPML)** is an XML-based language designed to allow platforms to generate and respond to provisioning requests. SPML is used to provision users, resources, and services
    - ğŸ”ï¸**Extensible Access Control Markup Language (XACML)** is used to describe access controls.  XACML is the eXtensible Access Control Markup Language, an OASIS standard used for access control decisions
  
- 5.6.3 Kerberos: ğŸ”„ Clients wants to access a Windows Server â¡ï¸ Client sends a request to AS (part of KDC) â¡ï¸ AS verifies client and responds with TGT (TGT allows authenticated users to request access to services.) â¡ï¸ Client sends the TGT to TGS (part of the KDC) â¡ï¸ TGS decrypts the TGT, verify the client, sends a service ticket and Session Key to client â¡ï¸ client sends the service ticket and a new authenticator (encrypted with the session key) to the Windows server â¡ï¸ The server decrypts the service ticket with its own secret key and verifies the client's identity using the authenticator â¡ï¸ CLient is granted access to the server if all OK. ğŸ”„ If the client has already authenticated to the KDC and wants access to another server, the client sends its existing valid TGT to the KDC and requests access to the resource.
    - **Kerberos** is a network authentication protocol widely used in corporate and private networks and found in many LDAP and directory services solutions such as Microsoft Active Directory
    - It provides single sign-on and uses cryptography to strengthen the authentication process
    - Kerberos uses port ğŸ“88
    - The primary purpose of Kerberos is authentication, since it allows users to prove their identity.
    - Kerberos requires computer times to be within 5 minutes of each other
    - The purpose of Kerberos is authentication; Kerberos offers a single sign-on solution for users and protects logon credentials
    - Kerberos supports SSO in a single organization (not federation) it doesnt use ğŸš«SAML
    - Ticket authentication is a mechanism that employs a third-party entity to prove identification and provide authentication - Kerberos is a well-known ticket system
    - After users authenticate and prove their identity, Kerberos uses their proven identity to issue tickets, and user accounts present these tickets when accessing resources
    - Kerberos version 5 relies on symmetric-key cryptography (AKA secret-key cryptography) using the Advanced Encryption Standard (AES) symmetric encryption protocol
    - Kerberos provides confidentiality and integrity for authentication traffic using end-to-end security and helps protect against eavesdropping and replay attacks
    - Kerberos elements:
        - **Key Distribution Center (KDC)**: the trusted third party that provides authentication services. It has two main parts: Kerberos Authentication Server (AS) and the ticket-granting service (TGS):
            - ğŸ®**ticket-granting service (TGS)**: provides proof that a subject has authenticated through a KDC and is authorized to request tickets to access other objects
                - The TGS, or ticket-granting service (which is usually on the same server as the KDC), receives a TGT from the client. It validates the TGT and the user's rights to access the service they are requesting to use. The TGS then issues a ticket and session keys to the client. 
                - a TGT is encrypted and includes a symmetric key, an expiration time, and userâ€™s IP address. ğŸ“ a scenario where TGT is compromised, Attackers can create golden tickets after successfully exploiting Kerberos and obtaining the Kerberos service account (KRBTGT).
                - subjects present the TGT when requesting tickets to access objects
            - ğŸ®**authentication service (AS)**: hosts the functions of the KDC. It verifies or rejects the authenticity and timeliness of tickets. Often referred to as the KDC. The AS serves as the authentication server, which forwards the username to the KDC. It's worth noting that the client doesn't communicate with the KDC directly. Instead, it will communicate with the TGT and the AS, which means KDC isn't an appropriate answer here.
        - **ticket (AKA service ticket (ST))**: an encrypted message that provides proof that a subject is authorized to access an object
        - **Kerberos Principal**: typically a user but can be any entity that can request a ticket
        - **Kerberos realm**: a logical area (such as a domain or network) ruled by Kerberos
    - Kerberos login process:
        - user types a username/password into the client to initiate client/TGS key generation
        - client encrypts the username with AES for transmission to the KDC
        - the KDC verifies the username against a db of known credentials
        - the KDC generates a symmetric key that will be used by the client and the Kerberos server
            - it encrypts this with a hash of the userâ€™s password
            - the KDC also generates an encrypted timestamped TGT. Kerberos relies on properly synchronized time on each end of a connection to function.
        - the KDC then transmits the encrypted symmetric key and the encrypted timestamped TGT to the client
        - the client installs the TGT for use until it expires
            - the client also decrypts the symmetric key using a hash of the userâ€™s password
            - NOTE: the clientâ€™s password is never transmitted over the network, but it is verified
                - the server encrypts a symmetric key using a hash of the userâ€™s password, and it can only be decrypted with a hash of the userâ€™s password
                - as long as the user enters the correct password, this step works
    - When a client wants to access an object (like a hosted resource), it must request a ticket through the Kerberos server, in the following steps:
        - the client sends its TGT back to the KDC with a request for access to the resource
        - the KDC verifies that the TGT is valid, and checks its access control matrix to verify user privileges for the requested resource
        - the KDC generates a service ticket and sends it to the client
        - the client sends the ticket to the server or service hosting the resource
        - the server or service hosting the resource verifies the validity of the ticket with the KDC
        - once identity and authorization are verified, Kerberos activity is complete
            - the server or service host then opens a session with the client and begins communication or data transmission
- 5.6.4 Remote Authentication Dial-in User Service (RADIUS) / Terminal Access Controller Access Control System Plus (TACACS+)
    - â„ï¸**Remote Authentication Dial-in User Service (RADIUS)**: centralizes authentication for remote access connections, such as VPNs or dial-up access
        - a user can connect to any network access server, which then passes on the userâ€™s credentials to the RADIUS server to verify authentication and authorization and to track accounting
        - in this context, the network access server is the RADIUS client e.g router, switch, and a RADIUS server acts as an authentication server
        - the RADIUS server also provides AAA services for multiple remote access servers
        - RADIUS uses the User Datagram Protocol (UDP) by default and encrypts only the passwordâ€™s exchange
        - RADIUS using Transport Layer Security (TLS) over TCP (port ğŸ“2083) is defined by RFC 6614 
        - RADIUS uses UDP port 1812 for RADIUS messages and UDP port 1813 for RADIUS Accounting messages
        - RADIUS encrypts only the passwordâ€™s exchange by default
        - it is possible to use RADIUS/TLS to encrypt the entire session
    - â„ï¸**TACACS**: Cisco developed Terminal Access Control Access Control System Plus (TACACS+) and released it as an open standard. XTACACS is an earlier version.
        - provides improvements over the earlier version and over RADIUS, it separates authentication, authorization, and accounting into separate processes, which can be hosted on three different servers
        - TACACS+ allows authentication, authorization, and accounting to be handled independently, providing more granular control.
        - additionally, TACACS+ encrypts all of the authentication information, not just the password, as RADIUS does
        - TACACS+ uses TCP port 49, providing a higher level of reliability for the packet transmissions

- 5.6.5 Credential Managment System
    - ğŸ—³ï¸**Password Vault**: stored locally on the device and stores password so the user doesnt have to remember them
       - uses trong encyrption e.g AES-256 for secure storage
       - only as secure as the secure owner password used to protect the vault itself
       - Often uses MFA
       - Some password vaults exists in the cloud for DevOps scenarios
    - ğŸ—³ï¸**Key Managment Systems**: CSPs offer a cloud service for centralized secure stroage and access for application secrets called vaults. In Azure (Key Vault), in AWS (KMS), in Google Cloud (KMS Vault)
       - secrets can include API keys, passwords, certificates, tokens, cryptographic keys
       - The services will typicall offer programmatic access via API to support DevOps and CI/CD
       - Access control is handled at the vault-instance level and often at a secret level within
       - Secrets and keys can be protected either by software of by FIPS 14-2(3) Level 2 validated HSMs.
    - ğŸ—³ï¸**Enterprise password management tools** allow passwords to be securely generated, stored, and managed. They can provide logs of who uses passwords, when they were updated, and if they meet complexity and other requirements. Of course, this means that the keys to your environment are all in one place, so securing and managing the enterprise password manager is very important!
  
- **Authorization Mecahanisms**
    - ğŸImplicit Deny: ensures that access to an object is denied unless access has been explicitly granted to a subject. (deny by default)
    - ğŸAccess Control Matrix: a table that includes subjects, objects, and assigned privileges. An access control matrix includes multiple objects and subjects. It identifies access granted to subjects (such as users) to objects (such as files)
    - ğŸAccess control lists focus on objects and which subjects can access them. A single list of subjects for any specific object within an access control matrix is an access control list. 
    - ğŸCapability Tables: Capability tables list the privileges assigned to subjects and identify the objects that subjects can access. It list subjects and what objects they can access.They are different from ACLs in that a capability table is focused on subjects (such as users, groups, or roles). In contrast, ACLs are focused on objects.
    - ğŸConstrained Interface: Applications use constrained interfaces or restricted interfaces to restrict what users can do or see based on their privileges.
    - ğŸContent-Â­Dependent Control: This restrict access to data based on the content within an object. A database view is a content-Â­dependent control.
    - ğŸContext-Â­Dependent Control: These require specific activity before granting users access. e.g Time-based controls to logon on at certain hours
    - ğŸNeed to Know: ensures that subjects are granted access only to what they need to know for their work tasks and job functions. The need-Â­to-Â­know policy operates on the basis that any given system user should be granted access only to portions of sensitive information or materials necessary to perform some task. It is the requirement to have access to, knowledge about, or possession of data to perform specific work tasks, but no more. ğŸ””Need to know refers to permissions only
    - ğŸLeast Privilege: This ensures that subjects are granted only the privileges they need to perform their work tasks and job functions. This is sometimes lumped together with need to know. The only difference is that least privilege will also include rights to take action on a system. An organization applies the least privilege principle to ensure employees receive only the access they need to complete their job responsibilities. ğŸ””The principle of least privilege includes both rights and permissions
      - ğŸSeparation of Duties and Responsibilities: (Somtimes shorted SED) This ensures that sensitive functions are split into tasks performed by two or more employees. It helps ğŸ“prevent fraud and errors by creating a system of checks and balances. It ensures that no single entity can perform all the tasks for a job or function.
      - ğŸJob Rotation: A job rotation policy has employees rotate jobs or job responsibilities and can help detect collusion and fraud.
      - ğŸMandatory Vacation policies: ensure that employees take an extended time away from their jobs, requiring someone else to perform their job responsibilities, which increases the likelihood of ğŸ“discovering/detecting fraud.
- NoteğŸ“ When creating new user accounts, default acceess for new users should always be "No Access", if no authorization mechanism is specified. Before granting any user access to information, you should verify that the user has an appropriate clearance (clearance could be a note from CFO) as well as a business need to know the information in question.

- â„ï¸**Linux Admin Basic:**
    - ğŸThe sudo command allows a permitted user to execute a command as the superuser (root) or another user, as specified by the sudoers file. When using sudo, you enter your own user password (not the root password) to confirm your identity.
    - ğŸThe su command is used to switch to another user account, including the root account, within the current session. su is typically used when you need to operate as another user for an extended session, not just for a single command.
    - ğŸThe sudoers file is a configuration file located at /etc/sudoers. It defines which users or groups can run which commands as which users, and under what conditions. The sudoers file controls the behavior of the sudo command. It allows administrators to define privileges and policies for different users, limiting what commands they can run with sudo.
    - ğŸ–ï¸Ensure that users cannot bypass logging by switching to the root user using sudo su -. Instead, users who need the ability to perform privileged actions should be added to the sudoers list and then logged as themselves performing the actions. 
