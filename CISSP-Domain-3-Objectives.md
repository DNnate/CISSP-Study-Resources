[Domain 3](#domain3-top) **Security Architecture and Engineering**

You may find this domain to be more technical than others, and if you have experience woring in a security engineering role you likely have an advantage. If not, allocate extra time to this domain to ensure you have a good understanding of the topics
- **Algorithm**: a mathmatical function that is used in the encryption and decryption process; can be simply or very complex; also defined as a set of instructions by which encryption and decryption is done
- **Block Mode Encryption**: using fixed-length sequences of input plaintext symbols as the unit of encryption
- **Ciphertext**: altered form of a plaintext message so as to be unreadable for anyone expect the intended recipients (it's a secret)
- **Collision**: occurs when a hash function generates the same output for different inputs
- **Cryptanalysis**: study of techniques for attempting to defeat cryptographic techniques and generally information security services
- **Cryptographic Hash function**: process or function that transforms an input plaintext into a unique value called a hash (or hash value); note that they do not use cryptographic algorithms, as hashes are one-way functions where it's infeasible to determine the plaintext; Message digests are an example of cryptographic hash
- **Cryptography**: study of/application of methods to ssecure the meaning and content of messages, files etc by disguise, obscuration, or other transformations
- **Cryptosystem**: complete set of hardware, software, communictions elements and procedures that allow parties to communicate, store or use info protected by cryptographic means; includes algroithm, key, and key management functions
- **Cryptovariables(s)**: parameters associated with a particular cryptogrphic algorithm; e.g. block size, key length and number of iterations
- **Decoding**: the reverse process from encoding, converting the encoded message back to plaintext format
- **Decryption**: the reverse process from encryption
- **Encoding**: action of changing a message or set of info into another format through the use of code; unlike encryption, encoded info can still be read by anyone with knowledge of the encoding process
- **Encryption**: process and act of converting the message from plaintext to ciphertext (AKA enciphering)
- **Frequency analysis**: form of cryptanalys that uses frequency of occurrence of letters, words or symbols in the plaintext as a way of reducing the search space
- **Hybrid encryption system**: a system that uses both symmetric and asymmetric encryption
- **An initialization vector (IV)** is a random bit string (a nonce) that is the same length as the block size that is XORed with the message. IVs are used to create a unique ciphertext every time the same message is encrypted with the same key.
- **Key**: the input that controls the operation of the cryptographic algorthm, determining the behavior of the algorithm and permis the reliable encyrption and decryption of the message
- **Key pair**: matching set of one public and one private key
- **Key escrow**: process by which keys (asymmetric or symmetric) are placed in a trusted storage agent's custody, for later retrieval
- **Key generation**: the process of creating a new encryption/decryption key
- **Key recovery**: process of reconstructing an encryption key from the cyphertext alone; if there is a workable key recovery system, it means the algorithm is not secure
- **Key space**: represents the total number of possible values of keys in a cryptographic algorithm or password
- **One-time pad**: series of randomly generated symmetric encryption keys, each one to be used only once by the sender and recipient
- **Out-of-band**: transmitting or sharing control information (e.g. encryption keys and crypto variables) by means of a separate and distinct communications path, channel, or system
- **Plaintext**: message or data in its readable form, not turned into a secret
- **Cleartext**: any information that is unencrypted, although it might be in an encoded form that is not easily human-readable (such as base64 encoding)
- **Session key**: a symmetric encryption key generated for one-time use; usually requires a key encapsulation approach to eliminate key management issues
- **Stream mode encryption**: system using a process that treats the input plaintext as a continuous flow of symbols, encrypting one symbol at a time; usually uses a streaming key, using part of the key as a one-time key for each symbol's encryption
- **Symmetric encryption**: process that uses the same key (or a simple transformation of it) for both encryption/decryption
- üçÆ**Transposition Cipher**: encryption/decription process using transposition. Transposition ciphers are a type of encryption method where the positions of the characters in the plaintext are shifted according to a certain system, effectively permuting the characters. Unlike substitution ciphers, transposition ciphers do not alter the actual characters themselves, only their positions. e.g frequency of message might match known english language patterns. It can be broken with frequency analysis combined with pattern recognition.
- üçÆ**Substituion Cipher**: Encryption/decription process using subsitution. examples include
     - üéàCaesar Cipher: A type of substitution cipher where each letter in the plaintext is shifted a certain number of places down the alphabet.
     - üéàROT3: A specific case of the Caesar cipher where each letter is shifted by 3 places.
     - üéàROT13: A specific form of the Caesar cipher where each letter is shifted by 13 places.
     - üéàAtBash: A substitution cipher where each letter of the alphabet is mapped to its reverse.
     - üéàVigenere: A polyalphabetic cipher that uses a keyword to shift letters. The shifts are determined by the letters of the keyword. Vigen√®re ciphers are an example of a substitution cipher technique. 
- **VESDA**: very early smoke detection process (air sensing device brand name)
- **Work factor**: amount of effort necessary to break a cryptographic system, measured in elapsed time
- üçç**Confusion**: occurs when the relationship between the plaintext and the key is so complicated that an attacker can‚Äôt merely continue altering the plaintext and analyzing the resulting ciphertext to determine the key.
- üçç**Diffusion** occurs when a change in the plaintext results in multiple changes spread throughout the ciphertext.
- **One-¬≠time Pad**: A one-time pad (OTP) is a theoretically unbreakable encryption technique in cryptography that involves using a random key that is as long as the message being sent. It is the only known cryptosystem that is not vulnerable to attacks. All other cryptosystems, including transposition ciphers, substitution ciphers, and even AES, are vulnerable to attack, even if no attack has yet been discovered. A one-¬≠time pad is only appropriate for use in human-¬≠to-¬≠human communications.
    - The encryption key must be randomly generated.
    - The encryption key must be at least as long as the message to be encrypted.
    - Each one-time pad must be used only once.
    -  The one-time pad must be physically protected against disclosure. 

[3.1](#3.1) Research, implement, and manage engineering processes using secure design principles (OSG-9 Chpts 1,8,9,16)

- 3.1.1 Threat Modeling
    - ‚ùÑÔ∏è**Threat modeling**: a security process where potential threats are identified, categorized, and analyzed. It can be performed as a
         - üçâproactive measure during design and development
         - üçâreactive measure once a product has been deployed
        - Threat modeling identifies the potential harm, the probability of occurrence, the priority of concern, and the means to eradicate or reduce the threat
- 3.1.2 Least Privilege
    - ‚ùÑÔ∏è**Least privilege**: states that subjects are granted only the privileges necessary to perform assigned work tasks and no more; this concept extends to data and systems
        - Limiting and controlling privileges based on this concept protects confidentiality and data integrity
        - Privilege creep indicates that an employee has accumulated permissions that they no longer require, indicating a violation of the least privilege principle.
- 3.1.3 Defense in Depth
    - ‚ùÑÔ∏è**Defense in Depth**: AKA layering, is the use of multiple controls in a üìùseries, where a single failed control should not result in exposure of systems or data. Layers should be used in a series (one after the other), üö´NOT in parallel. When you see the terms levels, multilevel, layers, classifications, zones, realms, compartments, protection rings etc think about Defense in Depth
    - It is a security strategy that employs multiple layers of protection to safeguard an organization's assets. It involves implementing various security measures at different levels to provide overlapping layers of defense, thereby enhancing overall security. By implementing a variety of security controls across different layers (physical, technical, and administrative), organizations can better safeguard their resources against various threats.
    - The defense-in-depth principle suggests using multiple overlapping security controls to achieve the same control objective. E.g combined use of Network and host firewalls are both designed to limit network traffic and therefore are an example of defense in depth
- 3.1.4 Secure defaults
    - ‚ùÑÔ∏è**Secure defaults**: when you think about defaults, consider how something operates brand new, just turned over to you by the vendor
        - e.g. wireless router default admin password, or firewall configuration requiring changes to meet an organization's needs
        -  The idea that systems should be designed to operate in a secure manner if the user performs no other configuration is the secure defaults principle
- 3.1.5 Fail securely
    - ‚ùÑÔ∏è**Fail securely**: if a system, asset, or process fails, it shouldn't reveal sensitive information, or be less secure than during normal operation. Failing securely could involve reverting to defaults. The fail securely principle says that security controls should default to a secure state in the event of a control failure. 
- 3.1.6 Separation of duties (SoD)
    - ‚ùÑÔ∏è**Separation of duties (SoD)**: separation of duties (SoD) and responsibilities ensures that no single person has total control over a critical function or system;  SoD is a process to minimize opportunities for misuse of data or environment damage 
        - e.g. one person sells tickets, another collects tickets and restricts access to ticket holders in a movie theater
        - The separation of duties principle says that no employee should have permission to perform two tasks that, when combined, would pose a security risk
    - ‚ùÑÔ∏è**Two-Person Control**: where two people must concur to perform a sensitive action. E.g emergency access to system administrator privileges. Under this procedure, two qualified administrators must agree to retrieve emergency credentials. 
- 3.1.7 Keep it simple
    - ‚ùÑÔ∏è**Keep it simple**: AKA keep it simple, stupid (KISS), this concept is the encouragement to avoid overcomplicating the environment, organization, or product design. The keep it simple principle says that security controls and other technologies should remain as simple as possible while still completing their objectives.
    3.1.8 Zero Trust
    - ‚ùÑÔ∏è**Zero Trust**: Security architecture where no entity is trusted by default. Based on 3 principles
        - ‚≠êAssume Breach 
        - ‚≠êVerify Explicitly 
        - ‚≠êLeast Privilege Access     
        - it is a security concept and alternative of the traditional (castle/moat) approach where nothing is automatically trusted; instead each request for activity or access is assumed to be from an unknown and untrusted location until otherwise verified
        - It suppports defense-in-depth which advises a layered approach to security
        - replaces trust but verify as a security design principle by asserting that all activities by all users/entities must be subject to control, authentication, authorization, and management at the most granular level possible (Trust but Verify invlolves a network perimeter beyond which everything is untrusted)
        - Zero trust addresses the limitations of the legacy network perimeter-based security model. It treats identity as the control plane and assumes compromise/breach when verifying every request.
        - Goal is to have every access request authenticated, authorized, and encrypted prior to access being granted to an asset or resource
        - üõëIn a zero-trust network architecture, access control decisions should never be made based upon a system's location on the network. Therefore, an IP address should never be used and would be the least appropriate of these options. 
        - See my article on an [Overview of Zero Trust Basics](https://blog.balancedsec.com/p/an-overview-of-zero-trust-basics)
- 3.1.9 Privacy by design
    - ‚ùÑÔ∏è**Privacy by design (PbD)**: a guideline to integrate privacy protections into products during the earliest design phase rather than tacking it on at the end of development
        - Same overall concept as "security by design" or "integrated security" where security is an element of design and architecture of a product starting at initiation and continuing through the software development lifecycle (SDLC)
        - There are 7 recognized principles to achieve privacy by design:
            - 1. üö∏Proactive, preventative; preventive, not remedial: think ahead and design for things that you anticipate might happen
              2. üö∏Privacy as the default setting: make private by default, e.g. social media app shouldn't share user data with everybody by default
              3. üö∏Privacy embedded into design: build privacy in; don‚Äôt add it later
              4. üö∏Full functionality‚Äîpositive-sum, not zero-sum: achieve both security and privacy, not just one or the other
              5. üö∏End-to-end security‚Äîfull lifecycle protection: privacy should be achieved before, during and after a transaction. Part of this is securely disposing of data when it is no longer needed
              6. üö∏Visibility and transparency‚Äîkeep it open: publish the requirements and goals; audit them and publish the findings
              7. üö∏Respect for user privacy‚Äîkeep it user-centric: involve end users, providing the right amount of information for them to make informed decisions about their data
- 3.1.10 Trust by verify
    - ‚ùÑÔ∏è**Trust but verify**: based on a Russian proverb, and no longer sufficient; it's the traditional approach of trusting subjects and devices within a company's security perimeter automatically, leaving an org vulnerable to insider attacks and providing intruders the ability to easily perform lateral movement. The trust but verify principle says that organizations should use auditing to ensure that control objectives are met. 
- 3.1.11 Shared responsibility 
    - ‚ùÑÔ∏è**Shared responsibility**: the security design principle that indicates that organizations do not operate in isolation
        - ‚≠êEveryone in an organization has some level of security responsibility
        - ‚≠êthe job of the CISO and security team is to establish & maintain security
        - ‚≠êThe job of regular employees to perform their tasks within the confines of security
        - ‚≠êThe job of the auditor is to monitor the environment for violations
        - ‚≠êWhen working with third parties, especially with cloud providers, each entity needs to understand their portion of the shared responsibility of performing work operations and maintaining security. This is often referenced as the **cloud shared responsibility model**
        - ‚≠êOrganizations are responsible to their stakeholders for making good security decisions in order to sustain the organization.
        - ‚≠êAs we become aware of new vulnerabilities and threats, we should consider it our responsibility (if not our duty) to responsibly disclose that information to the proper vendor or to an information sharing center.

- 3.1.12 Secure Access Service Edge (SASE)
    - ‚ùÑÔ∏è**SASE**: A design philosophy closely related to Zero trust Network Architecture. üî•Brings together networking and security functions and delivers them as an integrated cloud service.
    - Described as Gartner in 2019 as a networking model that merges traditional WAN managment and security capabilites into a unified whole
    - It is built, implemented and managed  using üî•cloud-native architectures. It is a responde to the the edge-centric trends in mobility, cloud, SD-WAN and the internet of things. It is WAN implmentation in the world of hybrid and public cloud. SASE compnents include:
     - ‚≠êFirewall services
     - ‚≠êsecure web gateway
     - ‚≠êanti-malware services
     - ‚≠êintrusion prevention services
     - ‚≠êcloud access service broker (CASB)
     - ‚≠êData Loss Prevention (DLP) 

[3.2](#3.2) Understand the fundamental concepts of security modles (e.g. Biba, Star Model, Bell-LaPadula) (OSG-9 Chpt 8)
- Security models:
    - Intended to provide an explicit set of rules that a computer can follow to implement the fundamental security concepts, processes, and procedures of a security policy 
    - Provide a way for a designer to map abstract statements into a security policy prescribing the algorithms and data structures necessary to build hardware and software
    - Enable people to access only the data classified for their clearance level
    - A security model provides a framework to implement a security policy.
    - **The State Machine Model** describes a system that is always secure no matter what state it is in. A secure state machine model system always boots into a secure state, maintains a secure state across all transitions, and allows subjects to access resources only in a secure manner compliant with the security policy. Bell‚ÄìLaPadula and Biba are built on a state machine model.
         - The information flow model applies state machines to the flow of information.
         - The Bell-LaPadula model applies the information flow model to confidentiality while the Biba model applies it to integrity. They both use security labels on objects and clearances for subjects and is therefore a MAC model. They are both multilevel models.
- üî¥**Bell-LaPadula**: Model was established in 1973. The goal is to ensure that information is exposed only to those with the right level of classification
    - Focuse is on confidentiality ‚úèÔ∏è
    - Simple security property: üî•No read-up 
    - Star (*) security property: üî•No write-down ( an individual may not write to a file at a lower classification level than that of the individual. AKA confinement property)
    - Discretionary Security Property: uses an access matrix (need to know in order to access)
    - Doesn't address covert channels
- üî¥**Biba**: Released in 1977, this model was created to supplement Bell-LaPadula 
    - Focus is on integrity ‚úèÔ∏è
    -  is based on information flow, and is a multilevel model.
    - Simple integrity property: üî•No read down ( individual may not read a file classified at a lower security level than the individual's security clearance. for example, users with a Top Secret clearance can‚Äôt read data classified as Secret). the implied allowed opposite is read-up.
    - Star (*) integrity property: üî•No write up (for example, a user with a Secret clearance can‚Äôt write data to files classified as Top Secret)
    - By combining it with Bell-LaPadula, you get both confidentiality and integrity
- üî¥**Take-Grant**: 
    - The take-grant model employs a directed graph to dictate how rights can be passed from one subject to another, or from a subject to an object
    - Four rules: 
        - ‚úèÔ∏ètake: The right to remove or take permissions from other users. The take rule allows a subject to take the rights belonging to another object. 
        - ‚úèÔ∏ègrant: The grant rule allows a subject to grant rights that it possesses on an object to another subject.
        - ‚úèÔ∏ècreate: The create rule allows a subject to create new objects and also creates an edge from the subject to that object, granting rights on the new object.
        - ‚úèÔ∏èremove
- üî¥**Clark-Wilson**: The Clark‚ÄìWilson model uses a multifaceted approach to enforcing data integrity. Instead of defining a formal state machine, the Clark‚ÄìWilson model defines each data item and allowable data transformations. 
    - Focus is on integrity ‚úèÔ∏è
    - Designed to protect integrity using the access control üìùtriplet (‚ÄºÔ∏èSubject, ‚ÄºÔ∏èObject, ‚ÄºÔ∏èProgram/Interface)
    - A program interface is used to limit what is done by a subject; if the focus of an intermediary program between subject and object is to protect integrity, then it is an implementation of the Clark-Wilson model
- üî¥**Brewer and Nash Model**:
    - AKA "ethical wall", and "cone of silence"
    - created to permit access controls to change dynamically based on a user's previous activity
    - prevents conflicts of interest. ‚úèÔ∏è
    - implemented in environments where data from different clients exist 
- üî¥**Goguen-Meseguer Model**:
    - An integrity model ‚úèÔ∏è
    - it is based on üî•predetermining the set or domain (i.e., a list) of objects that a subject can access.
    - Foundation of noninterference conceptual theories
    - **Noninterference** is the concept of limiting the actions of a subject at a higher security level so that they do not affect the system state or the actions of a subject at a lower security level.
- üî¥**Sutherland Model**:
    - Focuses on preventing üî•interference in support of integrity
    - Focus is on Integrity ‚úèÔ∏è
- üî¥**Graham-Denning Model**
    - Focused on the secure creation and deletion of both subjects and objects
    - 8 primary protection rules or actions
        - ‚úèÔ∏è1-4:securely create/delete a subject/object
        - ‚úèÔ∏è5-8:securely provide the read/grant/delete/transfer access right
- üî¥**Harrison-Ruzzo-Ullman Model**:
    - Focuses on the assignment of object access rights to subjects as well as the integrity/resilience of those assigned rights
    - HRU is an üî•extension of Graham-Denning model
- üî¥**Star Model**: 
    - Not an official model, but name refers to using asterisks (stars) to dictate whether a person at a specific level of confidentiality is allowed to write data to a lower level of confidentiality
    - Also determines whether a person can read or write to a higher or lower level of confidentiality
- üî¥**Access Control Matrix**: 
    - An access control matrix assembles ACLs from multiple objects into a single table.
         - Access control list is a list of individual users who may access the file.  An ACL is a list of permissions attached to an object (such as a file, directory, or network resource) that specifies which users or systems are granted access and what kind of access they are permitted. Access Control List  consists of multiple access control entries.
         - Access Control Entry: An ACE is a single entry within an ACL that defines the access rights for a specific user or group on a particular resource. Each ACE in an ACL specifies the permissions granted to a single user or group. It essentially defines a rule for access control in the context of the larger ACL.
     - üìùACL: Refers to the entire list of access control rules for a particular resource. üìùACE: Refers to a single entry within that list, specifying permissions for one user or group.
    - The rows of that table are the ACEs of a subject across those objects, thus a capabilities list.
- üî¥**Capability Tables**: 
    - They are different from ACLs in that a capability table is focused on subjects (such as users, groups, or roles).
    - For example, a capability table created for the accounting role will include a list of all objects that the accounting role can access as well as the specific privileges assigned to the accounting role for these objects. In contrast, ACLs are focused on objects.

[3.3](#3.3) Select controls based upon systems security requirements (OSG-9 Chpt 8)

- üìó**Common Criteria (CC)** for Information Technology Security Evaluation
- The CC provides a standard to evaluate systems, defining various levels of testing and confirmation of systems' security capabilities 
- The number of the level indicates what kind of testing and confirmation has been performed
- The important concepts:
    - ‚ú¥Ô∏è**Target of Evaluation (TOE)** To perform an evaluation, you need to select the TOE (e.g. firewall or an anti-malware app)
    - ‚ú¥Ô∏è**Protection Profile (PP)** The evaluation process will look at the PP, which is a document that outlines the security needs (customer üî•"I wants"üî•); a vendor might use a specific protection profile for a particular solution
    - ‚ú¥Ô∏è**Security Target (ST)** The evaluation process will look at the ST, specifying the claims of security from the vendor that are built into a TOE (the ST is usually published to customers and partners and available to internal staff). STs are considered the implemented security measures or the üî•"I will provide"üî• from the vendor.
    - An organization's PP is compared to various STs from the selected vendor's TOEs, and the closest or best match is what the org purchases
    - The evaluation will attempt to gauge the confidence level of a security feature 
    - **Security assurance requirements (SARs)**: Assurance is the degree of confidence that an organization has that its security controls are correctly implemented. It must be continually monitored and reverified. SAR is a description of how the TOE is to be evaluated, based on the development of the solution
    - Key actions during development and testing should be captured 
    - An **evaluation assurance level (EAL)**: a numerical rating used to assess the rigor of an evaluation; the scale is EAL 1 (cheap and easy) to EAL7 (expensive and complex):
        - üçêEAL1: functionally tested (lowest level of assurance)
        - üçêEAL2: structurally tested
        - üçêEAL3: methodically tested and checked
        - üçêEAL4: methodically designed, tested, and reviewed
        - üçêEAL5: semi-formally designed and tested
        - üçêEAL6: semi-formally verified, designed, and tested
        - üçêEAL7: formally verified, designed, and tested
- **Authorization to Operate (ATO)**: official auth to use specific IT systems to perform tasks/accept identified risks: The four types of ATOs are
    - üçäAuthorization to Operate
    - üçäCommon Control Authorization
    - üçäAuthorization to Use
    - üçäDenial of Authorization.
- **System Assurance Processes:**
  - üçåCertification: Evaluating a system to ensure it meets specified security requirements.
  - üçåVerification: The verification process is similar to the certification process in that it validates security controls. Verification may go a step further by involving a üìùthird-party testing service and compiling results that may be trusted by many different organizations.
  - üçåAccreditation: Officially authorizing the system to operate based on its security certification. It is the act of management formally accepting an evaluating system, not evaluating the system itself. 
[3.4](#3.4) Understand security capabilities of Information Systems (IS) (e.g. memory protection, Trusted Platform Model (TPM), encryption/decryption) (OSG-9 Chpt 8)
- üçé**Trusted Computer System Evaluation Criteria (TCSEC)**, also known as the Orange Book. These modes are used to categorize the security features of a computer system based on its ability to enforce confidentiality and access control policies.
    - ‚ú¥Ô∏è**Dedicated Mode**: In Dedicated mode, the system is used for information of a single classification level, and all users must have at least the clearance level necessary to access that information.
    - ‚ú¥Ô∏è**Controlled Access Mode**: In Controlled Access mode, the system enforces access controls based on user identity and clearance levels but does not require that all users have the highest clearance level.
    - ‚ú¥Ô∏è**Multilevel/Multistate Mode**: In Multilevel mode, the system can handle information at multiple classification levels simultaneously. Users can access information according to their clearance and need-to-know basis, and the system dynamically enforces access controls based on the classification of the data. üìùMultistate systems are certified to handle data from different security classifications simultaneously by implementing protection mechanisms that segregate data appropriately.
    - ‚ú¥Ô∏è**System High mode**: : In System High mode, the system enforces access control based on the classification level of the information, and all users must have a security clearance that is at least equal to the highest classification level of the information they can access. For systems running in System High mode, the user must have a valid security clearance for all information processed by the system, access approval for all information processed by the system, and a valid need to know for some, but not necessarily all, information processed by the system.

- Security capabilities of information systems include memory protection, virtualization, Trusted Platform Module (TPM), encryption/decryption, interfaces, and fault tolerance
- üü£**Memory Protection:** A computing device is likely running multiple apps and services simultaneously, each occupying a segment of memory; the goal of memory protection is to prevent one app or service from impacting another
- Memory protection is a core security component that must be designed and implemented into an operating system. It must be enforced regardless of the programs executing in the system. Otherwise, instability, violation of integrity, denial of service, and disclosure are likely results.
- There are two primary memory protection methods:
    - üêä**Process isolation**: OS provides separate memory spaces for each processes instructions and data, and prevents one process from impacting another
    - üêä**Hardware segmentation**: forces separation via physical hardware controls rather than logical processes; in this type of segmentation, the operating system maps processes to dedicated memory locations
- üü£**Confinement/Constrained Process**: A constrained process is one that can access only certain memory locations. Using a sandbox is an example of confinement, where the system restricts the access of a particular process to limit its ability to affect other processes running on the same system.
- üü£**Virtualization**: technology used to host one or more operating systems within the memory of a single host, or to run applications that are not compatible with the host OS; the goal is to protect the hypervisor and ensure that compromising one VM doesn't affect others on that host
- üü£**Trusted Platform Module (TPM)**: a cryptographic chip that is sometimes included with a client computer or server; a TPM enhances the capabilities of a computer by offering hardware-based cryptographic operations
    - üî•TPM is a tamper-resistant integrated circuit built into some motherboards that can perform cryptographic operations (including key gen) and protect small amoutns of sensitive info, like passwords and cryptographic keys
    - The Trusted Platform Module (TPM) is a hardware security technique that stores an encryption key on a chip on the motherboard and prevents someone from accessing an encrypted drive by installing it in another computer.
    - Many security products and encryption solutions require a TPM
    - TPM is both a specification for a cryptoprocessor chip on a motherboard and the general name for implementation of the specification
    - Remote attestation creates a hash value from the system configuration to confirm the integrity of the configuration.
    - Binding and sealing are techniques used by the TPM to encrypt data.
    - The random number generator (RNG) function of the TPM is used to support cryptographic operations.
    - TPM does include  Storage Root Key (SRK), which is used for managing and protecting cryptographic operations and keys within the TPM.
    - in a TPM iplementation, the files on the drive are at their most secure when the system is off and the drive is encrypted and not in a readable state. BitLocker decrypts files as needed when in use, meaning that any time after the system is booted files may be accessed, particularly if the user is logged in and access to the system can be gained or if malware is running.
    - A TPM is an example of a hardware security module (HSM)
    - **hardware security module (HSM)**: a cryptoprocessor used to manage and store digital encryption keys, accelerate crypto operations, support faster digital signatures, and improve authentication. HSMs include root keys and are used for high-security key management. They are generally used in server environments rather than directly on endpoints.
- üü£**User interface**: a constrained UI can be used in an application to restrict what users can do or see based on their privileges
    - e.g. dimming/graying out capabilities for users without the correct privilege
    - A constrained or restricted interface is implemented within an application to restrict what users can do or see based on their privileges. The purpose of a constrained interface is to limit or restrict the actions of both authorized and unauthorized users.
    - An interface is also the method by which two or more systems communicate
- Be aware of the common security capabilities of interfaces:
    - **Encryption/decryption**: when communications are encrypted, a client and server can communicate without exposing information to the network; when an interface doesn‚Äôt provide such a capability, use IPsec or another encrypted transport mechanism
         - In the context of Virtual Private Networks (VPNs), ESP (Encapsulating Security Payload) and AH (Authentication Header) are two different protocols used in IPsec (Internet Protocol Security) to secure network communications.
              -  **üé¨ESP (Encapsulating Security Payload)**: The Encapsulating Security Payload (ESP) protocol provides confidentiality and integrity for packet contents. It encrypts packet payloads and provides limited authentication and protection against replay attacks. ESP provides confidentiality by encrypting the data being transmitted. ESP can also provide optional authentication, which verifies the integrity of the data and ensures that it has not been tampered with.
              -  **üé¨AH (Authentication Header)**: AH provides data integrity and authentication by adding a header to the IP packet. This header contains a cryptographic checksum (or hash) that ensures the data has not been altered in transit and verifies the identity of the sender. Unlike ESP, AH does not provide encryption, so the data itself remains visible to anyone who intercepts it. It only ensures that the data has not been modified and that it comes from a legitimate source. AH is less commonly used on its own in VPNs because it does not offer encryption. It‚Äôs often used in conjunction with ESP to provide a more comprehensive security solution.
    - **Signing**: used for üî•non-repudiation; in a high-security environment, both encrypt and sign all communications if possible
- üü£**Fault tolerance**: capability used to enhance availability; in the event of an attack (e.g. DoS), or system failure, fault tolerance helps keep a system up and running

[3.5](#3.5) Assess and mitigate the vulnerabilities of security architectures, designs and solution elements (OSG-9 Chpts 9,16,20)

This objective relates to identifying vulnerabilities and corresponding mitigating contols and solutions; the key is understanding the types of vulnerabilities commonly present in different environments, and their mitigation options
- 3.5.1 Client-based systems
    - **Client-based systems**: client computers are the most attacked entry point
    - Compromised client computers can be used to launch other attacks
    - Productivity software and browsers are constant targets
    - Even patched client computers are at risk due to phishing and social engineering vectors
    - Mitigation: run a full suite of security software, including anti-virus/malware, anti-spyware, and host-based firewall
- 3.5.2 Server-based systems
    - **Data Flow Control**: movement of data between processes, between devices, across a network, or over a communications channel
    - Management of data flow seeks to minimize latency/delays, keep traffic confidential (i.e. using encryption), not overload traffic (i.e. load balancer), and can be provided by network devices/applications and services
    - While attackers may initially target client computers, servers are often the goal
    - **Mitigation**: regular patching, deploying hardened server OS images for builds, and use host-based firewalls

- 3.5.3 Database systems
    - Databases often store a company's most sensitive data (e.g. proprietary, CC info, PHI, and PII)
    - Attackers may use inference or aggregation to obtain confidential information
    - ‚ú¥Ô∏è**Aggregation attack**: process where SQL provides a number of functions that combine records from one or more tables to produce potentially useful info. In an aggregation attack, individual(s) use their access to specific pieces of information to piece together a larger picture that they are not authorized to access.
    - ‚ú¥Ô∏è**Inference attack**: involves combining several pieces of nonsensitive info to gain access to that which should be classified at a higher level; inference makes use of the human mind‚Äôs deductive capacity rather than the raw mathematical ability of database platforms

- 3.5.4 Cryptographic systems
    - Goal of a well-implemented cryptographic system is to make compromise too time-consuming and/or expensive 
    - Each component has vulnerabilities:
        - üçé**Kerckhoff's Principle** (AKA Kerckhoff's assumption): a cryptographic system should be secure even if everything about the system, except the key, is public knowledge. The principle can be summed up as ‚ÄúThe enemy knows the system.‚Äù
        - Software: used to encrypt/decrypt data; can be a standalone app, command-line, built into the OS or called via API; like any software, there are likely bugs/issues, so regular patching is important
        - Keys: dictate how encryption is applied through an algorithm; a key should remain secret, otherwise the security of the encrypted data is at risk  
            - **key space**: represents all possible permutations of a key
            - key space best practices: 
                - key length is an important consideration; use as long of a key as possible (your goal is to outpace projected increase in cryptanalytic capability during the time the data must be kept safe); longer keys discourage brute-force attacks
                    - Binary keyspaces contain a number of keys equal to 2 raised to the power of the number of bits. For example, incresing key space by 8 bits, two to the eighth power is 256, so the keyspace will increase by a factor of 256.
                    - a 256-bit key is typically minimum recommendation for symmetric encryption
                    - 2048-bit key typically the minimum for asymmetric
                - always store secret keys securely, and if you must transmit them over a network, do so in a manner that protects them from unauthorized disclosure 
                - select the key using an approach that has as much randomness as possible, taking advantage of the entire key space 
                - destroy keys securely, when no longer needed
            - always base key length on requirements and sensitivity of the data being handled
        - Algorithms: choose algorithms (or ciphers) with a large key space and a large random **key value** (key value is used by an algorithm for the encryption process) 
            - algorithms themselves are not secret; they have extensive public details about history and how they function

- 3.5.5 Industrial Control Systems (ICS)
    - ‚ùÑÔ∏è**Industrial control systems (ICS)**: a form of computer-management device that controls industrial processes and machines, also known as operational technology (OT): ICS examples include distributed control systems (DCSs), programmable logic controllers (PLCs), and supervisory control and data acquisition (SCADA).
    - **Supervisory control and data acquisition (SCADA)**: systems used to control physical devices like those in an electrical power plant or factory; SCADA systems are well suited for distributed environments, such as those spanning continents 
        - some SCADA systems still rely on legacy or proprietary communications, putting them at risk, especially as attackers gain knowledge of such systems and their vulnerabilities
        - Supervisory Control and Data Acquisition systems, or SCADA systems, provide a graphical interface to monitor industrial control systems (ICS). 
        - SCADA risk mitigations:
            - ‚úèÔ∏èisolate networks 
            - ‚úèÔ∏èlimit access physically and logically 
            - ‚úèÔ∏èrestrict code to only essential apps 
            - ‚úèÔ∏èlog all activity
- 3.5.6 Cloud-based systems (e.g., Software as a Service (SaaS), Infrastructure as a Service (IaaS), Platform as a Service (PaaS))
    - **Cloud-based systems**: on-demand access to computing resources available from almost anywhere
        - üçéPublic Cloud: Operates a multitenant environments, where the services are delivered over the public Internet and shared across different organizations. In the public cloud computing model, the vendor builds a single platform that is shared among many different customers. This is also known as the shared tenancy model.
        - üçéPrivate/Dedicated cloud: also known as a private cloud, is infrastructure operated solely for a single organization, whether managed internally or by a third-party, and hosted either internally or externally.
        - üçéHybrid cloud: is a composition of two or more cloud delivery models (private, community, or public) that remain distinct entities but are bound together, offering the benefits of multiple deployment models.
    - Cloud's primary challenge: resources are outside the org‚Äôs direct control, making it more difficult to manage risk
    - Orgs should formally define requirements to store and process data stored in the cloud
    - Focus your efforts on areas that you can control, such as the network entry and exit points (i.e. firewalls and similar security solutions)
    - All sensitive data should be encrypted, both for network communication and data-at-rest
    - Use centralized identity access and management system, with multifactor authentication
    - Customers shouldn‚Äôt use encryption controlled by the vendor, eliminating risks to vendor-based insider threats, and supporting destruction using  
    - üî•Cryptographic erase: methods that permanently remove the cryptographic keys
    - Capture diagnostic and security data from cloud-based systems and store in your SIEM system
    - Ensure cloud configuration matches or exceeds your on-premise security requirements
    - Understand the cloud vendor's security strategy
    - Cloud shared responsibility by model:
        - ü•ëSoftware as a Service (SaaS):
            - the vendor is responsible for all maintenance of the SaaS services
        - ü•ëPlatform as a Service (PaaS):
            - customers deploy apps that they‚Äôve created or acquired, manage their apps, and modify config settings on the host
            - the vendor is responsible for maintenance of the host and the underlying cloud infrastructure
            - Cloud computing systems where the customer only provides application code for execution on a vendor-supplied computing platform are examples of platform as a service (PaaS) computing.
        - ü•ëInfrastructure as a Service (IaaS): 
            - IaaS models provide basic computing resources to customers
            - customers install OSs and apps and perform required maintenance
            - the vendor maintains cloud-based infra, ensuring that customers have access to leased systems
        - ü•ëIdentity as a service (IDaaS) provides capabilities such as account provisioning, management, authentication, authorization, reporting, and monitoring. 
- 3.5.7 Distributed systems
    - ‚ùÑÔ∏è**Distributed computing environment (DCE)**: a collection of individual systems that work together to support a resource or provide a service 
    - DCEs are designed to support communication and coordination among their members in order to achieve a common function, goal, or operation
    - The primary security concern of a distributed computing environment (DCE) is the interconnectedness of the components. This configuration could allow for error or malware propagation as well. If an adversary compromises one component, it may grant them the ability to compromise other components in the collective through pivoting and lateral movement. 
    - Most DCEs have duplicate or concurrent components, are asynchronous, and allow for fail-soft or independent failure of components
    - DCE is AKA concurrent computing, parallel computing, and distributed computing 
    - DCE solutions are implemented as client-server, three-tier, multi-tier, and peer-to-peer
    - Distributed control systems (DCSs) are typically used in industrial process plants where the need to gather data and implement control over a large-¬≠scale environment from a single location is essential.
    - Securing distributed systems:
        - in distributed systems, integrity is sometimes a concern because data and software are spread across various systems, often in different locations
        - Client/server model network is AKA a distributed system or distributed architecture 
            - ‚úèÔ∏èsecurity must be addressed everywhere instead of at a single centralized host 
            - ‚úèÔ∏èprocessing and storage are distributed on multiple clients and servers, and all must be secured 
            - ‚úèÔ∏ènetwork links must be secured and protected
- 3.5.8 Internet of Things (IoT)
    - ‚ùÑÔ∏è**Internet of things (IoT)**: a class of smart devices that are internet-connected in order to provide automation, remote control, or AI processing to appliances or devices 
        - An IoT device is almost always separate/distinct hardware used on its own or in conjunction with an existing system
        - IoT security concerns often relate to access and encryption
        - IoT biggest concern should be the long-term security, patching model and supportability of the IoT devices. 
        - IoT is often not designed with security as a core concept, resulting in security breaches; once an attacker has remote access to the device they may be able to pivot
        - Securing IoT:
            - deploy a distinct network for IoT equipment, kept separate and isolated (known as **three dumb routers**) 
            - keep systems patched 
            - limit physical and logical access 
            - monitor activity 
            - implement firewalls and filtering 
            - never assume IoT defaults are good enough, evaluate settings and config options, and make changes to optimize security while supporting business function
            - disable remote management and enable secure communication only (such as over HTTPS)
            - review IoT vendor to understand their history with reported vulnerabilities, response time to vulnerabilities and their overall approach to security
            - not all IoT devices are suitable for enterprise networks
            - Mirai malware affectes IoT, transforming them into a botnet
- 3.5.9 Microservices
- Service-oriented architecture (SOA) constructs new applications or functions out of existing but separate and distinct software services. The resulting application is often new; thus, its security issues are unknown, untested, and unprotected. A
derivative of SOA is microservices.
    - ‚ùÑÔ∏è**Microservices**: a feature of web-based solutions and derivative of SOA 
        - A microservice is simply one element, feature, capability, business logic, or function of a web app that can be called upon or used by other web apps
        - Microservices are usually small and focused on a single operation, engineered with few dependencies, and based on fast, short-term development cycles (similar to Agile)
        - It is the conversion or transformation of a capability of one web application into a microservice that can be called upon by numerous other web applications. The relationship to an application programming interface (API) is that each microservice must have a clearly defined (and secured!) API to allow for I/O between multi-¬≠microservices as well as to and from other applications.
        - creating many discrete software objects and then binds them together using APIs is an example of a micro services architecture. Each of the component micro services performs a discrete task and then communicates with other micro services using APIs
        - Securing microservices: 
            - use HTTPS only 
            - encrypt everything possible and use routine scanning
            - closely aligned with microservices is the concept of shifting left, or addressing security earlier in the SDLC; also integrating it into the CI/CD pipeline 
            - consider the software supplychain or dependencies of libries used, when addressing updates and patching
- 3.5.10 Containerization
    - ‚ùÑÔ∏è**Containerization**: AKA OS virtualization, is based on the concept of eliminating the duplication of OS elements in a virtual machine; instead each app is placed into a container that includes only the actual resources needed to support the enclosed app, and the common or shared OS elements are then part of the hypervisor
        - Containerization is able to provide 10 to 100 x more application density per physical server compared to traditional virtualization
        - the use of Docker is best described as a containerization technology
        - Vendors often have security benchmarks and hardening guidelines to follow to enhance container security
        - Securing containers: 
            - container challenges include the lack of isolation compared to a traditional infrastructure of physical servers and VMs
            - scan container images to reveal software with vulns
            - secure your registries: use access controls to limit who can publish images, or even access the registry
            - require images to be signed
            - harden container deployment including the OS of the underlying host, using firewalls, and VPC rules, and use limited access accounts
            - reduce the attack surface by minimizing the number of components in each container, and update and scan them frequently 
- 3.5.11 Serverless
    - ‚ùÑÔ∏è**Serverless architecture** (AKA **function as a service (FaaS)**): a cloud computing concept where code is managed by the customer and the platform (i.e. supporting hardware and software) or servers are managed by the CSP
        - Applications developed on serverless architecture are similar to microservices, and each function is created to operate independently and automonomously
        - A serverless model, as in other CSP models, is a shared security model,and your org and the CSP share security responsibility
        - In a serverless computing model, the vendor does not expose details of the operating system to its customers. Therefore, the vendor retains full responsibility for configuring it securely under the shared responsibility model of cloud computing.
        - There is always a physical server running the code, but this execution model allows the software designer/architect/programmer/developer to focus on the logic of their code and not have to be concerned about the parameters or limitations of a specific server. This is also known as function as a service (FaaS).
        - üìùFaaS is a subcategory of platform as a service (PaaS)

- ‚ùÑÔ∏è**Infrastructure as Code**: Infrastructure as Code (IaC) is a concept where you manage and provision IT infrastructure using code rather than manual processes. 

- 3.5.12 Embedded systems
    - ‚ùÑÔ∏è**Embedded systems**: any form of computing component added to an existing mechanical or electrical system for the purpose of providing automation, remote control, and/or monitoring; usually including a limited set of specific functions
        - Embedded systems can be a security risk because they are generally static, with admins having no way to update or address security vulns (or vendors are slow to patch)
        - Embedded systems focus on minimizing cost and extraneous features
        - Embedded systems are often in control of/associated with physical üìù systems, and can have real-world impact
        - Because an embedded system is often in control of a mechanism in the physical world, a security breach could cause harm to people and property (aka cyber-¬≠physical).
        - Securing embedded systems:
            - ebedded systems should be isolated from the internet, and from a private production network to minimize exposure to remote exploitation, remote control, and malware
            - use secure boot feature and physically protecting the hardware
     - ‚ùÑÔ∏è**Cyber-physical systems** refer to devices that offer a computational means to control something in the physical world. In the past these might have been referred to as üéµ embedded systems üéµ, but the category of cyber-physical seems to focus more on the physical world results rather than the computational aspects.
- 3.5.13 High-Performance Computing (HPC) systems
    - ‚ùÑÔ∏è**High-performance computing (HPC)** systems: platforms designed to perform complex calculations/data manipulation at extremely high speeds (e.g. super computers or MPP (Massively Parallel Processing)); often used by large orgs, universities, or gov agencies
        - An HPC solution is composed of three main elements: 
            - compute resources 
            - network capabilities 
            - storage capacity
        - HPCs often implement real-time OS (RTOS)
             - **Real-time operating system (RTOS)** is designed to process or handle data as it arrives on the system with minimal latency or delay. An RTOS is usually stored on read-only memory (ROM) and is designed to operate in a hard real-time or soft real-time condition.
             - It minimizes latency and delay, storing code in ROM, and optimizing for mission-¬≠critical operations
        - HPC systems are often rented, leased or shared, which can limit the effectiveness of firewalls and invalidate air gap solutions
        - Securing HPC systems:
            - deploy head nodes and route all outside traffic through them, isolating parts of a system 
            - "fingerprint" HPC systems to understand use, and detect anomalous behavior
- 3.5.14 Edge computing systems
    - ‚ùÑÔ∏è**Edge computing**: philosophy of network design where data and compute resources are located as close as possible, at or near the network edge, to optimize bandwidth use while minimizing latency
    - In edge computing, the intelligence and processing are contained within each device. Thus, rather than having to send data off to a master processing entity, each device can process its own data locally.
    - The architecture of edge computing performs computations closer to the data source, which is at or near the edge of the network.
        - Securing edge computing:
            - this technology creates additional network edges that result in increased levels of complexity
            - visibility, control, and correlation requires a Zero Trust access-based approach to address security on the LAN edge, WAN edge and cloud edge, as well as network management
            - edge-based computing devices,especially IoT devices, are often produced with limited security forethought
            - devices on your network, no matter where they reside, need to be configured, managed, and patched using a consistent policy and enforcement strategy
            - use intelligence from side-channel signals that can pick up hardware trojans and malicious firmware
            - attend to physical security 
            - deploy IDS on the network side to monitor for malicious traffic
            - in many scenarios, you are an edge customer, and likely will need to rely on a vendor for some of the security and vulnerability remediation

- ‚ùÑÔ∏è**Fog computing** is another example of advanced computation architectures, which is also often used as an element in an IIoT deployment. Fog computing relies upon sensors, IoT devices, or even edge computing devices to collect data, and then transfer it back to a central location for processing. Thus, intelligence and processing is centralized.
    - Both edge and fog computing can often take advantage of or integrate the use of microcontrollers, embedded devices, static devices, cyber-physical systems, and IoT equipment.
  
- 3.5.15 Virtualized systems
    - ‚ùÑÔ∏è**Virtualized systems**: used to host one or more OSs within the memory of a single host computer, or to run apps not compatible with the host OS
        - Securing virtualized systems:
            - the primary component in virtualization is a hypervisor which manages the VMs, virtual data storage, virtual network components
            - The hypervisor is responsible for coordinating access to physical hardware and enforcing isolation between different virtual machines running on the same physical platform.
            - the hypervisor represents an additional attack surface
            - The hypervisor runs within the virtualization platform and serves as the moderator between virtual resources and physical resources.
            - in virtualized environments, you need to protect both the VMs and the physical infrastructure/hypervisor
            - hypervisor admin accounts/credentials and service accounts are targets because they often provide access to VMs and their data; these accounts should be protected
            - virtual hosts should be hardened; to protect the host, avoid using it for anything other than hosting virtualized elements
            - virtualized systems should be security tested via vuln assessment and penetration testing
            - virtualization doesn't lessen the security management requirements of an OS, patch management is still required
            - be aware of VM Sprawl and Shadow IT
            - üçç**VM Sprawl** occurs when organizations fail to plan their IT/IS needs and just deploy new systems, software, and VMs whenever their production needs demand it. This often results in obtaining underpowered equipment that is then over-
taxed by inefficient implementations of software and VMs.
            - üçç**VM escape**: occurs when software within a guest OS is able to breach the isolation protection provided by the hypervisor
            - VM escape minimizaton:
                - keep highly sensitive systems and data on separate physical machines
                - keep all hypervisor software current with vendor-released patches
                - monitor attack, exposure and abuse indexes for new threats to virtual machines (which might be better protected); often, virtualization administrators have access to all virtuals
- üîµ**System on a Chip (SoC)** is an integrated circuit (IC) or chip that has all of the elements of a computer integrated into a single chip. This often includes the main CPU, RAM, a GPU, Wi-Fi, wired networking, peripheral interfaces (such as USB), and power management. In most cases, the only item missing from an SoC compared to a full computer is bulk storage. Often a bulk storage device must be attached or connected to the SoC to store its programs and other files, since the SoC usually contains only enough memory to retain its own firmware or OS.
    - The security risks of an SoC include the fact that the firmware or OS of an SoC is often minimal, which leaves little room for most security features.
    - A few devices that use an SoC include the mini-computer Raspberry Pi, fitness trackers, smart watches, and some smartphones.    
- üîµ**Static systems/environments** are applications, OSs, hardware sets, or networks that are configured for a specific need, capability, or function, and then set to remain unaltered.
     - A nonpersistent system or static system is a computer system that does not allow, support, or retain changes. Thus between uses and/or reboots, the operating environment and installed software are exactly the same. Changes may be blocked or simply discarded after each system use.
     - A nonpersistent system is able to maintain its configuration and security in spite of user attempts to implement change.
- üîµ**parallel data systems**: . Systems designed to perform numerous calculations simultaneously include SMP, AMP, and MPP. Grid computing is a form of parallel distributed processing that loosely groups a significant number of processing nodes to work toward a specific processing goal. Peer-to-peer (P2P) technologies are networking and distributed application solutions that share tasks and workloads among peers.
    - In many grid computing implementations, grid members can access the contents of the distributed work segments or divisions. This grid computing over the internet is not usually the best platform for sensitive operations. 
    -  üõëIsolation Breach: One of the main risks of grid computing is an isolation breach. An isolation breach in the distributed computing client could be catastrophic, allowing someone who compromises the controller to assume control of every device in the organization. 
- üîµ**Microcontrollers**: A microcontroller is similar to but less complex than a system on a chip (SoC). A microcontroller may be a component of an SoC. A microcontroller is a small computer consisting of a CPU (with one or more cores), memory, various input/output capabilities, RAM, and often nonvolatile storage in the form of flash or ROM/PROM/EEPROM. Examples include Raspberry Pi, Arduino, and FPGA.
    - ‚öíÔ∏èArduino is an open source hardware and software organization that creates single-board 8-bit microcontrollers for building digital devices. An Arduino device has limited RAM, a single USB port, and I/O pins for controlling additional electronics (such as servo motors or LED lights), and does not include an OS or support networking. Instead, Arduino can execute C++ programs specifically written to its limited instruction set.
    - ‚öíÔ∏èRaspberry Pi is a popular example of a 64-bit microcontroller or a single-board computer, which includes its own custom OS, although many third-party OS alternatives are available. A Raspberry Pi, another microcontroller option, has significantly more processing power than Arduino, is not limited to executing C++ programs, supports networking, and is more expensive than Arduino.
    - ‚öíÔ∏èA field-programmable gate array (FPGA) is a flexible computing device intended to be programmed by the end user or customer. FPGAs are often used as embedded devices in a wide range of products, including industrial control systems (ICSs). FPGAs can be challenging to program and are often more expensive than other more limited solutions

[3.6](#3.6) Select and determine cryptographic solutions (OSG-9 Chpts 6,7)
- FIPS 140-2: Established to aid in the protection of digitally stored unclassified , yet sensitive information.
- According to FIPS 140-2, the following combination of cryptographic algorithms are compliant for non-legacy systems: key exchange: DH >=2048 bits, Symmetric Key: AES > 128 bits, Digital Signature: DSA or RSA >=2048 bits
 - Developed by NIST for use in computer systems by non-military American government agencies and government contractors
 - **FIPS 140-2** ü§Ø (Federal Information Processing Standard) Security levels include
   - Level 1: lowest level of security.
   - Level 2: Specifies requirement for security levels that protect sensitive information. 
   - Level 3: Requires physical protection to ensure high degree of confidence that any attempts to tamper are evident and detectable.
-  **FIPS 140-3**: ü§Ø As of April 2022, superseeds FIPS 140-2
   - Level 1: Production grade equipments and externally tested algorithms
   - Level 2: Adds requirements for tamper-evidence and role-based authentication.
   - Level 3: Includes tamper-resistance, identity-based authentication, and sepereation between interfaces
   - Level 4: Adds protections against environmental attacks and more stringent physical security requirements. Requires the ability to be tamper-active, erasing the content of the device if it detects various forms of environmental attack.
- **Cyprtographic Modules**: Can store secrets such as password, symmetric and assymetric keys, HSM backed keys, textual data and even X.509 certificates
   - Hardware: e.g SafeNet Luna HSM (Thales), Gemalto SafeNet HSM (Thales), nShield HSM (Entrust), Ultimaco CryptoServer HSM
   - Software: OpenSSL FIPS Object Module, Microsoft Windows Crypto Modules, Bouncy Castle FIPS Modules
   - Cloud: Microsoft Azure Key Vault, Amazon Key Management Service (KMS), Google cloud Key Managment Service (KMS)
- **Level of Protection:** dictates that encryption keys must be secured at the same level of control or higher as the data they protect. Sensitivity of the data dictates this level of protection as defined in the org security policies.
- **Key Recovery:** Circumstances where you need to recover a key for a particular user, without that users cooperation such as termination or key loss.
- **Key Escrow:** Copies of keys are held by a trusted 3rd party in a secure environment. Comes up in conversations around disasater recovery, business continuity, law enforcement access, regulatory compliance etc
- 3.6.1 Cryptographic lifecycle (e.g., keys, algorithm selection)
    - Keep **Moore‚Äôs Law** in mind (processing capabilities of state-of-the-art microprocessors double about every 2 years), and have appropriate governance controls in place to ensure that algorithms, protocols, and key lengths selected are sufficient to preserve the integrity of the cryptosystems for as long as necessary -- to keep secret information safe
    - Specify the cryptographic algorithms (such as AES, 3DES, and RSA) acceptable for use in an organization
    - Identify the acceptable key lengths for use with each algorithm based on the sensitivity of the info transmitted
    - Enumerate the secure transaction protocols (e.g. TLS) that may be used
    - As computing power goes up, the strength of cryptographic algorithms goes down; keep in mind the effective life of a certificate or cert template, and of cryptographic systems 
    - Beyond brute force, consider things like the discovery of a bug or an issue with an algorithm or system
    - NIST defines the following terms that are commonly used to describe algorithms and key lengths: 
        - approved (an algorithm that is specified as a NIST or FIPS recommendation) 
        - acceptable (algorithm + key length is safe today) 
        - deprecated (algorithm and key length is OK to use, but brings some risk) 
        - restricted (use of the algorithm and/or key length is deprecated and should be avoided) 
        - legacy (the algorithm and/or key length is outdated and should be avoided when possible) 
        - disallowed (algorithm and/or key length is no longer allowed for the indicated use)
- 3.6.2 Cryptographic methods (e.g., symmetric, asymmetric, elliptic curves, quantum)
    - üî¥**Symmetric** encryption: uses the same key for encryption and decryption
        - symmetric encryption uses a üìùshared secret key available to all users of the cryptosystem 
        - symmetric encryption is faster than asymmetric encryption because smaller keys can be used for the same level of protection 
        - downside is that users or systems must find a way to securely share the key and hope the key is used only for the specified communication
        - symmetric encryption uses session keys. In TLS, both the server and the client communicate using an ephemeral symmetric session key. They exchange this key using asymmetric cryptography, but all encrypted content is protected using symmetric cryptography.
        - primarily employed to perform bulk encryption and provides only for the security service of confidentiality
        - üß†Nonrepudiation requires the use of a public key cryptosystem to prevent users from falsely denying that they originated a message. Asymmetric cryptography is used for Nonrepudiation. Sender encrypt message (digital signature) with private key and receive decrypt message with sender's public key. This validates integrity and Nonrepudiation.
        - üß†Nonrepudiation cannot be achieved with a symmetric cryptosystem, such as AES.
        - "same" is a synonym for symmetric 
        - "different" is a synonym for asymmetric 
        - total number of keys required to completely connect n parties using symmetric cryptography is given by this formula: 
            - **(n(n - 1)) / 2** ü•á
            - In a symmetric cryptosystem, a unique key exists for each pair of users. If for example in a 20 user symmetric key system and 1 user is compromised, **(n - 1)** key must be changed, meaning that the key that the user shared with each of the other 19 users must be changed.
            - ‚ùÑÔ∏è**Block Ciphers**: Block ciphers operate on message "chunks" rather than on individual characters or bits.  Encrypts data in fixed-size blocks (e.g., 64 bits, 128 bits). Examples: DES, 3DES, AES, Blowfish, Twofish. Block ciphers can operate in various modes to enhance security and applicability:
                - üçâECB (Electronic Codebook): Encrypts each block üß†independently; not recommended due to security weaknesses. Only provide üìùconfidentiality. Plaintext is divided into blocks. Each block is encrypted separately to produce the ciphertext blocks
                - üçâCBC (Cipher Block Chaining): Each plaintext block is üß†XORed with the previous ciphertext block before encryption, improving security. The first plaintext block is XORed with an initialization vector (IV) before encryption.         Subsequent plaintext blocks are XORed with the previous ciphertext block. Ensures that identical plaintext blocks produce different ciphertext blocks and Adds diffusion to the encryption process. üß†One important consideration when using CBC mode is that errors propagate‚Äî¬≠if one block is corrupted during transmission, it becomes impossible to decrypt that block and the next block as well.
                - üçâOutput Feedback (OFB) Mode: Converts a block cipher into a üß†synchronous stream cipher by generating a keystream from the encryption of an initial value (IV) and XORing it with the plaintext. The block cipher encrypts an IV to produce a keystream. The keystream is XORed with the plaintext to produce ciphertext. Error propagation is minimal; a bit error affects only the corresponding bit in the plaintext and can operate in parallel since encryption is independent of the plaintext. Weaknesses: Vulnerable to bit-flipping attacks if not combined with proper integrity checks. Requires secure IV management. Only provide üìùconfidentiality.
                - üçâCFB (Cipher Feedback): Convert block ciphers into üß†stream ciphers, encrypting smaller units of data. CFB mode operates on small units of data, such as bits or bytes, and can recover from transmission errors more effectively than some other modes.  It uses the previous ciphertext block to influence the encryption of the current plaintext block. Although CFB mode uses a block cipher, it effectively functions as a stream cipher by generating a keystream that is XORed with the plaintext. Strenghts include error Propagation, Self-Synchronizing i.e Capable of recovering from transmission errors if the ciphertext is corrupted or lost. Allows for encryption of small units of data (like individual bytes) rather than fixed-size blocks. While more secure than ECB, CFB mode still needs to be combined with secure key management practices to avoid vulnerabilities.
                - üçâCTR (Counter Mode): Encrypts data by üß†combining plaintext with an encrypted counter, üß†turning a block cipher into a stream cipher by encrypting successive values of a counter and XORing the result with the plaintext. The block cipher encrypts a counter value, which is incremented for each block. The encrypted counter value (keystream) is XORed with the plaintext to produce ciphertext. Supports parallel encryption and decryption and Allows random access to encrypted data blocks. Weaknesses: The counter must never repeat for the same key to maintain security. Only provide üìùconfidentiality.
                - üçâGalois/Counter Mode (GCM): Combines the Counter mode for encryption with Galois mode for authentication, providing both üìùconfidentiality and üìùintegrity. Uses CTR mode for encryption. Adds an authentication tag generated using a polynomial hash function (Galois field multiplication) to ensure data integrity. Provides authenticated encryption with associated data (AEAD) and Ensures both confidentiality and data integrity. Weaknesses: Requires careful implementation to avoid nonce reuse, which can compromise security. Used in modern protocols like TLS and IPsec to secure data with both encryption and authentication.
                - üçâCounter with Cipher Block Chaining Message Authentication Code (CCM): Combines Counter mode for encryption with CBC-MAC for authentication to provide AEAD. Encrypts data using Counter mode. Computes a CBC-MAC tag over the plaintext and additional authenticated data (AAD). Strengths: Provides both encryption and message authentication, providing both üìùconfidentiality and üìùintegrity. Suitable for environments where both encryption and data integrity are required. Weaknesses: Slightly more complex than using GCM. Requires careful nonce management to ensure security. Example: Used in various standards, including IEEE 802.11 (Wi-Fi) and some versions of IPsec.
            - ‚ùÑÔ∏è**Stream Ciphers**: Encrypts data one bit or byte at a time. Examples: RC4, ChaCha20.
                -  Bit-by-Bit Encryption: Unlike block ciphers that encrypt data in fixed-size blocks, stream ciphers encrypt data one bit or byte at a time.
                -  They generate a pseudo-random key stream that is combined with the plaintext using an XOR operation to produce the ciphertext.
                -  They are generally simpler and faster than block ciphers, making them suitable for applications requiring high-speed encryption.
                -  They are faster and can be more efficient than block ciphers for certain applications, especially when hardware resources are limited.
                -  They typically have lower latency compared to block ciphers, making them suitable for real-time applications.
                -  Disadvantage is that if the key stream is reused (keystream reuse), it can compromise security, as it makes the cipher vulnerable to attacks. Ensuring that the same key stream is not reused is critical and can complicate key management.
 
    - üî¥**Asymmetric** encryption: process that uses different keys for encryption and decryption, and in which the decryption key is computationally not possible to determine given the encryption key itself
        - uses public and private key
        - In an asymmetric cryptosystem, the sender of a message encrypts the message using the recipient's public key. The recipient may then decrypt that message using their own private key, which only they should possess.
        - total number of keys required to completely connect n parties using assymmetric cryptography is given by this formula: 
            - **n(2)** ü•á Asymmetric cryptosystems use a pair of keys for each user. E.g with 1,000 users, the system will require 2,000 keys.
        - Asymmetric (AKA public key, since one key of a pair is available to anybody) algorithms provide convenient key exchange mechanisms and are scalable to very large numbers of users (addressing the two most significant challenges for users of symmetric cryptosystems) 
        - Asymmetric cryptosystems avoid the challenge of sharing the same secret key between users, by using pairs of public and private keys to allow secure communication without the overhead of complex key distribution
        - **Public key**: one part of the matching key pair, which can be shared or published
        - Besides the public key, there is a private key that should remain private and protected
        - Private key secrecy and integrity of an asymmetric encryption process are entirely dependent upon protecting the value of the private key
        - While asymmetric encryption is slower, it is best suited for sharing between two or more parties 
        - Most common asymmetric cryptosystems in use today:    
            - Rivest-Shamir-Adleman (RSA) 
            - Diffie-Hellman 
            - ElGamal - The major disadvantage of the ElGamal cryptosystem is that it doubles the length of any message it encrypts.
            - Eliptical Curve Cryptography (ECC) - The elliptic curve cryptosystem requires significantly shorter keys to achieve encryption that would be the same strength as encryption achieved with the RSA encryption algorithm. A 3,072-¬≠bit RSA key is cryptographically equivalent to a 256-¬≠bit elliptic curve cryptosystem key.
        - **Scenario**: If üÖ∞Ô∏è wants to send a message to üÖ±Ô∏è. üÖ∞Ô∏è must encrypt the message using üÖ±Ô∏è‚Äôs public key so that only üÖ±Ô∏è can decrypt it using üÖ±Ô∏è private key. If üÖ∞Ô∏è encrypted the message with his own public key, üÖ±Ô∏è would need to know üÖ∞Ô∏è‚Äôs private key to decrypt the message. If üÖ∞Ô∏è encrypted it with his own private key, any user could decrypt the message using üÖ∞Ô∏è‚Äôs freely available public key. üÖ∞Ô∏è could not encrypt the message using üÖ±Ô∏è‚Äôs private key because üÖ∞Ô∏è does not have access to it. If üÖ∞Ô∏è did, any user could decrypt it using üÖ±Ô∏è‚Äôs freely available public key.

- 3.6.3 Public Key Infrastructure (PKI)
    - **Public Key Infrastructure (PKI)**: hierarchy of trust relationships permitting the combination of asymmetric and symmetric cryptography along with hashing and digital certificates (giving us hybrid cryptography) 
        - The purpose of a digital certificate is to provide the general public with an authenticated copy of the certificate subject's public key.
        - The last step of the certificate creation process is the digital signature. During this step, the certificate authority signs the certificate using its own private key.
        - When an individual receives a copy of a digital certificate, the person verifies the authenticity of that certificate by using the CA's public key to validate the digital signature contained on the certificate.
        - A PKI issues certificates to computing devices and users, enabling them to apply cryptography (e.g., to send encrypted email messages, encrypt websites or use IPsec to encrypt data communications)
        - üìùX.509 standards governs digital certificates and the public key infrastructure (PKI). It defines the appropriate content for a digital certificate and the processes used by certificate authorities to generate and revoke certificates.
        - üìùX.500 standards governs directory access
        - Many vendors provide PKI services; you can run a PKI privately and solely for your own org, you can acquire certificates from a trusted third-party provider, or you can do both (which is common) 
        - A PKI is made up of 
            - üéà**certification authorities (CAs)**: servers that provide one or more PKI functions, such as providing policies or issuing certificates 
            - üéàcertificates: issued to other certification authorities or to devices and users 
            - üéàpolicies and procedures: such as how the PKI is secured, and 
            - üéàtemplates: a predefined configuration for specific uses, such as a web server template
            - üéàCertificate Revocation List CRL: is a list maintained by a Certificate Authority (CA) that contains identifiers for certificates that have been revoked before their scheduled expiration date. Certificates may only be added to a certificate revocation list by the certificate authority that created the digital certificate. These certificates might be revoked for various reasons, such as being compromised, having been issued incorrectly, or no longer being needed. Delta CRLs: To efficiently handle updates, delta CRLs can be used to list only the changes (i.e., new revocations or reinstatements) since the last full CRL was issued. The certificate revocation list contains
                - ü••Serial Number: The unique identifier of the revoked certificate.
                - ü••Revocation Date: The date on which the certificate was revoked.
                - ü••Revocation Reason: The reason for the revocation, such as key compromise, CA compromise, affiliation change, or cessation of operation.
                - ü••Issuer Information: Details about the Certificate Authority (CA) that issued the CRL.
                - ü••Next Update Date: The date when the next CRL is expected to be published.
                - ü••CRL Number: A unique identifier for the CRL itself, which helps in tracking and referencing different versions of the list. 
        - There are other components and concepts you should know for the exam:
            - A PKI can have multiple tiers:    
                - single tier means you have one or more servers that perform all the functions of a PKI 
                - two tiers means there is an offline root CA (a server that issues certificates to the issuing CAs but remains offline most of the time) in one tier, and issuing CAs (the servers that issue certificates to computing devices and users) in the other tier
                - servers in the second tier are often referred to as intermediate CAs or subordinate CAs
                - three tier means you can have CAs that are responsible only for issuing policies (and they represent the second tier in a three-tier hierarchy)
                    - in such a scenario, the policy CAs should also remain offline and be brought online only as needed
            - Generally, the more tiers, the more security (but proper configuration is critical)
                - the more tiers you have, the more complex and costly the PKI is to build and maintain
            - A PKI should have a certificate policy and a certificate practice statement (CSP)
                - certificate policy: documents how your org handles items like requestor identities, the uses of certificates and storage of private keys 
                - CSP: documents the security configuration of your PKI and is usually available to the public
            - Besides issuing certificates, a PKI has other duties: 
                - a PKI needs to be able to provide certificate revocation information to clients. Note: Certificate revocation lists (CRLs) introduce an inherent latency to the certificate expiration process due to the time lag between CRL distributions.
                - if an administrator revokes a certificate that has been issued, clients must be able to get that info from your PKI
                - storage of private keys and info about issued certificates (can be stored in a database or a directory)
                    - üçäThe PFX format is most closely associated with Windows systems that store certificates in binary format. File Extension are typically .pfx or .p12. PFX typically contains a private key, a certificate, and potentially a certificate chain in a single file. Used for importing/exporting certificates and private keys in a single file, often in Windows environments.
                    - üçäP7B format is used for Windows systems storing files in text format. P7B: Contains only certificates (the certificate chain), not private keys. It can be base64-encoded with headers and footers (e.g., -----BEGIN PKCS7-----), or binary. Used primarily for handling certificates and certificate chains, not for private keys, and is often used in Windows and Java environments. File Extension typically .p7b or .p7c.
                    - üçäThe PEM format is another text format that is base64 ASCII-encoded. PEM usually represents individual components (like separate files for private keys and certificates). File Extension are typically .pem, .crt, .cer, or .key (depending on the contents). PEM is common in Unix/Linux environments and for tasks requiring separate certificate and key files.
            - PKI uses LDAP when integrating digital certs into transmissions
      - üî•The process of issuing certificates by a public Certificate Authority (CA):
          - 1. Certificate Request: Submission of Certificate Signing Request (CSR) to the CA. The CSR includes the applicant's public key and identifying information. 
            2.  Certificate Authority Verification/Validation: The CA performs the necessary checks to ensure that the applicant‚Äôs identity and credentials are valid. This could involve verifying domain ownership, business registration, or other relevant details.
            3.  Certificate Generation: The CA creates the certificate by embedding the applicant‚Äôs public key and identifying information into the certificate template. The certificate also includes details about the CA, the certificate‚Äôs validity period, and the certificate‚Äôs serial number.
            4.  Signing: The CA digitally signs the certificate using its private key. This digital signature ensures the integrity and authenticity of the certificate, allowing recipients to trust the certificate.
            5.  Certificate Distribution: The signed certificate is sent back to the applicant. The applicant can now install the certificate on their server or device as needed.
            6.  Publishing: The certificate is often published in a publicly accessible repository or directory, such as a Certificate Revocation List (CRL) or an online Certificate Status Protocol (OCSP) responder, so that other parties can verify its validity. The Online Certificate Status Protocol (OCSP) eliminates the latency inherent in the use of certificate revocation lists by providing a means for real-time certificate verification.
            7.  End-User Verification: Users and systems verify the certificate‚Äôs validity by checking the CA's digital signature against the CA‚Äôs public key. They also verify that the certificate is not expired or revoked by consulting the CRL or OCSP responder.
            8.  Key Considerations: Trust Model: The CA operates within a trust model where its certificate is trusted by browsers, operating systems, and applications. Trust in the CA‚Äôs ability to accurately validate and issue certificates is crucial.

    
- 3.6.4 Key management practices
    - **Key management practices**: include safeguards surrounding the creation, distribution, storage, destruction, recovery, and escrow of secret keys
        - Cryptography can be used as a security mechanism to provide confidentiality, integrity, and availability only if keys are not compromised
        - Three main methods are used to exchange secret keys: 
            - offline distribution
            - public key encryption, and 
            - the Diffie-Hellman key exchange algorithm
            - Quantum Key Distribution: ü•á a secure communication that involves components of quantum mechanics. Enables a party to generate a shared random key known only to them. This secret key can then be used to encrypt and decrypt messages. it has the ability to detect eavesdropping by any 3rd party trying to gain knowledge of the key. eavesdropper interception introduces detectable anomalies. Not the same as quantum cryptography. it relies on having an authenticated classical channel of communication. it means the parties have already exchanged symmetric keys of sufficient lenght or public keys of suffcient security level. Only used for key distribution and not to transmit data. used in high security scenarios.
        - Key management can be difficult with symmetric encryption but is much simpler with asymmetric encryption
        - There are several tasks related to key management:
            - ‚ú¥Ô∏è**Key Creation**: Encryption keys should be generated using FIPS 140-2/3 validated modules
            - ‚ú¥Ô∏è**Key distribution**: the process of sending a key to a user or system; it must be secure and it must be stored in a secure way on the computing device
                - keys are stored before and after distribution; when distributed to a user, it can't hang out on a user's desktop
            - Keys shouldn't be in cleartext outside the crypography device. Encrypt keys with a sepereate encryption key before distributing to other parties.
            - Key distribution and maintenance should be automated (and hidden from the user)
            - Keys should be backed up!
            - ‚ú¥Ô∏è**Key Storage**: Keys should never be stored in plain text.  This includes keys in volatile and persistent memory.
            - ‚ú¥Ô∏è**Key Usage**: AUP determines guard rails for key usage
            - ‚ú¥Ô∏è**Key Destruction**: Removal of an encryption key from its operational location
            - ‚ú¥Ô∏è**Key Deletion**: Removing any information that can be used to reconstruct the key e.g device wipe in MDM such as Airwatch & MS Intune
            - ‚ú¥Ô∏è**Key escrow**: process or entity that can recover lost or corrupted cryptographic keys
                - **multiparty key recovery**: when two or more entities are required to reconstruct or recover a key
                - **m of n control**: ü•á you designate a group of (n) people as recovery agents, but only need subset (m) of them for key recovery. M of N Control requires that a minimum number of agents (M) out of the total number of agents (N) work together to perform high-¬≠security tasks. M of N Control is an example of a split knowledge technique, but not all split knowledge techniques are used for key escrow. In an m of n control system, at least m of n possible escrow agents must collaborate to retrieve an encryption key from the escrow database.
                - **split custody**: enables two or more people to share access to a key (e.g. for example, two people each hold half the password to the key)
            - Key rotation: rotate keys (retire old keys, implement new) to reduce the risks of a compromised key having access
            - Key states:
                - suspension: temporary hold
                - revocation: permanently revoked
                - expiration
                - destruction
            - See NIST 800-57, Part 1
- 3.6.5 Digital signatures and digital certificates
    - **Digital signatures**: provide proof that a message originated from a particular user of a cryptosystem, and ensures that the message was not modified while in transit between two parties
        - Digital signatures rely on a combination of two major concepts ‚Äî public key cryptography, and hashing functions 
        - Digitally signed messages assure the recipient that the message truly came from the claimed sender, enforcing nonrepudiation
        - Digitally signed messages assure the recipient that the message was not altered while in transit; protecting against both malicious modification (third party altering message meaning), and unintentional modification (faults in the communication process) 
        - Digital signature process does not provide confidentiality in and of itself (only ensures integrity, authentication, and nonrepudiation)
        - Electronic signatures, prove that the signature was provided by the intended signer. Electronic signatures are intended to ensure that electronic records are "trustworthy, reliable, and generally equivalent to paper records and handwritten signatures executed on paper." An electronic signature (e-signature) is a broad term that refers to any electronic means used to indicate agreement or approval on a digital document or transaction. It can include various forms, such as typed names, scanned images of handwritten signatures, or click-to-sign methods. A digital signature is a specific type of electronic signature that uses cryptographic techniques to ensure the authenticity, integrity, and non-repudiation of a digital document or message. 
- 3.6.6 Digital Non-repudiation
    - Here non-repudiation refers to methods ensuring certainty about data origins; in general, the inability to deny
    - Non-repudiation of origin: sender cannot deny having sent a particular message
    - Non-repudiation of delivery: receiver cannot say they have received a different message (other than what they actually received)
    - Most common method of non-repudiation is digital signatures
    - Digital signatures rely on certificates
    - If a digital signature was verified with the public key of the sender, then we know that it was created using the sender's private key. If üÖ∞Ô∏è wants to digitally sign a message he‚Äôs sending to üÖ±Ô∏è so that üÖ±Ô∏è can be sure the message came from üÖ∞Ô∏è without modification while in transit. üÖ∞Ô∏è should encrypt the message digest with üÖ∞Ô∏è's own private key. When üÖ±Ô∏è receives the message, üÖ±Ô∏è will decrypt the digest with üÖ∞Ô∏è‚Äôs public key and then compute the digest. If the two digests match, üÖ±Ô∏è can be assured that the message truly originated from üÖ∞Ô∏è.
    - Private key should only be known to the sender, so the verification proves to the recipient that the signature came from the sender, providing origin authentication 
    - The recipient (or anyone else) can demonstrate that process to a third party providing nonrepudiation
    - Data encryption provides confidentiality
- 3.6.7 Integrity (e.g., hashing)
    - Hash Functions have a very simple purpose ‚Äî they take a potentially long message and generate a unique output value derived from the content of the message called a **message digest**
        - hash function implements encryption with a specified algorithm, but without a key
        - Provides a fixed-size hash value from variable-length input, used for ensuring data integrity.
        - used to ensure message sent by the originator is the same one received by recipient
        - input can be of any length. They take variable-length input.
        - output has a fixed length 
        - the hash function is relatively easy to compute for any input 
        - the hash function is one-way, meaning it is extremely difficult to determine the input given the hash function output. They are irreversible.
        - the hash function should be collision-resistant, meaning it is extremely hard to find two messages that produce the same hash value output. It is very difficult to find two messages with the same hash value.
        - üìùhashes are used for storing passwords, with email, and for file download integrity verification
    - Hashing and integrity: if the hash generated by sender, and separately by the receiver match, then we have integrity
    - Cryptographic salt values are added to the passwords in password files before hashing to defeat rainbow table and dictionary attacks. The salt is a random value added to a password before it is hashed by the operating system. The salt is then stored in a password file with the hashed password. This increases the complexity of cryptanalytic attacks by negating the usefulness of attacks that use precomputed hash values, such as rainbow tables. Salting adds random text to the password before hashing in an attempt to defeat automated password cracking attacks that use precomputed values. 

[3.7](#3.7) Understand methods of cryptanalytic attacks (OSG-9 Chpts 7,14,21)
- 3.7.1 Brute force
    - üçÆ**Brute force**: an attack that attempts every possible valid combination for a key or password
        - they involve using massive amounts of processing power to methodically guess the key used to secure cryptographic communications.  In a brute-force attack, the attacker simply tries all possible key combinations.
        - An attacker has intercepted a large amount of data that was all encrypted with the same algorithm and encryption key. With no further information they can attempt a brute force attack.
        - Rainbow tables contain precomputed hash values for commonly used passwords and may be used to increase the efficiency of password-¬≠cracking attacks.
- 3.7.2 Ciphertext only
    - üçÆ**Ciphertext only**: an attack where you only have the üìùencrypted ciphertext message at your disposal (not the plaintext)
        - if you have enough ciphertext samples, the idea is that you can decrypt the target ciphertext based on the samples
        - one technique proves helpful against simple ciphers is frequency analysis (counting the number of times each letter appears in the ciphertext)
        - An attacker without any special access to the system would only be able to perform ciphertext-¬≠only attacks.
- 3.7.3 Known plaintext
    - üçÆ**Known plaintext**: in this attack, the attacker has a copy of the üìùencrypted message along with the üìùplaintext message used to generate the ciphertext (the copy); this knowledge greatly assists the attacker in breaking weaker codes.
         - üõëIn a chosen plaintext attack, the attacker has the ability to choose the plaintext to be encrypted.
         - Known plaintext and chosen plaintext attacks require the ability to encrypt data.
- 3.7.4 Frequency analysis
    - üçÆ**Frequency analysis**: an attack where the characteristics of a language are used to defeat substitution ciphers
        - for example in English, the letter "E" is the most common, so the most common letter in an encrypted cyphertext could be a substitution for "E"
        - An attacker has intercepted a large amount of data that was all encrypted with the same algorithm and encryption key. With no further information they can attemt a frequency analysis attack
        - other examples might include letters that appear twice in sequence, as well as the most common words used in a language 
- 3.7.5 Chosen ciphertext
    - üçÆ**Chosen ciphertext**: in a chosen ciphertext attack, the attacker has access to one or more ciphertexts and their plaintexts; i.e. the attacker has the üìùability to decrypt chosen portions of the ciphertext message, and use the decrypted portion to discover the key. Chosen ciphertext attacks require access to the algorithm and work by having the attacker perform encryption that results in an expected ciphertext. Known plaintext and chosen plaintext attacks require the ability to encrypt data. In a chosen ciphertext attack, the attacker can choose the ciphertext output
    - üçÆ**Differential cryptanalysis**: a type of chosen plaintext attack, and a general form of cryptanalysis applicable primarily to block ciphers, but also to stream ciphers and cryptographic hash functions; in the broadest sense, it is the study of how differences in information input can affect the resultant difference at the output; advanced methods such as differential cryptanalysis are types of chosen plaintext attacks
        - as an example, an attacker may try to get the receiver to decrypt modified ciphertext, looking for that modification to cause a predictable change to the plaintext
- 3.7.6 Implementation attacks
    - üçÆ**Implementation attack**: attempts to exploit weaknesses in the implementation of a cryptography system
        - focuses on exploiting the software code, not just errors or flaws but the methodology employed to program the encryption system
        - in this type of attack, attackers look for weaknesses in the implementation, such as a software bug or outdated firmware
- 3.7.7 Side-channel: Side-channel attacks seek to use information about system activity and retrieve information that is actively being encrypted
    - üçÆ**Side-channel**: these attacks seek to use the way computer systems generate characteristic footprints of activity, such as changes in processor utilization, power consumption, or electromagnetic radiation to monitor system activity and retrieve information that is actively being encrypted
        - similar to an implementation attack, side-channel attacks look for weaknesses outside of the core cryptography functions themselves
        - Side-channel attacks seek to use information about system activity and retrieve information that is actively being encrypted. 
        - a side-channel attack could target a computer‚Äôs CPU, or attempt to gain key information about the environment during encryption or decryption by looking for electromagnetic emissions or the amount of execution time required during decryption
        - side-channel characteristics information are often combined together to try to break down the cryptography
        - timing attack is an example
- 3.7.8 Fault-Injection
    - üçÆ**Fault-Injection**: the attacker attempts to compromise the integrity of a cryptographic device by causing some type of external fault 
        - for example, using high-voltage electricity, dry ice, high or low temperature, or other factors to cause a malfunction that undermines the security of the device.
        - Fault injection attacks require physical access to the facility.
- 3.7.9 Timing
    - üçÆ**Timing**: timing attacks are an example of a side-channel attack where the attacker measures precisely how long cryptographic operations take to complete, gaining information about the cryptographic process that may be used to undermine its security.
        - By analyzing these timing variations, an attacker can infer details about the cryptographic keys or the data being processed.
        - If an encryption algorithm takes longer to process certain values or operations due to conditional statements or variable-length operations, an attacker might exploit these timing differences to gain insights into the key or plaintext.
             - üçì**Race condition**: The exploitation of the reliance of a system‚Äôs behavior on the sequence of events that occur externally. Time of Check to Time of Use (TOCTOU) attack (attacker exploits the difference in time btw when a security control is verified and the data protected by the control is actually used). 
- 3.7.10 Man-in-the-middle (MITM)
    - üçÆ**Man-in-the-middle (MITM) (AKA on-path)**: in this attack a malicious individual sits between two communicating parties and intercepts all communications (including the setup of the cryptographic session) 
        - attacker responds to the originator's initialization requests and sets up a secure session with the originator 
        - attacker then establishes a second secure session with the intended recipient using a different key and posing as the originator 
        - attacker can then "sit in the middle" of the communication and read all traffic as it passes between the two parties
        - Trusted paths that secure network traffic from capture and link encryption are both ways to help prevent man-in-the-middle attacks. 
   - üçÆ**Meet-in-the-Middle**: A Meet-in-the-Middle (MitM) attack is a type of cryptographic attack that targets symmetric key encryption algorithms, specifically when dealing with scenarios where the brute-force search space is reduced by exploiting the structure of the encryption process. The attack is used to efficiently break encryption schemes by reducing the time complexity compared to a naive brute-force approach.
        - A meet-in-the-middle attack is an attack against cryptographic algorithms that use multiple rounds of encryption.
        - The Meet-in-the-Middle attack is typically used in situations involving two rounds of encryption or decryption, such as in double encryption scenarios.
        - It works by splitting the problem into two separate problems and then combining the results to find the solution more efficiently than brute-forcing through all possible key combinations.
- 3.7.11 Pass the hash
    - üçÆ**Pass the hash (PtH)**: a technique where an attacker captures a password hash (as opposed to the password characters) and then simply passes it through for authentication and potentially lateral access to other networked systems 
        - the threat actor doesn‚Äôt need to decrypt the hash to obtain a plain text password
        - PtH attacks exploit the authentication protocol, as the passwords hash remains static for every session until the password is rotated
        - üìùNTLM is known to be susceptible to pass-¬≠the-¬≠hash attacks
        - attackers commonly obtain hashes by scraping a system‚Äôs active memory and other techniques. MIMIKATZ is a popular tool to exploit pass the hash on Active Directory accounts 
- 3.7.12 üçÆ**Kerberos exploitation**
    - üçì**Overpass the Hash**: alternative to the PtH attack, used when üß†NTLM is disabled on the network (AKA pass the key) 
    - üçì**Pass the Ticket**: in this attack, attackers attempt to harvest tickets held in the lsass.exe process and if succesful, is able to move laterally using authenticated credentials. In a Pass the Ticket attack, an attacker acquires a valid ticket-granting ticket (TGT) or session key from a compromised account or system and uses it to authenticate and impersonate a legitimate user. This allows the attacker to gain unauthorized access to other systems and move laterally within the network without the need for further authentication. It is a common technique used in advanced persistent threats (APTs) to maintain persistent access and expand control within a network.
    - üçì**Silver Ticket**: a silver ticket uses the captured NTLM hash of a service account to create a ticket-granting service (TGS) ticket (the silver ticket grants the attacker all the privileges granted to the service account) 
    - üçì**Golden Ticket**: if an attacker obtains the hash of the Kerberos service account (KRBTGT), they can create tickets at will within Active Directory (this provides so much power it is referred to as having a golden ticket) 
    - üçì**Kerberos Brute-Force**: attackers use the Python script kerbrute.py on Linux, and Rubeus on Windows systems; tools can guess usernames and passwords 
    - üçì**ASREPRoast**: ASREPRoast identifies users that don‚Äôt have Kerberos preauthentication enabled or not enforced in AD. This can be discovered using tools such as GetNPUsers from the Impacket suite. The name "ASREPRoast" is derived from the combination of "AS-REP" (Authentication Service Response) and "Roast" (a term used to describe the process of extracting and cracking hashes).
    - üçì**Kerberoasting**: kerberoasting collects encrypted ticket-granting service (TGS) tickets
- 3.7.13 Ransomeware
    - üçÆ**Ransomware**: a type of malware that weaponizes cryptography 
        - using many of the same techniques as other types of malware, ransomware gens an encryption key, and encrypts critical files 
        - this encryption renders the data inaccessible to the authorized user or anyone else other than the malware author 
        - often threatning to publically release sensitive data if ransome is not paid 
        - 2020 study, 56% of orgs suffered a ransomeware attack, 27% of orgs who reported an attack chose to pay, on average ~$1.1m 
        - seek legal advice prior to engaging with ransomware authors

[3.8](#3.8) Apply security principles to site and facility design (OSG-9 Chpt 10)

- **Secure facility plan**: outlines the security needs of your organization and emphasizes methods or mechanisms to employ to provide security, developed through risk assessment and critical path analysis
    - **critical path analysis (CPA)**: a systematic effort to identify relationships between mission-critical applications, processes, and operations and all the necessary supporting components
    - During CPA, evaluate potential **technology convergence**: the tendency for various technologies, solutions, utilities, and systems to evolve and merge over time, which can result in a single point of failure
    - A secure facility plan is based on a layered defense model
    - Site selection should take into account cost, location, and size (but security should always take precedence), that the building can withstand local extreme weather events, vulnerable entry points, and exterior objects that could conceal break-ins
- Facility Design: 
    - The top priority of security should always be the protection of the life and safety of personnel
    - In the US, follow the guidelines and requirements from Occupational Safety and Health Administration (OSHA), and Environmental Protection Agency (EPA)
    -  **Crime Prevention Through Environmental Design (CPTED)**: a well-established school of thought on "secure architecture" - an archiectural approach to building and space design that emphasizes passive features to reduce the likelihood of criminal activity
        - core principle of CPTED is that the design of the physical environment can be managed/manipulated, and crafted with intention in order to create behavioral effects or changes in people present in those areas that result in reduction of crime as well as a reduction of the fear of crime
        - CPTED stresses three main principles:
            - **üê§natural access control**: the subtle guidance of those entering and leaving a building
                - make the entrance point obvious
                - create internal security zones
                - areas of the same access level should be open, but restricted/closed areas should seem more difficult to access
            - **üê§natural surveillance**: any means to make criminals feel uneasy through increased opportunities to be observed
                - walkways/stairways are open, open areas around entrances
                - areas should be well lit
            - **üê§natural territorial reinforcement**: attempt to make the area feel like an inclusive, caring community
    - Overall goal is to deter unauthorized people from gaining access to a location (or a secure portion), prevent unauthorized personnel from hiding inside or around the location, and prevent unauthorized from committing crime
    - There are several smaller activities tied to site and facility design, such as upkeep and maintenance: if property is run down or appears to be in disrepair, it gives attackers the impression that they can act with impunity on the property

[3.9](#3.9) Design site and facility security controls (OSG-9 Chpt 10)
- Note that alghough the topics in this section cover mostly interior spaces, physical security is applicable to both interior and exterior of a facility
- 3.9.1 Wiring closets/intermediate distribution facilities
    - **Wiring closets/intermediate distribution facilities (IDF)**: A wiring closet  or IDF is typically the smallest room that holds IT
    hardware
        - wiring closet is AKA premises wire distribution room, main distribution frame (MDF), intermediate distribution frame (IDF), and telecommunications room, and it is referred to as an IDF in (ISC)^2 CISSP objective 3.9.1
        - usually includes telephony and network devices, alarm systems, circuit breaker panels, punch-down blocks, WAPs, video/security
        - may include a small number of servers 
        - access to the wiring closest/IDF should be restricted to authorized personnel responsible for managing the IT hardware 
        - use door access control (i.e. electronic badge system or electronic combination lock, or Use sensors on doors to log entries.)
        - Perform regular inspections of the closet.
        - Do not store flammable items in the closet.
        - from a layout perspective, wiring closets should be accessible only in private areas of the building interiors; people must pass through a visitor center and a controlled doorway prior to be able to enter a wiring closet
    - **Cable Plant Management Policy**: A cable plant management policy is used to define the physical structure and deployment of network cabling and related devices within a facility. A cable plant is the collection of interconnected cables and intermediary devices (such as cross-connects, patch panels, and switches) that establish the physical network. Elements of a cable plant include the following:
      - üêäEntrance facility: Also known as the demarcation point or MDF, is the entrance point to the building where the cable from the provider connects the internal cable plant.
      - üêäEquipment room: is the main wiring closet for the building, often connected to or adjacent to the MDF.
      - üêäBackbone distribution system: provides wired connections between the equipment room and the telecommunications room, including cross-floor connections.
      - üêäTeleComms Room: This serves the connection needs of a floor or a section of a large building by providing space for networking equipment and cabling systems. It also serves as the interconnection point between the backbone distribution system and the horizontal distribution system. The wiring closet is also known as premises wire distribution room, main distribution frame (MDF), intermediate distribution frame (IDF), and telecommunications room, and it is referred to as intermediate distribution facilities in (ISC)2 CISSP objective 3.9.1).
      - üêäHorizontal distribution system:  provides the connection between the telecommunications room and work areas, often including cabling, cross-connection blocks, patch panels, and supporting hardware infrastructure (such as cable trays, cable hangers, and conduits).
- 3.9.2 Server rooms/data centers
    - **Server rooms/data centers**: server rooms, data centers, communication rooms, server vaults, and IT closets are enclosed, restricted, and protected rooms where mission critical servers and networks are housed
        - a server room is a bigger version of a wiring closet, much smaller than a data center
        - a server room typically houses network equipment, backup infrastructure and servers (more archaic versions include telephony equipment)
        - server rooms should be designed to support optimal operation of IT infrastructure and to block unauthorirzed human access or intervention
        - server rooms should be located at the core of the building (avoid ground floor, top floor, or in the basement)
        - server rooms should have a single entrance (and an emergency exit)
        - server room should block unauthorized access, and entries and exits should be logged
        - datacenters are usually more protected than server rooms, and can include guards and mantraps
        - datacenters can be single-tenant or multitenant
- 3.9.3 Media storage facilities
    - **Media storage facilities**:often store backup tapes and other media, and should be protected just like a server room
        - depending on requirements a cabinet or safe could suffice
        - new blank media, and media that is reused (e.g. thumb drives, flash memory cards, portable hard drives) should be protected against theft and data remnant recovery
        - other recommendations:
            - employ a media librarian or custodian
            - use check-in/check-out process for media tracking
            - run a secure drive sanitization or zeroization when media is returned
        - note: a safe is a movable secured container that's not integrated into a building's construction; a vault is a permanent safe integrated into construction
- 3.9.4 Evidence storage
    - **Evidence storage**: as cybercrime events continue to increase, it is import to retain logs, audit trails, and other records of digital events; the evidence storage exists to preserve chain of custody
        - a key part of incident response is to gather evidence to perform root cause analysis
        - an evidence storage room should be protected like a server room or media storage facility
        - an evidence storage room can contain physical evidence (such as a smartphone) or digital evidence (such as a database)
- 3.9.5 Restricted and work area security
    - **Restricted and work area security**: covers the design and configuration of internal security, including work and visitor areas
        - includes areas that contain assets of higher value/importance which should have more restricted access
        - restricted work areas are used for sensitive operations, such as network/security ops 
        - protection should be similar to a server room, but video surveillance is typically limited to entry and exit points
- 3.9.6 Utilities and heating, ventilation, and air conditioning (HVAC)
    - Power management in ascending order: surge protectors, power/power-line conditioner, uninterruptible power supply (UPS), generators
    - Types of UPS:
        - double conversion: functions by taking power from the wall outlet, storing it in a battery, pulling power out of the battery and feeding that power to the device/devices
        - line-interactive: has a surge protector, battery charger/inverter and voltage regulator positioned between the grid power source and the equipment (battery is not in line under normal conditions)
    - Commercial power problem types:
        - ‚öíÔ∏è**fault**: momentary loss of power
        - ‚öíÔ∏è**blackout**: complete loss of power
        - ‚öíÔ∏è**sag**: momentary low voltage
        - ‚öíÔ∏è**brownout**: prolonged low voltage
        - ‚öíÔ∏è**spike**: momentary high voltage
        - ‚öíÔ∏è**surge**: prolonged high voltage
        - ‚öíÔ∏è**inrush**: initial surge of power associated with connecting to a power source
    - Think through types of physical controls for HVAC:
        - restrict duct space continuity to controlled areas
        - use separate and redundant HVAC systems for computer equipment
    - Datacenter: 
        - should be on different power circuits from occupied areas
        - common to use a backup generator
        - Generators are capable of providing backup power for a sustained period of time in the event of a power loss, but they take time to activate. Uninterruptible power supplies (UPS) provide immediate, battery-driven power for a short period of time to cover momentary losses of power, which would not cover a sustained period of power loss.
- 3.9.7 Environmental issues
    - Environmental monitoring is the process of measuring and evaluating the quality of the environment within a given structure (e.g. temperature, humidity, dust, smoke), using things like chemical, biological, radiological, and microbiological detectors
    - Halon starves a fire of oxygen by disrupting the chemical reaction of combustion, but degrades into toxic gases at 900 degrees Fahrenheit, and is not environmentally friendly
    - If water-based sprinklers are used for fire suppression, damage to electronic equipment is likely; automate the shutoff of electricity prior to sprinkler trigger
    - Other environmental issues include earthquakes, power outages, tornados and wind
    - Secondary facilities should be located far enough away from the primary to ensure they won't be damaged by the same event
    - **Recommendations**:
        - üî®Temperature: Rooms intended primarily to house computers should generally be kept between 59 and 89.6 degrees Fahrenheit (15 and 32 degrees Celsius). Some systems might require even lower temperatures.
        - üî®Humidity: Humidity in a computer room should be maintained between 40 and 60 percent. Too much humidity can cause condensation leading to corrosion. Too little humidity causes static voltage\electricity to build up.
        - üî®Static Voltage:
             - 40 can cause Destruction of sensitive circuits and other electronic components
             - 1,000 ca cause Scrambling of monitor displays
             - 1,500 can cause Destruction of data stored on hard drives
             - 2,000 can cause Abrupt system shutdown
             - 4,000 can cause Printer jam or component damage
             - 17,000 can cause Permanent circuit damage
          
- 3.9.8 Fire prevention, detection, and suppression
    - Protecting personnel from harm should always be the most important goal of any security or protection system!
    - In addition to protecting people, fire detection and suppression is designed to keep asset damage caused by fire, smoke, heat, and suppression materials to a minimum
    - **Fire triangle**: three triangle corners represent fuel, heat, and oxygen; the center of the triangle represents the chemical reaction among these three elements
        - if you can remove any one of the four items from the fire triangle, the fire can be extinguished
    - Fire suppression mediums:
        - water suppresses temperature
        - soda acid and other dry powders suppress the fuel supply
        - carbon dioxide (CO2) suppresses the oxygen supply
        - halon substitutes and other nonflammable gases interfere with the chemistry of combustion and/or suppress the oxygen supply. FM-200 is a chemical suppressant commonly used in place of water in data centers.
    - Fire stages:
        - üçê**Stage 1**: ‚úèÔ∏èincipient stage: early warning of fire. At this stage, there is only air ionization and no smoke
        - üçê**Stage 2**: ‚úèÔ∏èsmoke stage: smoke is visible from the point of ignition
        - üçê**Stage 3**: ‚úèÔ∏èflame stage: this is when a flame can be seen with the naked eye
        - üçê**Stage 4**: ‚úèÔ∏èheat stage: at stage 4, there is an intense heat buildup and everything in the area burns
    - Fire extinguisher classes:
        - **üßØClass A**: common combustibles
        - **üßØClass B**: liquids
        - **üßØClass C**: electrical
        - **üßØClass D**: metal
        - **üßØClass K**: cooking material (oil/grease)
    - Four main types of suppression:
        - **üë®‚Äçüöíwet pipe system**: (AKA closed head system): is always ‚úèÔ∏èfilled with water; water discharges immediately when suppression is triggered
        - **üë®‚Äçüöídry pipe system**: contains compressed inert ‚úèÔ∏ègas
        - **üë®‚Äçüöípreaction system**: a variation of the dry pipe system that uses a ‚úèÔ∏ètwo-stage detection and release mechanism. It is the best type of water-¬≠based fire suppression system for a computer facility because it provides the opportunity to prevent the release of water in the event of a false alarm or false initial trigger. The most common cause of false positive for water-based fire suppression systems is humans. A preaction fire suppression system activates in two steps. The pipes fill with water once the early signs of a fire are detected. The system does not dispense water until heat sensors on the sprinkler heads trigger the second phase.
        - **üë®‚Äçüöídeluge system**: uses larger pipes and delivers ‚úèÔ∏èlarger volume of water
    - Note: Most sprinkler heads feature a glass bulb filled with a glycerin-based liquid; this liquid expands when it comes in contact with air heated to between 135 and 165 degrees; when the liquid expands, it shatters its glass confines and the sprinkler head activates
- 3.9.9 Power (e.g., redundant, backup)
    - Consider designing power to provide for high availability
    - Most power systems have to be tested at regular intervals
    - As part of the design, mandate redundant power systems to accommodate testing, upgrades and other maintenance 
    - Additionally, test failover to a redundant power system and ensure it is fully functional
    - The International Electrical Testing Association (NETA) has developed standards around testing power systems
    - Battery backup/fail-over power (including UPS/generators):
        - this is a system that collects power into a battery but can switch over to pulling power from the battery when the power grid fails
        - generally, this type of system was implemented to supply power to an entire building rather than just one or a few devices

- üî¥**Administrative Physical Controls**: The six common physical security control mechanisms is ‚úèÔ∏èDeter (guard dogs, Lighting), ‚úèÔ∏èDeny (mantrap, turnstile, gate), ‚úèÔ∏èDetect (CCTV,motion sensor), ‚úèÔ∏èDelay (locks), ‚úèÔ∏èDetermine, ‚úèÔ∏èDecide. 
    - facility construction and selection
    - site management
    - building design
    - personnel controls e.g Badges, identification cards, and security IDs, turnstile, mantraps, access control vestibules (An access control vestibule is a double set of doors that is often protected by a guard and used to contain a subject until their identity and authentication is verified.)
    - Mantraps use two sets of doors to control access to a facility. This may be used to prevent piggybacking by monitoring use of the mantrap to allow only a single individual to enter a facility at a time. They may also be used to allow manual inspection of individuals or perform other security screening. Mantraps are also commonly known as access control vestibules.
    - awareness training
    - emergency response and procedures.
        - **Security Guards**: are usually unaware of the scope of the operations within a facility and are therefore not thoroughly equipped to know how to respond to every situation. Though this is considered a disadvantage, the lack of knowledge of the scope of the operations within a facility can also be considered an advantage because this supports confidentiality of those operations and thus helps reduce the possibility that a security guard will be involved in the disclosure of confidential information. The main disadvantages of security guards include:
            - Not all environments and facilities support security guards. This may be because of actual human incompatibility or the layout, design, location, and construction of the facility.
            - Not all security guards are themselves reliable.
            - Prescreening, bonding, and training do not guarantee that you won‚Äôt end up with an ineffective or unreliable security guard.
- Physical Access Control:
     - Locks and Keys, Security Guards, Guard dogs, CCTV, Security Alarms
- üî¥**Technical Physical Controls**
     - **Motion Detectors**: A motion detector, or motion sensor, is a device that senses movement or sound in a specific area, and it is a common element of intruder detection systems. Many types of motion detectors exist, including the following:
         - üç≥digital motion detector monitors for  changes in the digital pattern of a monitored area (smart security camera).
         - üç≥passive infrared (PIR) or heat-based motion detector monitors for changes in the heat levels and patterns.
         - üç≥wave pattern motion detector transmits a consistent low ultrasonic or high microwave frequency signal into a monitored area and monitors for changes or disturbances in the reflected pattern.
         - üç≥capacitance motion detector senses changes in the electrical or magnetic field surrounding a monitored object.
         - üç≥photoelectric motion detector senses changes in visible light levels. Usually  deployed in dark rooms.
         - üç≥passive audio motion detector listens for abnormal sounds in the monitored area.

     - **Intrusion Alarms**: Whenever a motion detector registers a significant or meaningful change in the environment, it triggers an alarm. An alarm is a separate mechanism that triggers a deterrent, a repellent, and/or a notification.:
         - üçäDeterrent alarms: trigger deterrents may engage additional locks, shut doors, and so on. The goal of such an alarm is to make further intrusion or attack more difficult.
         - üçäRepellent alarms: Alarms that trigger repellents usually sound an audio siren or bell and turn on lights.
         - üçäNotification alarms: trigger notification often silent from the intruder/attacker perspective to notify administrators, security guards, and law enforcement.
         - Alarms are also categorized by where they are located: local, centralized or proprietary, or auxiliary.
             - üîîLocal alarm system: Local alarm systems must broadcast an audible (up to 120 decibels [dB]) alarm signal that can be easily heard up to 400 feet away. must be protected from tampering and disablement. to be effective, a security team or guards must be positioned nearby who can respond when the alarm is triggered.
             - üîîCentral station system: The alarm is usually silent locally, but offsite monitoring agents are notified so that they can respond to the security breach. Most residential security systems are of this type such as Brinks and ADT. In a proprietary system, the organization has its own onsite security staff waiting to respond to security breaches.
             - üîîAuxiliary alarm system: Auxiliary alarm systems can be added to either local or centralized alarm systems. When the security perimeter is breached, emergency services are notified to respond to the incident and arrive at the location. This can include fire, police, and medical services.
     - Heartbeat Sensors: is a  technology that issues an alert if the communications lines for the alarm system are unexpectedly cut. Heartbeat sensors send periodic status messages from the alarm system to the monitoring center. The monitoring center triggers an alarm if it does not receive a status message for a prolonged period of time, indicating that communications were disrupted.  
     - **Cameras**: Can be overt and obvious in order to provide a deterrent benefit, or hidden and concealed in order to primarily provide a detective benefit. Vary in type, including visible light, infrared, and motion-triggered recording. Some cameras are fixed, whereas others support remote control of automated pan, tilt, and zoom (PTZ).
         - should be positioned to watch exit and entry points allowing any change in authorization or access level.
         - should also be used to monitor activities around valuable assets and to provide additional protection in public areas such as parking structures and walkways
         -  should be positioned to have clear sight lines of all exterior walls, entrance and exit points, and interior hallways.
         -  Simple motion recognition or motion-triggered cameras may be fooled by animals, birds, insects, weather, or foliage. In order to distinguish between a false alarm and an intrusion, a secondary verification mechanism should be used.
         - **Closed-circuit television (CCTV)** systems act as a secondary verification mechanism for physical presence because they allow security officials to view the interior of the facility when a motion alarm sounds to determine the current occupants and their activities.
         -  **Enhanced video surveillance (EVS)**: systems are capable of object detection, which can include faces, devices, and weapons. Some can even automatically identify individuals and track their motion (gait analysis).  EVSs can be enhanced using machine learning to improve video monitoring through automation, improved image recognition, and pattern/activity interpretation
     - **Lighting**: Lighting is often claimed to be the most commonly deployed physical security mechanism. However, lighting is only a deterrent and not a strong deterrent. It should not be used as the primary or sole protection mechanism except in areas with a low threat level. Your entire site, inside and out, should be well lit. This provides for easy identification of personnel and makes it easier to notice intrusions.
     - Key locks are also most common and inexpensive form of physical access control device for both interior and exterior use. 
     - **Fire Detectors**: There are many types of fire detection systems:
         - Fixed-temperature detection systems: trigger suppression when a specific temperature is reached. inexpensive and is the most common with potentially visible sprinkler head which serves as both the detection and release mechanism (plastic that melts at a specific temperature or small glass vial containing chemicals that vaporize to over-pressurize and shatter the container at a specific temperature to trigger release). This system is inexpensive and very reliable
         - üöíRate-of-rise detection systems: trigger suppression when the speed at which the temperature changes reaches a specific level. These are often digital temperature measuring devices, which can be fooled by HVAC heating during winter months and thus are not widely deployed.
         - üöíFlame-actuated systems trigger suppression based on the infrared energy of flames. This is fast and reliable but often fairly expensive and is often only used in high-risk environments.
         - üöíSmoke-actuated systems use photoelectric or radioactive ionization sensors as triggers. Either method monitors for light or radiation obstruction or reduction across an air gap caused by particles in the air. It is intended to be triggered by smoke, but dust and steam can sometimes trigger the alarm.
         - üöíThe radioactive ionization-based smoke detectors use americium as a source of alpha particles and a Geiger counter to detect the rate of these particles' transmission across the air gap. This element produces such low levels of radiation that a layer of dead skin cells is sufficient to block its transmission.
         - üöíIncipient smoke detection systems, also known as aspirating sensors, are able to detect the chemicals typically associated with the very early stages of combustion before a fire is other wise detectible via other means. These devices are even more costly than flame-actuated sensors and are also only used in high-risk or critical environments.
- üî¥**Administrative Access Control**:
     - Access Control Policies, User Account Management, Background checks, Role-Based Access Control (RBAC), Regular Audits and Reviews, Training and Awareness Programs
- üî¥**Technical Access Control**:
     - passwords, multi-factor authentication (MFA), or digital certificates, Encryption, Firewalls, IDS/IPS, Access Control Lists (ACLs), Access Cards/Biometric Systems
           
- 3.10 Information System Life Cycle
    - a structured framework for managing an information system from its intial conception to its retirement.
    - The goal is to ensure that a system is developed and managed in a way that meets business needs , remains secure and operates efficiently through its lifespan
    - Key phases include
      - Planning, Design and Bulding
      - Deploying, Operating and Maintaining
      - Decommissioning
    - There are 9 Phases called out in the syllabus:
      - **Phase 1: Stakeholder Needs and Requirements:** identify the problems the system needs to solve. Define functional and security features requried, identify compliance requirements. Key activities include stakeholder interviews, define project scope. The goal is to establish baseline security expectaions.
      - **Phase 2: Requirement Analysis:** Analyse requirements to ensure they are consistent complete and unambigous. Key activities include prioritize requirements, create requirement specification documents, risk analysis. Map requirements to security controls and conduct feasibility studies. Goal is to translate high-level security expectations into actionable security requirements and controls. This should address risks identified.
      - **Phase 3: Architectural Design**: develop a high level blue print of the overall architecture of the sytem, including hardware, software and network components, with consideration to security and performance. Key activities include creating system architecture diagrams, evaluate architectural options, interfaces, data flows, and threat modelling. The goal is to incorporate security by design. Architectural decsions should address identified risks and aim for defence-in-depth approach.
      - **Phase 4: Developement/Implementation**: The actual build, development and implementation based on the architectural design. Key activities include procuring hardware/software, conducting code reviews,  and implement security configurations. Goal is to ensure secure implementation of the design. This include security hardening, and secure coding practices
      - **Phase 5: Integration**: ensuring components function together by aligning with the overall system architecture.  Key activities include perform integration testing and documenting  any integration issues. The goal is to maintian security and integrity during the integration, and identify and address any security gaps that surface
      - **Phase 6: Verification and Validation:** Confirm that system meets intended requirements (Verification) and address overall stakeholder/business needs (Validation). Key activites include employing various testing techniques, review test result and obtain stakeholder feedback. The goal is to rigourours test if security requirements are met, vulnerabilities are minimized and the system doesnt introduce unacceptable risk levels.
      - **Phase 7 Transition/Deployment**: Move system from development into production in a controlled manner. The Key activites include developing implementation plans, conduct user training, perform a pilot rollout if applicable and perform a full system implementation. The goal is to ensure secure and controlled transition, protect data during migration, apply security configs and ensure operational security policies are in place.
      - **Phase 8 Operations & Maintenance/Sustainment**: Ongoing operations and managment to ensure availability and performance e.g troubleshooting, applying updates, addressing vulnerabilities, incident response. The key activities include patch managment, system monitoring, incident response, config managment, change control. The goal is to ensure continous maintenance of security posture.
      - **Phase 9 Retirement/Disposal**: secure decommissiong or disposal when the sytem reaches the end of its useful life or obsolete. focus is on preventing data exposure and respecting data retention periods. The key activities include data archival, secure disposal of hardware and media. The goal is to prevent data exposure, proper hardware disposel, data sanitization and compliance with data retention requirements;
       
- **DIGITAL SIGNATURES**: The Digital Signature Standard FIPS 186-4 approves three encryption algorithms for use in digital signatures: oddly with sha1ü§Ø
    - the Digital Signature Algorithm (DSA)
    - the Rivest, Shamir, Adleman (RSA)algorithm;
    - the Elliptic Curve DSA (ECDSA) algorithm. ü•á

- **HASHING**
    - HMAC - Lenght variable (‚úèÔ∏èvery strong)
    - HAVAL - Lenght 128, 160, 192, 224, 256 bits
    - MD2 - Lenght 128 bits(16 bytes)
    - MD4 - Lenght 128 bits(16 bytes)
    - MD5 - Lenght 128 bits(16 bytes) üìù(All Message Digest variants have the same hash lenght. MD2-5 have been replaced by MD6) The MD5 hash algorithm has known collisions and, as of 2005, is no longer considered secure for use in modern environments
    - SHA-1 - Lenght ‚úèÔ∏è160 (a real-world collision attack against SHA 1 was announced in early 2017)
    - SHA-224 - Lenght 224, produces 224-¬≠bit digests
    - SHA-256 - Lenght 256, produces 256-¬≠bit digests (sometimes called SHA 2)
    - SHA-384 - Lenght 384, produces 384-¬≠bit digests (SHA-3 is, however, less efficient than SHA-2)
    - SHA-512 - Lenght 512, produces 512-¬≠bit digests ü•á

- **SYMMETRIC**
    - AES- Block Cipher, Bock Size 128, Key Size 128, 192, 256 ü•á (AES provides confidentiality, integrity, and authentication when implemented properly. Nonrepudiation requires the use of a public key cryptosystem to prevent users from falsely denying that they originated a message and cannot be achieved with a symmetric cryptosystem, such as AES.)
    - Blowfish - Bock Size 64, Key Size 32 - 448 (uses 16 round of encryption regardless of key lenght)
    - DES - Block Cipher, Bock Size 64, Key Size 56
    - 2DES - Block Cipher (vulnerable to meet-in-the-middle attack)
    - 3DES - Block Cipher, Bock Size 64, Key Size 112, 168 
    - IDEA - Bock Size 64, Key Size 128
    - RC2 - Bock Size 128, Key Size 128
    - RC4 - Stream Cipher, Key Size 128
    - RC5 - RSA Block Mode Cipher, Bock Size 32, 64, 128, Key Size 0 - 2048
    - Skipjack - Block Size 64, Key Size 80
    - Twofish - Bock Size 128, Key Size 1-256

- **ASSYMETRIC (use a pair of keys for each user)**
    - RSA - Key Transport Algorithm, ‚úèÔ∏èSize 512
    - Diffie-Hellman - Key Exchange Algorithm
    - EL Gamal - Key Exchange Algorithm (doubles the length of any message it encrypts)
    - ECC - Elliptic Curve Algorithm, Size Variable (smaller key size due to 160 EC Key = 1024 RSA)
    - TLS - In TLS, both the server and the client communicate using an ephemeral symmetric session key. They exchange this key using asymmetric cryptography, but all encrypted content is ¬≠protected using symmetric cryptography.

- **Key Excahnge Algorithms**:
    - Diffie-Hellman (DH): Based on the mathematical difficulty of the discrete logarithm problem. Susceptible to man-in-the-middle attacks if not properly authenticated. Variants include Ephemeral Diffie-Hellman (DHE) for forward secrecy. The Diffie-Hellman algorithm allows for the secure exchange of symmetric encryption keys over a public network
    - RSA (Rivest-Shamir-Adleman): Public key algorithm that can be used for both encryption and digital signatures, including key exchange. Based on the computational difficulty of factoring large prime numbers. Can be used to securely exchange symmetric keys by encrypting them with the recipient‚Äôs public key.
    - Elliptic Curve Diffie-Hellman (ECDH): An adaptation of Diffie-Hellman using elliptic curve cryptography to provide equivalent security with smaller key sizes. More efficient and faster compared to traditional Diffie-Hellman. Commonly used in modern secure communications (e.g., TLS).
    - Elliptic Curve Integrated Encryption Scheme (ECIES): Combines elliptic curve cryptography for key exchange with symmetric encryption and message authentication. Provides confidentiality, integrity, and authenticity. Utilizes ECDH for key exchange and AES for encryption.
    - Menezes-Qu-Vanstone (MQV): An authenticated protocol for key exchange using elliptic curves, enhancing security by incorporating digital signatures. Provides resistance to certain attacks. Used in various standards, including IEEE P1363 and NIST.
    - Station-to-Station (STS) Protocol: Combines Diffie-Hellman key exchange with digital signatures to authenticate the communicating parties. Mitigates man-in-the-middle attacks by authenticating the exchanged keys. Utilizes both public key cryptography and Diffie-Hellman.
    - Internet Key Exchange (IKE): A protocol used to set up a secure and authenticated communication channel, often used with IPsec. Supports mutual authentication and dynamic key exchange.
    - Secure Remote Password (SRP): A password-based key exchange protocol that ensures mutual authentication without transmitting the actual password. Provides resistance against dictionary attacks and man-in-the-middle attacks. Useful in secure login scenarios where passwords are used.

**In a zero-knowledge proof**, one individual demonstrates to another that they can achieve a result that requires sensitive information without actually disclosing the sensitive information

- **TEMPEST-derived technology** allows the electronic emanations that devices produce (known as Van Eck radiation) to be read from a distance (this process is known as Van Eck phreaking). TEMPEST eavesdropping or Van Eck phreaking countermeasures include the following:
    - Faraday Cage: A Faraday cage is an enclosure that blocks or absorbs electromagnetic fields or signals. Faraday cage containers, computer cases, rack-¬≠mount systems, rooms, or even building materials are used to create a blockage against the transmission of data, information, metadata, or other emanations from computers and other electronics. Devices inside a Faraday cage can use EM fields for communications, such as wireless or Bluetooth, but devices outside of the cage will not be able to eavesdrop on the signals of the systems within the cage.
    - White Noise:  White noise generates false emanations that effectively "jam" the true emanations from electronic equipment. It is a physical security control that broadcasts false emanations constantly to mask the presence of true electromagnetic emanations from computing equipment.
    - Control Zone
- The TEMPEST program creates technology that is not susceptible to Van Eck phreaking attacks because it reduces or suppresses natural electromagnetic emanations.

- **Mobile Device Concepts MDM**:
   - Corporate-¬≠owned: A corporate-¬≠owned mobile strategy is when the company purchases mobile devices that can support compliance with the security policy. These devices are to be used exclusively for company purposes, and users should not perform any personal tasks on them.
     - This option often requires workers to carry a second device for personal use.
     - Corporate-¬≠owned clearly assigns responsibility for device oversight to the organization.
     - The following allow for comingling of data and have unclear or vague security responsibility assignments as a concept or policy basis.
   - Bring Your Own Device BYOD: is a policy that allows employees to bring their own personal mobile devices to work and use those devices to connect to business resources and/or the internet through the company net work.
   - Corporate-¬≠owned, personally enabled (COPE): The concept of COPE means the organization purchases devices and provides them to employees. Each user is then able to customize the device and use it for both work activities and personal activities.
   -  Choose your own device (CYOD): The concept of CYOD provides users with a list of approved devices from which to select the
device to implement.

- Consider the following:
    - X: 0 1 1 0 1 0
    - Y: 0 0 1 1 0 1
         - üïØÔ∏è‚äï symbol represents the ‚ôèXOR function and returns a true value when only one of the input values is true. If both values are false or both values are true, the output of the XOR function is false: 0 1 0 1 1 1
         - üïØÔ∏è ‚àß symbol is the result if these two values were combined using the üîºAND (the ‚àß symbol) function, which returns a value of true if the two values are both true: 0 0 1 0 0 0
         - üïØÔ∏è ‚à® symbol is the result if these two values were combined using the üîΩOR (the ‚à® symbol) function, which returns a value of true if either input values is true: 0 1 1 1 1 1
         - üïØÔ∏è ~ symbol is the result if only the X value was subjected to the ‚õîNOR (the ~ symbol) function, which reverses the value of an input: 1 0 0 1 0 1
